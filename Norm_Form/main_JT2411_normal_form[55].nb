(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    405393,       9380]
NotebookOptionsPosition[    394415,       9198]
NotebookOutlinePosition[    394915,       9217]
CellTagsIndexPosition[    394872,       9214]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["A Quantum-Like for the International Interaction Game", "Title",
 CellChangeTimes->{{3.901469939660698*^9, 
  3.9014699600327873`*^9}},ExpressionUUID->"c1042fb1-f1b4-4593-a5ef-\
dd40d4a27210"],

Cell[CellGroupData[{

Cell["The International Interaction Backward Induction Model", "Section",
 CellChangeTimes->{{3.901470010251966*^9, 3.901470016585793*^9}, {
  3.901470048306819*^9, 
  3.901470063385787*^9}},ExpressionUUID->"ec665f0e-1b94-4c88-9520-\
0f4d058ed250"],

Cell["Explain here the Signorino  tree based model", "Text",
 CellChangeTimes->{{3.9014700346546593`*^9, 
  3.9014700686706533`*^9}},ExpressionUUID->"3d93a3b2-b86f-411f-a986-\
336e290898c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["A Quantum-Like Approach", "Section",
 CellChangeTimes->{{3.901470103209635*^9, 3.901470108444337*^9}, {
  3.9400514701352787`*^9, 3.940051488190655*^9}, {3.9400515191234336`*^9, 
  3.940051525783704*^9}, {3.940051774497916*^9, 3.940051774937658*^9}, {
  3.940052756935771*^9, 
  3.9400527626031833`*^9}},ExpressionUUID->"e4dcf874-0ea3-4ddc-8539-\
ab129ce0b9c0"],

Cell[CellGroupData[{

Cell["Normal form approach", "Subsection",
 CellChangeTimes->{{3.940052737498889*^9, 3.940052740956034*^9}, {
  3.940053623015125*^9, 
  3.940053624139505*^9}},ExpressionUUID->"3c695189-56a7-4d5b-803c-\
02d5f0581247"],

Cell[TextData[{
 "We propose we can understand IIG as the sequence of two normal-form game - \
demands and crisis games\nIn each of these two game, both actors have a \
strategic set of two strategies, from which they choose simultaneously\n\n",
 Cell[BoxData[GridBox[{
    {
     RowBox[{"demands", " ", "game"}], "D2", "nD2"},
    {"D1", 
     RowBox[{"crisis", " ", "game"}], 
     RowBox[{"U1Acq2", ",", " ", "U2Acq2"}]},
    {"nD1", 
     RowBox[{"U1Acq1", ",", " ", "U2Acq1"}], 
     RowBox[{"U1SQ", ",", " ", "U2SQ"}]}
   },
   GridBoxDividers->{"Columns" -> {{True}}, "Rows" -> {{True}}}]],
  ExpressionUUID->"a0dec4a3-afef-4c9f-bdb5-9003bfed63af"],
 "\n\n",
 Cell[BoxData[GridBox[{
    {
     RowBox[{" ", 
      RowBox[{"crisis", " ", "game", " "}]}], "F2", "nF2"},
    {"F1", 
     RowBox[{"U1War", ",", " ", "U2War"}], 
     RowBox[{"U1Cap2", ",", " ", "U2Cap2"}]},
    {"nF1", 
     RowBox[{"U1Cap1", ",", " ", "U2Cap1"}], 
     RowBox[{"U1Nego", ",", " ", "U2Nego"}]}
   },
   GridBoxDividers->{"Columns" -> {{True}}, "Rows" -> {{True}}}]],
  ExpressionUUID->"c25b412a-7f1c-457c-868a-cc864a667b19"],
 "\n(we need to deal with the fact that we do not distinguish utilities of \
War1 and War2 in normal form game - we currently use an average of the two)\n\
\nwe take Signorino formula for the conditional probability of choosing \
between the strategies given their utilities and the expected strategy of the \
other player\np(F1|F2) = \
exp(lambda*U1War)/(exp(lambda*U1War)+exp(lambda*U1Cap1))\n\nwhich results in \
following probability amplitudes\n"
}], "Text",
 CellChangeTimes->{{3.9400527872543883`*^9, 3.940052958357076*^9}, {
   3.94005300615065*^9, 3.9400530632424145`*^9}, 3.940053111548642*^9, {
   3.9400531620779095`*^9, 3.9400532773130054`*^9}, {3.940053314262853*^9, 
   3.9400536155783997`*^9}, {3.940053658014623*^9, 3.940053741789645*^9}, {
   3.9400537826692376`*^9, 3.94005378736124*^9}, {3.9400538285721025`*^9, 
   3.940054092350127*^9}, 3.940054265769491*^9, {3.940054673034133*^9, 
   3.940054673465183*^9}, {3.9400594201374865`*^9, 
   3.940059450106407*^9}},ExpressionUUID->"1882c8df-b893-4d99-a10c-\
ca410cf8faad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"for", " ", "debugging"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"U1SQ", "=", 
     RowBox[{"-", "0.23801"}]}], ";", " ", 
    RowBox[{"U1Acq2", "=", "1.025024"}], ";", " ", 
    RowBox[{"U1Acq1", "=", 
     RowBox[{"-", "1.36844"}]}], ";", 
    RowBox[{"U1Nego", "=", 
     RowBox[{"-", "1.10122"}]}], ";", " ", 
    RowBox[{"U1Cap1", "=", 
     RowBox[{"-", "2.25679"}]}], ";", " ", 
    RowBox[{"U1Cap2", "=", "1.051597"}], ";", 
    RowBox[{"U1War1", "=", 
     RowBox[{"-", "1.51882"}]}], ";", " ", 
    RowBox[{"U1War2", "=", 
     RowBox[{"-", "1.963"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"U2SQ", " ", "=", " ", 
     RowBox[{"-", "0.57593"}]}], ";", " ", 
    RowBox[{"U2Acq2", " ", "=", " ", 
     RowBox[{"-", "1.51157"}]}], ";", " ", 
    RowBox[{"U2Acq1", "=", "0.627684"}], ";", 
    RowBox[{"U2Nego", "=", "0.591662"}], ";", " ", 
    RowBox[{"U2Cap1", "=", "0.861688"}], ";", " ", 
    RowBox[{"U2Cap2", "=", 
     RowBox[{"-", "1.52841"}]}], ";", 
    RowBox[{"U2War1", " ", "=", " ", "0.808828"}], ";", " ", 
    RowBox[{"U2War2", "=", "0.817247"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]", " ", "=", " ", "1"}], ";"}], " ", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9400542950882177`*^9, 3.9400543515131817`*^9}, {
   3.940054398880398*^9, 3.9400544436311717`*^9}, {3.940054474119252*^9, 
   3.9400545219651055`*^9}, 3.940054670466687*^9, {3.94005503289832*^9, 
   3.940055041193351*^9}, 3.940055098003147*^9, {3.9400563032766733`*^9, 
   3.9400563117259502`*^9}, 3.940056500008369*^9, {3.954552593751648*^9, 
   3.9545525985041885`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"dd5191dc-bda1-4f1b-8452-d4c715b37568"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"U1War", " ", "=", " ", 
     RowBox[{"Mean", "[", 
      RowBox[{"{", 
       RowBox[{"U1War1", ",", "U1War2"}], "}"}], "]"}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"U2War", " ", "=", " ", 
     RowBox[{"Mean", "[", 
      RowBox[{"{", 
       RowBox[{"U2War1", ",", "U2War2"}], "}"}], "]"}]}], ";"}], " ", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.940056297449254*^9, 3.940056317948804*^9}, {
  3.9545526010192966`*^9, 3.9545526040352955`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"7a95404d-3df8-4ca3-80d8-8b9a219c990d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"===", 
    RowBox[{"==", 
     RowBox[{"CRISIS", " ", "GAME", " ", "AMPLITUDE", " ", "FUNCTIONS"}]}], "===",
     "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Player", " ", 
    RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "fighting", 
    " ", "after", " ", "Player", " ", "2", " ", "fights"}], "*)"}]}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"b3eda1c4-5e4e-7e4c-b78d-7d40ff1b51d6"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"aF1afterF2", "[", 
      RowBox[{
      "U1War_", ",", "U1Cap1_", ",", "\[Lambda]_", ",", "\[Theta]1a_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U1War"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1War"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1Cap1"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]1a", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "fighting", " ", "after", " ", "Player", " ", "2", " ", "fights"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"aNF1afterF2", "[", 
      RowBox[{
      "U1War_", ",", "U1Cap1_", ",", "\[Lambda]_", ",", "\[Theta]1a_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U1Cap1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1War"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1Cap1"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]1a", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "fighting", 
     " ", "after", " ", "Player", " ", "2", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "fight"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"aF1afterNF2", "[", 
      RowBox[{
      "U1Cap2_", ",", "U1Nego_", ",", "\[Lambda]_", ",", "\[Theta]1b_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U1Cap2"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1Cap2"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1Nego"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]1b", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "fighting", " ", "after", " ", "Player", " ", "2", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "fight"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"aNF1afterNF2", "[", 
      RowBox[{
      "U1Cap2_", ",", "U1Nego_", ",", "\[Lambda]_", ",", "\[Theta]1b_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U1Nego"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1Cap2"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1Nego"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]1b", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "fighting", 
     " ", "after", " ", "Player", " ", "1", " ", "fights"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"aF2afterF1", "[", 
      RowBox[{
      "U2War_", ",", "U2Cap2_", ",", "\[Lambda]_", ",", "\[Theta]2a_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U2War"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2War"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2Cap2"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]2a", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "fighting", " ", "after", " ", "Player", " ", "1", " ", "fights"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"aNF2afterF1", "[", 
      RowBox[{
      "U2War_", ",", "U2Cap2_", ",", "\[Lambda]_", ",", "\[Theta]2a_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U2Cap2"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2War"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2Cap2"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]2a", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "fighting", 
     " ", "after", " ", "Player", " ", "1", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "fight"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"aF2afterNF1", "[", 
      RowBox[{
      "U2Cap1_", ",", "U2Nego_", ",", "\[Lambda]_", ",", "\[Theta]2b_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U2Cap1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2Cap1"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2Nego"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]2b", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "fighting", " ", "after", " ", "Player", " ", "1", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "fight"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"aNF2afterNF1", "[", 
      RowBox[{
      "U2Cap1_", ",", "U2Nego_", ",", "\[Lambda]_", ",", "\[Theta]2b_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U2Nego"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2Cap1"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2Nego"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]2b", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.954543555950741*^9, 3.954543570190647*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"6a74c307-4745-3444-b346-17d95704923f"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.953940086682584*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"18720e29-c57e-4463-9604-b09b99b42fa1"],

Cell[CellGroupData[{

Cell["Crisis Game Probability Functions", "Subsubsection",
 CellChangeTimes->{{3.940058773195057*^9, 3.940058786167494*^9}, {
  3.940059169505356*^9, 3.940059172066579*^9}, {3.9545436040348835`*^9, 
  3.954543614994194*^9}},ExpressionUUID->"2d5e6ee2-d436-4353-8471-\
3db1208d367f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "1", " ", 
    "fighting"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"aF1", "[", 
      RowBox[{"pF2norm_", ",", "aF1afterF2_", ",", "aF1afterNF2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", "pF2norm", "]"}], "*", "aF1afterF2"}], ")"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", "pF2norm"}], "]"}], "*", "aF1afterNF2"}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "1", " ", "fighting"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pF1", "[", "aF1_", "]"}], ":=", 
     RowBox[{"aF1", "*", 
      RowBox[{"Conjugate", "[", "aF1", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "1", " ", 
     "not", " ", "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"aNF1", "[", 
      RowBox[{"pF2norm_", ",", "aNF1afterF2_", ",", "aNF1afterNF2_"}], "]"}], 
     ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", "pF2norm", "]"}], "*", "aNF1afterF2"}], ")"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", "pF2norm"}], "]"}], "*", "aNF1afterNF2"}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "1", " ", "not", " ", 
     "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pNF1", "[", "aNF1_", "]"}], ":=", 
     RowBox[{"aNF1", "*", 
      RowBox[{"Conjugate", "[", "aNF1", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "1", " ",
      "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pF1norm", "[", 
      RowBox[{"pF1_", ",", "pNF1_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"denominator", "=", 
         RowBox[{"pF1", "+", "pNF1"}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
         RowBox[{"pF1", "/", "denominator"}]}], "]"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"Avoid", " ", "division", " ", "by", " ", "zero"}], "*)"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "1", " ",
      "not", " ", "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pNF1norm", "[", 
      RowBox[{"pF1_", ",", "pNF1_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"denominator", "=", 
         RowBox[{"pF1", "+", "pNF1"}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
         RowBox[{"pNF1", "/", "denominator"}]}], "]"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"Avoid", " ", "division", " ", "by", " ", "zero"}], "*)"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "2", " ", 
     "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"aF2", "[", 
      RowBox[{"pF1norm_", ",", "aF2afterF1_", ",", "aF2afterNF1_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", "pF1norm", "]"}], "*", "aF2afterF1"}], ")"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", "pF1norm"}], "]"}], "*", "aF2afterNF1"}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "2", " ", "fighting"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pF2", "[", "aF2_", "]"}], ":=", 
     RowBox[{"aF2", "*", 
      RowBox[{"Conjugate", "[", "aF2", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "2", " ", 
     "not", " ", "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"aNF2", "[", 
      RowBox[{"pF1norm_", ",", "aNF2afterF1_", ",", "aNF2afterNF1_"}], "]"}], 
     ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", "pF1norm", "]"}], "*", "aNF2afterF1"}], ")"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", "pF1norm"}], "]"}], "*", "aNF2afterNF1"}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "2", " ", "not", " ", 
     "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pNF2", "[", "aNF2_", "]"}], ":=", 
     RowBox[{"aNF2", "*", 
      RowBox[{"Conjugate", "[", "aNF2", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "2", " ",
      "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pF2norm", "[", 
      RowBox[{"pF2_", ",", "pNF2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"denominator", "=", 
         RowBox[{"pF2", "+", "pNF2"}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
         RowBox[{"pF2", "/", "denominator"}]}], "]"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"Avoid", " ", "division", " ", "by", " ", "zero"}], "*)"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "2", " ",
      "not", " ", "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pNF2norm", "[", 
      RowBox[{"pF2_", ",", "pNF2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"denominator", "=", 
         RowBox[{"pF2", "+", "pNF2"}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
         RowBox[{"pNF2", "/", "denominator"}]}], "]"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"Avoid", " ", "division", " ", "by", " ", "zero"}], "*)"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.954543640744057*^9, 3.9545436407450542`*^9}, 
   3.954543784072422*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"f0cbf99a-971d-a84e-89e7-8df4ee28500e"],

Cell["\<\
pF1 = pF2 * pF1afterF2 + pNF2 * pF1afterNF2 + \
2*Sqrt[pF2*pNF2]*aF1afterF2*aF1afterNF2*Cos[\[Theta]1a-\[Theta]1b]
pF1 depends only phase difference \[CapitalDelta]\[Theta]1 = \[Theta]1a-\
\[Theta]1b, as expected\
\>", "Text",
 CellChangeTimes->{{3.940058405044473*^9, 3.940058413054665*^9}, 
   3.940058513216623*^9, {3.940058792829997*^9, 3.94005879468471*^9}, {
   3.9400683065491366`*^9, 3.940068328246517*^9}, {3.9402982973555603`*^9, 
   3.94029831696215*^9}, 
   3.953951514464675*^9},ExpressionUUID->"1d7e8e82-a778-4c48-94d2-\
4cd3050af9f1"],

Cell["\<\

that gives us two equations with two variables (pF1norm, pF2norm) => unique \
set of pF1norm, pF2norm satisfying the conditions
in our balanced dataset, we have 375 cases (War1, War2, Cap1, Cap2, Nego) of \
crisis game, we can look at this stage of IIG, without combining it with \
demands game
we can look for what combination of \[CapitalDelta]\[Theta]1 and \
\[CapitalDelta]\[Theta]2 does the model has the highest fit with the \
empirical observations
\
\>", "Text",
 CellChangeTimes->{{3.940067420672287*^9, 3.940067533044093*^9}, {
   3.9400675683397045`*^9, 3.940067572931327*^9}, 3.9400680208719797`*^9, {
   3.9400681559942694`*^9, 3.940068248013302*^9}, {3.940068355912633*^9, 
   3.940068380587064*^9}, 3.940068423606187*^9, {3.94006854559795*^9, 
   3.9400685987086277`*^9}},ExpressionUUID->"75f710e7-23de-4eb0-a9ae-\
80059d2050db"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demands Game", "Subsubsection",
 CellChangeTimes->{{3.940068978237526*^9, 3.940068986662768*^9}, {
  3.954543672503771*^9, 
  3.954543674235422*^9}},ExpressionUUID->"7fc05352-8e72-471b-8c5a-\
598dd4f4a68a"],

Cell[TextData[{
 "to add the demand stage of the game (needed for the comparability to \
Signorino and de Mesquita), we proceed analogically to crisis game\n\n",
 Cell[BoxData[GridBox[{
    {
     RowBox[{"demands", " ", "game"}], "D2", "nD2"},
    {"D1", 
     RowBox[{"U1Cris", ",", " ", "U2Cris"}], 
     RowBox[{"U1Acq2", ",", " ", "U2Acq2"}]},
    {"nD1", 
     RowBox[{"U1Acq1", ",", " ", "U2Acq1"}], 
     RowBox[{"U1SQ", ",", " ", "U2SQ"}]}
   },
   GridBoxDividers->{"Columns" -> {{True}}, "Rows" -> {{True}}}]],
  ExpressionUUID->"aa1f94e3-e7ba-4b94-8258-d8c76a261e09"]
}], "Text",
 CellChangeTimes->{{3.9400690064879513`*^9, 3.9400691318310113`*^9}, {
   3.940069193885707*^9, 3.940069206844496*^9}, {3.940069339272258*^9, 
   3.9400693448821087`*^9}, 
   3.9400695124840593`*^9},ExpressionUUID->"be76a49a-e94c-452b-b4e5-\
c1610a1d05c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"U1Cris", " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"pF1norm", "*", "pF2norm", "*", "U1War"}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{"pF1norm", "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", "pF2norm"}], ")"}], "*", "U1Cap2"}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "pF1norm"}], ")"}], "*", "pF2norm", "*", "U1Cap1"}], 
     ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "pF1norm"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", "pF2norm"}], ")"}], "*", "U1Nego"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U2Cris", " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"pF1norm", "*", "pF2norm", "*", "U2War"}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{"pF1norm", "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", "pF2norm"}], ")"}], "*", "U2Cap2"}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "pF1norm"}], ")"}], "*", "pF2norm", "*", "U2Cap1"}], 
     ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "pF1norm"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", "pF2norm"}], ")"}], "*", "U2Nego"}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.940069126353564*^9, 3.940069181030837*^9}, {
  3.940069249376362*^9, 3.940069498345443*^9}, {3.9400695403518314`*^9, 
  3.940069801570524*^9}, {3.940298388799241*^9, 3.940298402659832*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"92fb8eb3-38cd-4bd7-b7d0-add8c75edc8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Player", " ", 
    RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "demanding", 
    " ", "after", " ", "Player", " ", "2", " ", "demands"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"aD1afterD2", "[", 
      RowBox[{
      "U1Cris_", ",", "U1Acq1_", ",", "\[Lambda]_", ",", "\[Theta]3a_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U1Cris"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1Cris"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1Acq1"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]3a", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "demanding", " ", "after", " ", "Player", " ", "2", " ", "demands"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"aND1afterD2", "[", 
      RowBox[{
      "U1Cris_", ",", "U1Acq1_", ",", "\[Lambda]_", ",", "\[Theta]3a_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U1Acq1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1Cris"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1Acq1"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]3a", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "demanding", 
     " ", "after", " ", "Player", " ", "2", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "demand"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"aD1afterND2", "[", 
      RowBox[{
      "U1Acq2_", ",", "U1SQ_", ",", "\[Lambda]_", ",", "\[Theta]3b_"}], "]"}],
      ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U1Acq2"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1Acq2"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1SQ"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]3b", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "demanding", " ", "after", " ", "Player", " ", "2", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "demand"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"aND1afterND2", "[", 
      RowBox[{
      "U1Acq2_", ",", "U1SQ_", ",", "\[Lambda]_", ",", "\[Theta]3b_"}], "]"}],
      ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U1SQ"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1Acq2"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U1SQ"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]3b", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "demanding", 
     " ", "after", " ", "Player", " ", "1", " ", "demands"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"aD2afterD1", "[", 
      RowBox[{
      "U2Cris_", ",", "U2Acq2_", ",", "\[Lambda]_", ",", "\[Theta]4a_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U2Cris"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2Cris"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2Acq2"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]4a", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "demanding", " ", "after", " ", "Player", " ", "1", " ", "demands"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"aND2afterD1", "[", 
      RowBox[{
      "U2Cris_", ",", "U2Acq2_", ",", "\[Lambda]_", ",", "\[Theta]4a_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U2Acq2"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2Cris"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2Acq2"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]4a", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "demanding", 
     " ", "after", " ", "Player", " ", "1", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "demand"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"aD2afterND1", "[", 
      RowBox[{
      "U2Acq1_", ",", "U2SQ_", ",", "\[Lambda]_", ",", "\[Theta]4b_"}], "]"}],
      ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U2Acq1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2Acq1"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2SQ"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]4b", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "demanding", " ", "after", " ", "Player", " ", "1", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "demand"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"aND2afterND1", "[", 
      RowBox[{
      "U2Acq1_", ",", "U2SQ_", ",", "\[Lambda]_", ",", "\[Theta]4b_"}], "]"}],
      ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"numerator", "=", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", "U2SQ"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denominator", "=", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2Acq1"}], ")"}]}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "U2SQ"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitude", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"I", " ", 
             RowBox[{"Re", "[", "\[Theta]4b", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.954543705657528*^9, 3.954543705657528*^9}, 
   3.9545437752842464`*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"59f90979-ffd9-fa4e-9c50-0477df4a0d17"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"===", 
   RowBox[{"==", 
    RowBox[{"DEMANDS", " ", "GAME", " ", "PROBABILITY", " ", "FUNCTIONS"}]}], 
   "===", "=="}], "*)"}]], "Input",
 CellChangeTimes->{{3.954543718378208*^9, 3.954543718378208*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"f522d8df-ddef-ff45-b146-5810c40eaa56"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "1", " ", 
    "demanding"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"aD1", "[", 
      RowBox[{"pD2norm_", ",", "aD1afterD2_", ",", "aD1afterND2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", "pD2norm", "]"}], "*", "aD1afterD2"}], ")"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", "pD2norm"}], "]"}], "*", "aD1afterND2"}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "1", " ", "demanding"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pD1", "[", "aD1_", "]"}], ":=", 
     RowBox[{"aD1", "*", 
      RowBox[{"Conjugate", "[", "aD1", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "1", " ", 
     "not", " ", "demanding"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"aND1", "[", 
      RowBox[{"pD2norm_", ",", "aND1afterD2_", ",", "aND1afterND2_"}], "]"}], 
     ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", "pD2norm", "]"}], "*", "aND1afterD2"}], ")"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", "pD2norm"}], "]"}], "*", "aND1afterND2"}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "1", " ", "not", " ", 
     "demanding"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pND1", "[", "aND1_", "]"}], ":=", 
     RowBox[{"aND1", "*", 
      RowBox[{"Conjugate", "[", "aND1", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "1", " ",
      "demanding"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pD1norm", "[", 
      RowBox[{"pD1_", ",", "pND1_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"denominator", "=", 
         RowBox[{"pD1", "+", "pND1"}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
         RowBox[{"pD1", "/", "denominator"}]}], "]"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"Avoid", " ", "division", " ", "by", " ", "zero"}], "*)"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "1", " ",
      "not", " ", "demanding"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pND1norm", "[", 
      RowBox[{"pD1_", ",", "pND1_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"denominator", "=", 
         RowBox[{"pD1", "+", "pND1"}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
         RowBox[{"pND1", "/", "denominator"}]}], "]"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"Avoid", " ", "division", " ", "by", " ", "zero"}], "*)"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "2", " ", 
     "demanding"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"aD2", "[", 
      RowBox[{"pD1norm_", ",", "aD2afterD1_", ",", "aD2afterND1_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", "pD1norm", "]"}], "*", "aD2afterD1"}], ")"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", "pD1norm"}], "]"}], "*", "aD2afterND1"}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "2", " ", "demanding"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pD2", "[", "aD2_", "]"}], ":=", 
     RowBox[{"aD2", "*", 
      RowBox[{"Conjugate", "[", "aD2", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "2", " ", 
     "not", " ", "demanding"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"aND2", "[", 
      RowBox[{"pD1norm_", ",", "aND2afterD1_", ",", "aND2afterND1_"}], "]"}], 
     ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", "pD1norm", "]"}], "*", "aND2afterD1"}], ")"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", "pD1norm"}], "]"}], "*", "aND2afterND1"}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "2", " ", "not", " ", 
     "demanding"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pND2", "[", "aND2_", "]"}], ":=", 
     RowBox[{"aND2", "*", 
      RowBox[{"Conjugate", "[", "aND2", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "2", " ",
      "demanding"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pD2norm", "[", 
      RowBox[{"pD2_", ",", "pND2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"denominator", "=", 
         RowBox[{"pD2", "+", "pND2"}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
         RowBox[{"pD2", "/", "denominator"}]}], "]"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"Avoid", " ", "division", " ", "by", " ", "zero"}], "*)"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "2", " ",
      "not", " ", "demanding"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pND2norm", "[", 
      RowBox[{"pD2_", ",", "pND2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"denominator", "=", 
         RowBox[{"pD2", "+", "pND2"}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
         RowBox[{"pND2", "/", "denominator"}]}], "]"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"Avoid", " ", "division", " ", "by", " ", "zero"}], "*)"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.954543746168347*^9, 3.954543765483829*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"a1bf14ad-7c61-d74b-8992-6bad0c830749"],

Cell["\<\

now there are 4 phases which we can to solve for to find the best fit with \
the empirical observations
\[CapitalDelta]\[Theta]1 ... phase connected to the decision to \
\[OpenCurlyDoubleQuote]fight/not fight\[CloseCurlyDoubleQuote] of the 1st \
player
\[CapitalDelta]\[Theta]2 ... phase connected to the decision to \
\[OpenCurlyDoubleQuote]fight/not fight\[CloseCurlyDoubleQuote] of the 2nd \
player
\[CapitalDelta]\[Theta]3 ... phase connected to the decision to \
\[OpenCurlyDoubleQuote]demand/not demand\[CloseCurlyDoubleQuote] of the 1st \
player
\[CapitalDelta]\[Theta]4 ... phase connected to the decision to \
\[OpenCurlyDoubleQuote]demand/not demand\[CloseCurlyDoubleQuote] of the 2nd \
player

we can set \[CapitalDelta]\[Theta]1=\[CapitalDelta]\[Theta]3 and \
\[CapitalDelta]\[Theta]2=\[CapitalDelta]\[Theta]4 if necessary\
\>", "Text",
 CellChangeTimes->{{3.940298583341305*^9, 3.94029863854385*^9}, {
   3.940298676347785*^9, 3.940298901861158*^9}, 
   3.9545436995042667`*^9},ExpressionUUID->"602c86a0-7b60-4042-ad17-\
eab6553c1ef8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Functions", "Section"]], "Chapter",
 CellChangeTimes->{{3.952131256973952*^9, 3.952131297933844*^9}, {
   3.9539402951916103`*^9, 3.953940307039828*^9}, 3.953940722525565*^9, {
   3.9545437517800255`*^9, 3.954543757425564*^9}, 
   3.954545777847124*^9},ExpressionUUID->"e9b4b5d2-07be-4507-8fdb-\
03f26a8cdd26"],

Cell[CellGroupData[{

Cell["FindCrisisEquilibrium", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
  3.954545764862734*^9, 3.954545772351383*^9}},
 FontWeight->"Plain",ExpressionUUID->"216ec60a-991a-194c-af15-0000aa17d4db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FindCrisisEquilibrium", ":", "\[IndentingNewLine]", "  ", 
     RowBox[{
     "Finds", " ", "the", " ", "equilibrium", " ", "probabilities", " ", 
      "for", " ", "the", " ", "crisis", " ", "game", " ", "given", " ", 
      "utility", " ", "values", " ", "and", " ", "phase", " ", "differences", 
      " ", "between", " ", "quantum", " ", 
      RowBox[{"states", ".", "\[IndentingNewLine]", "Parameters"}]}], ":", 
     "\[IndentingNewLine]", "\t ", 
     RowBox[{"-", "u1War"}]}], ",", "u1Cap1", ",", "u1Cap2", ",", 
    RowBox[{"u1Nego", ":", 
     RowBox[{
      RowBox[{"Player", " ", 
       RowBox[{"1", "'"}], "s", " ", "utilities", " ", "for", " ", 
       "different", " ", "outcomes"}], "\[IndentingNewLine]", "\t", "-", 
      "u2War"}]}], ",", "u2Cap2", ",", "u2Cap1", ",", 
    RowBox[{"u2Nego", ":", 
     RowBox[{
      RowBox[{"Player", " ", 
       RowBox[{"2", "'"}], "s", " ", "utilities", " ", "for", " ", 
       "different", " ", "outcomes"}], "\[IndentingNewLine]", "\t", "-", 
      "lambda"}], ":", 
     RowBox[{
      RowBox[{
      "Decision", " ", "parameter", " ", "controlling", " ", "rationality", 
       " ", 
       RowBox[{"(", 
        RowBox[{"higher", "=", 
         RowBox[{"more", " ", "rational"}]}], ")"}]}], "\[IndentingNewLine]", 
      "\t", "-", "deltaTheta1"}]}], ",", 
    RowBox[{"deltaTheta2", ":", 
     RowBox[{
      RowBox[{
      "Phase", " ", "differences", " ", "for", " ", "Players", " ", "1", " ", 
       "and", " ", "2"}], "\[IndentingNewLine]", "\t", "-", "maxIter"}], ":", 
     RowBox[{
      RowBox[{
      "Maximum", " ", "number", " ", "of", " ", "iterations", " ", "for", " ",
        "convergence"}], "\[IndentingNewLine]", "\t", "-", 
      RowBox[{"tolerance", ":", 
       RowBox[{
        RowBox[{"Convergence", " ", "threshold"}], "\[IndentingNewLine]", 
        "  ", "-", "verbose"}], ":", 
       RowBox[{
       "Whether", " ", "to", " ", "record", " ", "detailed", " ", "iteration",
         " ", "history"}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FindCrisisEquilibrium", "[", 
     RowBox[{
     "u1War_", ",", "u1Cap1_", ",", "u1Cap2_", ",", "u1Nego_", ",", "u2War_", 
      ",", "\[IndentingNewLine]", "\t\t\t\t      ", "u2Cap2_", ",", "u2Cap1_",
       ",", "u2Nego_", ",", "\[IndentingNewLine]", "\t\t\t\t      ", 
      "lambda_", ",", "deltaTheta1_", ",", "deltaTheta2_", ",", 
      "\[IndentingNewLine]", "\t\t\t\t      ", 
      RowBox[{"maxIter_", ":", "100"}], ",", 
      RowBox[{"tolerance_", ":", 
       RowBox[{"10", "^", 
        RowBox[{"-", "6"}]}]}], ",", "\[IndentingNewLine]", "\t\t\t\t      ", 
      RowBox[{"verbose_", ":", "False"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pF1normCurrent", "=", "0.5"}], ",", "\[IndentingNewLine]", 
        RowBox[{"pF2normCurrent", "=", "0.5"}], ",", "\[IndentingNewLine]", 
        "pF1normNext", ",", "\[IndentingNewLine]", "pF2normNext", ",", 
        "\[IndentingNewLine]", "a1F2", ",", "a1NF2", ",", "a1F1", ",", 
        "a1NF1", ",", "p1F1", ",", "p1NF1", ",", "\[IndentingNewLine]", 
        "a2F1", ",", "a2NF1", ",", "a2F2", ",", "a2NF2", ",", "p2F2", ",", 
        "p2NF2", ",", "\[IndentingNewLine]", "theta1a", ",", "theta1b", ",", 
        "theta2a", ",", "theta2b", ",", "\[IndentingNewLine]", "pWar", ",", 
        "pCap2", ",", "pCap1", ",", "pNego", ",", "\[IndentingNewLine]", 
        RowBox[{"iter", "=", "0"}], ",", 
        RowBox[{"converged", "=", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"iterationHistory", "=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "totalProb"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Set", " ", "phase", " ", "differences"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"theta1a", "=", 
        RowBox[{"deltaTheta1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"theta1b", "=", 
        RowBox[{
         RowBox[{"-", "deltaTheta1"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"theta2a", "=", 
        RowBox[{"deltaTheta2", "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"theta2b", "=", 
        RowBox[{
         RowBox[{"-", "deltaTheta2"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Initial", " ", "probabilities"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"pWar", "=", 
        RowBox[{"Re", "[", 
         RowBox[{"pF1normCurrent", "*", "pF2normCurrent"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pCap2", "=", 
        RowBox[{"Re", "[", 
         RowBox[{"pF1normCurrent", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pF2normCurrent"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pCap1", "=", 
        RowBox[{"Re", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "pF1normCurrent"}], ")"}], "*", 
          "pF2normCurrent"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pNego", "=", 
        RowBox[{"Re", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "pF1normCurrent"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pF2normCurrent"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Keep", " ", "a", " ", "log", " ", "for", " ", "debugging", " ", 
         "purposes"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"iterationHistory", ",", "\[IndentingNewLine]", 
           RowBox[{"<|", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<Iteration\>\"", "->", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<pF1\>\"", "->", 
              RowBox[{"Re", "[", "pF1normCurrent", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<pF2\>\"", "->", 
              RowBox[{"Re", "[", "pF2normCurrent", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<theta1a\>\"", "->", "theta1a"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<theta1b\>\"", "->", "theta1b"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<deltaTheta1\>\"", "->", "deltaTheta1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<theta2a\>\"", "->", "theta2a"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<theta2b\>\"", "->", "theta2b"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<deltaTheta2\>\"", "->", "deltaTheta2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<pWar\>\"", "->", 
              RowBox[{"Re", "[", "pWar", "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<pCap2\>\"", "->", 
              RowBox[{"Re", "[", "pCap2", "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<pCap1\>\"", "->", 
              RowBox[{"Re", "[", "pCap1", "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<pNego\>\"", "->", 
              RowBox[{"Re", "[", "pNego", "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<TotalProb\>\"", "->", 
              RowBox[{"pWar", "+", "pCap2", "+", "pCap1", "+", "pNego"}]}]}], 
            "\[IndentingNewLine]", "|>"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"iter", "<", "maxIter"}], "&&", 
          RowBox[{"!", "converged"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Calculate", " ", "amplitudes", " ", "for", " ", "player", " ", 
           "1"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"a1F2", "=", 
           RowBox[{"aF1afterF2", "[", 
            RowBox[{"u1War", ",", "u1Cap1", ",", "lambda", ",", "theta1a"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a1NF2", "=", 
           RowBox[{"aNF1afterF2", "[", 
            RowBox[{"u1War", ",", "u1Cap1", ",", "lambda", ",", "theta1a"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a1F1", "=", 
           RowBox[{"aF1", "[", 
            RowBox[{"pF2normCurrent", ",", "a1F2", ",", 
             RowBox[{"aF1afterNF2", "[", 
              RowBox[{
              "u1Cap2", ",", "u1Nego", ",", "lambda", ",", "theta1b"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a1NF1", "=", 
           RowBox[{"aNF1", "[", 
            RowBox[{"pF2normCurrent", ",", "a1NF2", ",", 
             RowBox[{"aNF1afterNF2", "[", 
              RowBox[{
              "u1Cap2", ",", "u1Nego", ",", "lambda", ",", "theta1b"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p1F1", "=", 
           RowBox[{"pF1", "[", "a1F1", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p1NF1", "=", 
           RowBox[{"pNF1", "[", "a1NF1", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pF1normNext", "=", 
           RowBox[{"pF1norm", "[", 
            RowBox[{"p1F1", ",", "p1NF1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Calculate", " ", "amplitudes", " ", "for", " ", "player", " ", 
            "2"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"a2F1", "=", 
           RowBox[{"aF2afterF1", "[", 
            RowBox[{"u2War", ",", "u2Cap2", ",", "lambda", ",", "theta2a"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a2NF1", "=", 
           RowBox[{"aNF2afterF1", "[", 
            RowBox[{"u2War", ",", "u2Cap2", ",", "lambda", ",", "theta2a"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a2F2", "=", 
           RowBox[{"aF2", "[", 
            RowBox[{"pF1normCurrent", ",", "a2F1", ",", 
             RowBox[{"aF2afterNF1", "[", 
              RowBox[{
              "u2Cap1", ",", "u2Nego", ",", "lambda", ",", "theta2b"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a2NF2", "=", 
           RowBox[{"aNF2", "[", 
            RowBox[{"pF1normCurrent", ",", "a2NF1", ",", 
             RowBox[{"aNF2afterNF1", "[", 
              RowBox[{
              "u2Cap1", ",", "u2Nego", ",", "lambda", ",", "theta2b"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p2F2", "=", 
           RowBox[{"pF2", "[", "a2F2", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p2NF2", "=", 
           RowBox[{"pNF2", "[", "a2NF2", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pF2normNext", "=", 
           RowBox[{"pF2norm", "[", 
            RowBox[{"p2F2", ",", "p2NF2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Calculate", " ", "outcome", " ", "probabilities"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"pWar", "=", 
           RowBox[{"Re", "[", 
            RowBox[{"pF1normCurrent", "*", "pF2normCurrent"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pCap2", "=", 
           RowBox[{"Re", "[", 
            RowBox[{"pF1normCurrent", "*", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pF2normCurrent"}], ")"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pCap1", "=", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "pF1normCurrent"}], ")"}], "*", 
             "pF2normCurrent"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pNego", "=", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "pF1normCurrent"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pF2normCurrent"}], ")"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Check", " ", "total", " ", "probability", " ", "for", " ", 
            "consistency"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"totalProb", "=", 
           RowBox[{"pWar", "+", "pCap2", "+", "pCap1", "+", "pNego"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"totalProb", "-", "1.0"}], "]"}], ">", 
             RowBox[{"10", "^", 
              RowBox[{"-", "10"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Warning: Total probability differs from 1.0: \>\"", ",", 
               "totalProb"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Calculate", " ", "convergence", " ", "before", " ", "updating", 
            " ", "values"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"converged", "=", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"pF1normNext", "-", "pF1normCurrent"}], "]"}], "<", 
             "tolerance"}], "&&", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"pF2normNext", "-", "pF2normCurrent"}], "]"}], "<", 
             "tolerance"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Track", " ", "iteration", " ", "if", " ", "verbose"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"verbose", ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"iterationHistory", ",", "\[IndentingNewLine]", 
              RowBox[{"<|", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<Iteration\>\"", "->", "iter"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<pF1\>\"", "->", 
                 RowBox[{"Re", "[", "pF1normCurrent", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<pF2\>\"", "->", 
                 RowBox[{"Re", "[", "pF2normCurrent", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<theta1a\>\"", "->", "theta1a"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<theta1b\>\"", "->", "theta1b"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<deltaTheta1\>\"", "->", "deltaTheta1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<theta2a\>\"", "->", "theta2a"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<theta2b\>\"", "->", "theta2b"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<deltaTheta2\>\"", "->", "deltaTheta2"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<DeltapF1\>\"", "->", 
                 RowBox[{"Abs", "[", 
                  RowBox[{"pF1normNext", "-", "pF1normCurrent"}], "]"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<DeltapF2\>\"", "->", 
                 RowBox[{"Abs", "[", 
                  RowBox[{"pF2normNext", "-", "pF2normCurrent"}], "]"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<pWar\>\"", "->", "pWar"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<pCap2\>\"", "->", "pCap2"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<pCap1\>\"", "->", "pCap1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<pNego\>\"", "->", "pNego"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<TotalProb\>\"", "->", "totalProb"}]}], "|>"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Update", " ", "for", " ", "next", " ", "iteration"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"pF1normCurrent", "=", 
           RowBox[{"Re", "[", "pF1normNext", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pF2normCurrent", "=", 
           RowBox[{"Re", "[", "pF2normNext", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"iter", "++"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Return", " ", "equilibrium", " ", "probabilities", " ", "and", " ", 
         "outcomes"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<Converged\>\"", "->", "converged"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Iterations\>\"", "->", "iter"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<pF1\>\"", "->", 
          RowBox[{"Re", "[", "pF1normCurrent", "]"}]}], ",", "\n", "\t", 
         RowBox[{"\"\<pF2\>\"", "->", 
          RowBox[{"Re", "[", "pF2normCurrent", "]"}]}], ",", "\n", "\t", 
         RowBox[{"\"\<pWar\>\"", "->", "pWar"}], ",", "\n", "\t", 
         RowBox[{"\"\<pCap2\>\"", "->", "pCap2"}], ",", "\n", "\t", 
         RowBox[{"\"\<pCap1\>\"", "->", "pCap1"}], ",", "\n", "\t", 
         RowBox[{"\"\<pNego\>\"", "->", "pNego"}], ",", "\n", "\t", 
         RowBox[{"\"\<TotalProb\>\"", "->", "totalProb"}], ",", "\n", "\t", 
         RowBox[{"\"\<IterationHistory\>\"", "->", 
          RowBox[{"If", "[", 
           RowBox[{"verbose", ",", "iterationHistory", ",", "Null"}], 
           "]"}]}]}], "\n", "|>"}]}]}], "\n", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.953940350327085*^9, 3.9539404078140087`*^9, 3.954543897126564*^9, {
   3.954545290455843*^9, 3.954545695554203*^9}, {3.954545732501692*^9, 
   3.954545733853496*^9}, 3.954547344033398*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"bf115939-a91c-490b-a2df-58338346514c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FindFullEquilibrium", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
  3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
  3.954545817149481*^9}},
 FontWeight->"Plain",ExpressionUUID->"367be9c2-97e8-c245-b723-e3e7ad61614e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", "   ", 
   RowBox[{
    RowBox[{"FindFullEquilibrium", ":", 
     RowBox[{
     "Finds", " ", "the", " ", "equilibrium", " ", "for", " ", "the", " ", 
      "full", " ", "game", " ", 
      RowBox[{"(", 
       RowBox[{"demands", "+", "crisis"}], ")"}], " ", "given", " ", 
      "utility", " ", "values", " ", "and", " ", "phase", " ", 
      RowBox[{"differences", ".", "\[IndentingNewLine]", "Parameters"}]}], 
     ":", "\[IndentingNewLine]", "\t ", 
     RowBox[{"-", "u1War"}]}], ",", "u1Cap1", ",", "u1Cap2", ",", "u1Nego", 
    ",", "u1SQ", ",", "u1Acq1", ",", 
    RowBox[{"u1Acq2", ":", 
     RowBox[{
      RowBox[{"Player", " ", 
       RowBox[{"1", "'"}], "s", " ", "utilities"}], "\[IndentingNewLine]", 
      "\t", "-", "u2War"}]}], ",", "u2Cap2", ",", "u2Cap1", ",", "u2Nego", 
    ",", "u2SQ", ",", "u2Acq1", ",", 
    RowBox[{"u2Acq2", ":", 
     RowBox[{
      RowBox[{"Player", " ", 
       RowBox[{"2", "'"}], "s", " ", "utilities"}], "\[IndentingNewLine]", 
      "\t", "-", "lambda"}], ":", 
     RowBox[{
      RowBox[{"Decision", " ", "parameter"}], "\[IndentingNewLine]", "\t", 
      "-", "deltaTheta1"}]}], ",", 
    RowBox[{"deltaTheta2", ":", 
     RowBox[{
      RowBox[{
      "Phase", " ", "differences", " ", "for", " ", "crisis", " ", "game"}], 
      "\[IndentingNewLine]", "\t", "-", "deltaTheta3"}]}], ",", 
    RowBox[{"deltaTheta4", ":", 
     RowBox[{
      RowBox[{
      "Phase", " ", "differences", " ", "for", " ", "demands", " ", "game"}], 
      "\[IndentingNewLine]", "\t", "-", "maxIter"}], ":", 
     RowBox[{
      RowBox[{"Maximum", " ", "iterations"}], "\[IndentingNewLine]", "\t", 
      "-", 
      RowBox[{"tolerance", ":", 
       RowBox[{
        RowBox[{"Convergence", " ", "threshold"}], "\[IndentingNewLine]", 
        "  ", "-", "verbose"}], ":", 
       RowBox[{"Detailed", " ", "logging"}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FindFullEquilibrium", "[", "\[IndentingNewLine]", 
     RowBox[{
     "u1War_", ",", "u1Cap1_", ",", "u1Cap2_", ",", "u1Nego_", ",", "u1SQ_", 
      ",", "\[IndentingNewLine]", "u1Acq1_", ",", "u1Acq2_", ",", "u2War_", 
      ",", "u2Cap2_", ",", "u2Cap1_", ",", "\[IndentingNewLine]", "u2Nego_", 
      ",", "u2SQ_", ",", "u2Acq1_", ",", "u2Acq2_", ",", 
      "\[IndentingNewLine]", "lambda_", ",", "\[IndentingNewLine]", 
      "deltaTheta1_", ",", "deltaTheta2_", ",", "deltaTheta3_", ",", 
      "deltaTheta4_", ",", "\[IndentingNewLine]", 
      RowBox[{"maxIter_", ":", "100"}], ",", "\[IndentingNewLine]", 
      RowBox[{"tolerance_", ":", 
       RowBox[{"10", "^", 
        RowBox[{"-", "6"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"verbose_", ":", "False"}]}], "\[IndentingNewLine]", "]"}], ":=",
     "\[IndentingNewLine]", "\t", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "crisisEq", ",", "u1Cris", ",", "u2Cris", ",", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"pD1normCurrent", "=", "0.5"}], ",", 
        RowBox[{"pD2normCurrent", "=", "0.5"}], ",", "\[IndentingNewLine]", 
        "\t", "pD1normNext", ",", "pD2normNext", ",", "\[IndentingNewLine]", 
        "\t", "a1D2", ",", "a1ND2", ",", "a1D1", ",", "a1ND1", ",", "p1D1", 
        ",", "p1ND1", ",", "\[IndentingNewLine]", "\t", "a2D1", ",", "a2ND1", 
        ",", "a2D2", ",", "a2ND2", ",", "p2D2", ",", "p2ND2", ",", 
        "\[IndentingNewLine]", "\t", "crisisPWar", ",", "crisisPCap1", ",", 
        "crisisPCap2", ",", "crisisPNego", ",", "\[IndentingNewLine]", "\t", 
        "theta3a", ",", "theta3b", ",", "theta4a", ",", "theta4b", ",", 
        "\[IndentingNewLine]", "\t", "pCrisis", ",", "pAcq2", ",", "pAcq1", 
        ",", "pSQ", ",", "totalProb", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"iter", "=", "0"}], ",", 
        RowBox[{"converged", "=", "False"}], ",", 
        RowBox[{"iterationHistory", "=", 
         RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Set", " ", "phase", " ", "differences", " ", "for", " ", "demands", 
        " ", "game"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"theta3a", "=", 
        RowBox[{"deltaTheta3", "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"theta3b", "=", 
        RowBox[{
         RowBox[{"-", "deltaTheta3"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"theta4a", "=", 
        RowBox[{"deltaTheta4", "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"theta4b", "=", 
        RowBox[{
         RowBox[{"-", "deltaTheta4"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "First", " ", "find", " ", "crisis", " ", "game", " ", 
         "equilibrium"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"crisisEq", "=", 
        RowBox[{"FindCrisisEquilibrium", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
         "u1War", ",", "u1Cap1", ",", "u1Cap2", ",", "u1Nego", ",", "u2War", 
          ",", "u2Cap2", ",", "u2Cap1", ",", "u2Nego", ",", 
          "\[IndentingNewLine]", "\t\t\t", "lambda", ",", "deltaTheta1", ",", 
          "deltaTheta2", ",", "maxIter", ",", "tolerance", ",", "verbose"}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Check", " ", "if", " ", "crisis", " ", "game", " ", "converged"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"crisisEq", "[", "\"\<Converged\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"verbose", ",", 
            RowBox[{
            "Print", "[", "\"\<Warning: Crisis game did not converge.\>\"", 
             "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Extract", " ", "the", " ", "individual", " ", "probability", " ", 
         "values"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"crisisPWar", "=", 
        RowBox[{"crisisEq", "[", "\"\<pWar\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"crisisPCap1", "=", 
        RowBox[{"crisisEq", "[", "\"\<pCap1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"crisisPCap2", "=", 
        RowBox[{"crisisEq", "[", "\"\<pCap2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"crisisPNego", "=", 
        RowBox[{"crisisEq", "[", "\"\<pNego\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Calculate", " ", "expected", " ", "crisis", " ", "utilities"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"u1Cris", "=", 
        RowBox[{
         RowBox[{"crisisPWar", "*", "u1War"}], "+", 
         RowBox[{"crisisPCap2", "*", "u1Cap2"}], "+", 
         RowBox[{"crisisPCap1", "*", "u1Cap1"}], "+", 
         RowBox[{"crisisPNego", "*", "u1Nego"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"u2Cris", "=", 
        RowBox[{
         RowBox[{"crisisPWar", "*", "u2War"}], "+", 
         RowBox[{"crisisPCap2", "*", "u2Cap2"}], "+", 
         RowBox[{"crisisPCap1", "*", "u2Cap1"}], "+", 
         RowBox[{"crisisPNego", "*", "u2Nego"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Handle", " ", "extreme", " ", "utility", " ", "values", " ", "with", 
         " ", "numerical", " ", "safeguards"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", "u1Cris", "]"}], ">", "100"}], "||", 
          RowBox[{
           RowBox[{"Abs", "[", "u2Cris", "]"}], ">", "100"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"verbose", ",", 
            RowBox[{
            "Print", "[", 
             "\"\<Warning: Very high crisis utilities may cause numerical \
instability\>\"", "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Initialize", " ", "demand", " ", "game", " ", "probabilities"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pCrisis", "=", 
        RowBox[{"Re", "[", 
         RowBox[{"pD1normCurrent", "*", "pD2normCurrent"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pAcq2", "=", 
        RowBox[{"Re", "[", 
         RowBox[{"pD1normCurrent", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pD2normCurrent"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pAcq1", "=", 
        RowBox[{"Re", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "pD1normCurrent"}], ")"}], "*", 
          "pD2normCurrent"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pSQ", "=", 
        RowBox[{"Re", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "pD1normCurrent"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pD2normCurrent"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"totalProb", "=", 
        RowBox[{"pCrisis", "+", "pAcq2", "+", "pAcq1", "+", "pSQ"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Record", " ", "initial", " ", "state", " ", "if", " ", "verbose"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"iterationHistory", ",", "\[IndentingNewLine]", 
           RowBox[{"<|", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<Iteration\>\"", "->", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<pD1\>\"", "->", 
              RowBox[{"Re", "[", "pD1normCurrent", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<pD2\>\"", "->", 
              RowBox[{"Re", "[", "pD2normCurrent", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<theta3a\>\"", "->", "theta3a"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<theta3b\>\"", "->", "theta3b"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<deltaTheta3\>\"", "->", "deltaTheta3"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<theta4a\>\"", "->", "theta4a"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<theta4b\>\"", "->", "theta4b"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<deltaTheta4\>\"", "->", "deltaTheta4"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<pCrisis\>\"", "->", "pCrisis"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<pAcq2\>\"", "->", "pAcq2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<pAcq1\>\"", "->", "pAcq1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<pSQ\>\"", "->", "pSQ"}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<TotalProb\>\"", "->", "totalProb"}]}], 
            "\[IndentingNewLine]", "|>"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "find", " ", "demands", " ", "game", " ", "equilibrium"}],
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"iter", "<", "maxIter"}], "&&", 
          RowBox[{"!", "converged"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Calculate", " ", "amplitudes", " ", "for", " ", "player", " ", 
           "1"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"a1D2", "=", 
           RowBox[{"aD1afterD2", "[", 
            RowBox[{"u1Cris", ",", "u1Acq1", ",", "lambda", ",", "theta3a"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a1ND2", "=", 
           RowBox[{"aND1afterD2", "[", 
            RowBox[{"u1Cris", ",", "u1Acq1", ",", "lambda", ",", "theta3a"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a1D1", "=", 
           RowBox[{"aD1", "[", 
            RowBox[{"pD2normCurrent", ",", "a1D2", ",", 
             RowBox[{"aD1afterND2", "[", 
              RowBox[{"u1Acq2", ",", "u1SQ", ",", "lambda", ",", "theta3b"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a1ND1", "=", 
           RowBox[{"aND1", "[", 
            RowBox[{"pD2normCurrent", ",", "a1ND2", ",", 
             RowBox[{"aND1afterND2", "[", 
              RowBox[{"u1Acq2", ",", "u1SQ", ",", "lambda", ",", "theta3b"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p1D1", "=", 
           RowBox[{"pD1", "[", "a1D1", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p1ND1", "=", 
           RowBox[{"pND1", "[", "a1ND1", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pD1normNext", "=", 
           RowBox[{"pD1norm", "[", 
            RowBox[{"p1D1", ",", "p1ND1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Calculate", " ", "amplitudes", " ", "for", " ", "player", " ", 
            "2"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"a2D1", "=", 
           RowBox[{"aD2afterD1", "[", 
            RowBox[{"u2Cris", ",", "u2Acq2", ",", "lambda", ",", "theta4a"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a2ND1", "=", 
           RowBox[{"aND2afterD1", "[", 
            RowBox[{"u2Cris", ",", "u2Acq2", ",", "lambda", ",", "theta4a"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a2D2", "=", 
           RowBox[{"aD2", "[", 
            RowBox[{"pD1normCurrent", ",", "a2D1", ",", 
             RowBox[{"aD2afterND1", "[", 
              RowBox[{"u2Acq1", ",", "u2SQ", ",", "lambda", ",", "theta4b"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a2ND2", "=", 
           RowBox[{"aND2", "[", 
            RowBox[{"pD1normCurrent", ",", "a2ND1", ",", 
             RowBox[{"aND2afterND1", "[", 
              RowBox[{"u2Acq1", ",", "u2SQ", ",", "lambda", ",", "theta4b"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p2D2", "=", 
           RowBox[{"pD2", "[", "a2D2", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p2ND2", "=", 
           RowBox[{"pND2", "[", "a2ND2", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pD2normNext", "=", 
           RowBox[{"pD2norm", "[", 
            RowBox[{"p2D2", ",", "p2ND2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Update", " ", "outcome", " ", "probabilities"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"pCrisis", "=", 
           RowBox[{"Re", "[", 
            RowBox[{"pD1normCurrent", "*", "pD2normCurrent"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pAcq2", "=", 
           RowBox[{"Re", "[", 
            RowBox[{"pD1normCurrent", "*", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pD2normCurrent"}], ")"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pAcq1", "=", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "pD1normCurrent"}], ")"}], "*", 
             "pD2normCurrent"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pSQ", "=", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "pD1normCurrent"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pD2normCurrent"}], ")"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"totalProb", "=", 
           RowBox[{"pCrisis", "+", "pAcq2", "+", "pAcq1", "+", "pSQ"}]}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Check", " ", "for", " ", "numerical", " ", "issues"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"totalProb", "-", "1.0"}], "]"}], ">", 
             RowBox[{"10", "^", 
              RowBox[{"-", "10"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"verbose", ",", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Warning: Total probability in demands game differs from \
1.0: \>\"", ",", "totalProb"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Check", " ", "convergence"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"converged", "=", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"pD1normNext", "-", "pD1normCurrent"}], "]"}], "<", 
             "tolerance"}], "&&", "\[IndentingNewLine]", "       ", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"pD2normNext", "-", "pD2normCurrent"}], "]"}], "<", 
             "tolerance"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Track", " ", "iteration", " ", "if", " ", "verbose"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"verbose", ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
             RowBox[{"iterationHistory", ",", "\[IndentingNewLine]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<Iteration\>\"", "->", "iter"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<pD1\>\"", "->", 
                 RowBox[{"Re", "[", "pD1normCurrent", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<pD2\>\"", "->", 
                 RowBox[{"Re", "[", "pD2normCurrent", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<theta3a\>\"", "->", "theta3a"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<theta3b\>\"", "->", "theta3b"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<deltaTheta3\>\"", "->", "deltaTheta3"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<theta4a\>\"", "->", "theta4a"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<theta4b\>\"", "->", "theta4b"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<deltaTheta4\>\"", "->", "deltaTheta4"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<DeltapD1\>\"", "->", 
                 RowBox[{"Abs", "[", 
                  RowBox[{"pD1normNext", "-", "pD1normCurrent"}], "]"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<DeltapD2\>\"", "->", 
                 RowBox[{"Abs", "[", 
                  RowBox[{"pD2normNext", "-", "pD2normCurrent"}], "]"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<pCrisis\>\"", "->", "pCrisis"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<pAcq2\>\"", "->", "pAcq2"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<pAcq1\>\"", "->", "pAcq1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<pSQ\>\"", "->", "pSQ"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<TotalProb\>\"", "->", "totalProb"}]}], 
               "\[IndentingNewLine]", "|>"}]}], "\[IndentingNewLine]", 
             "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Update", " ", "for", " ", "next", " ", "iteration"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"pD1normCurrent", "=", 
           RowBox[{"Re", "[", "pD1normNext", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pD2normCurrent", "=", 
           RowBox[{"Re", "[", "pD2normNext", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"iter", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Return", " ", "full", " ", "equilibrium", " ", "probabilities", " ", 
         "and", " ", "outcomes"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<CrisisEquilibrium\>\"", "->", "\[IndentingNewLine]", 
          RowBox[{"<|", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<pWar\>\"", "->", "crisisPWar"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<pCap1\>\"", "->", "crisisPCap1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<pCap2\>\"", "->", "crisisPCap2"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<pNego\>\"", "->", "crisisPNego"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<pF1\>\"", "->", 
             RowBox[{"crisisEq", "[", "\"\<pF1\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<pF2\>\"", "->", 
             RowBox[{"crisisEq", "[", "\"\<pF2\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Converged\>\"", "->", 
             RowBox[{"crisisEq", "[", "\"\<Converged\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Iterations\>\"", "->", 
             RowBox[{"crisisEq", "[", "\"\<Iterations\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<TotalProb\>\"", "->", 
             RowBox[{"crisisEq", "[", "\"\<TotalProb\>\"", "]"}]}]}], 
           "\[IndentingNewLine]", "|>"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<DemandsConverged\>\"", "->", "converged"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<DemandsIterations\>\"", "->", "iter"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<pD1\>\"", "->", 
          RowBox[{"Re", "[", "pD1normCurrent", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<pD2\>\"", "->", 
          RowBox[{"Re", "[", "pD2normCurrent", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<pCrisis\>\"", "->", "pCrisis"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<pAcq2\>\"", "->", "pAcq2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<pAcq1\>\"", "->", "pAcq1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<pSQ\>\"", "->", "pSQ"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<TotalProb\>\"", "->", "totalProb"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<ExpectedUtility1\>\"", "->", 
          RowBox[{
           RowBox[{"pCrisis", "*", "u1Cris"}], "+", 
           RowBox[{"pAcq2", "*", "u1Acq2"}], "+", 
           RowBox[{"pAcq1", "*", "u1Acq1"}], "+", 
           RowBox[{"pSQ", "*", "u1SQ"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<ExpectedUtility2\>\"", "->", 
          RowBox[{
           RowBox[{"pCrisis", "*", "u2Cris"}], "+", 
           RowBox[{"pAcq2", "*", "u2Acq2"}], "+", 
           RowBox[{"pAcq1", "*", "u2Acq1"}], "+", 
           RowBox[{"pSQ", "*", "u2SQ"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<DemandsIterationHistory\>\"", "->", 
          RowBox[{"If", "[", 
           RowBox[{"verbose", ",", "iterationHistory", ",", "Null"}], 
           "]"}]}]}], "\[IndentingNewLine]", "|>"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.954543933187343*^9, 3.954543933187343*^9}, {
  3.9545477504267826`*^9, 3.954547788169668*^9}, {3.954551990219875*^9, 
  3.954552472101898*^9}, {3.954556243987673*^9, 3.954556245108244*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"32998cc0-6de7-6341-b3c8-81297a95c20e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"FindOptimalPhases", ":", 
    RowBox[{
     RowBox[{
     "Uses", " ", "a", " ", "grid", " ", "search", " ", "to", " ", "find", 
      " ", "the", " ", "optimal", " ", "phase", " ", "differences", " ", 
      "that", " ", "maximize", " ", "the", " ", "log"}], "-", 
     RowBox[{
     "likelihood", " ", "of", " ", "observing", " ", "the", " ", "empirical", 
      " ", "outcome", " ", 
      RowBox[{"data", ".", "Parameters"}]}]}], ":", 
    RowBox[{"-", 
     RowBox[{"dataSet", ":", 
      RowBox[{
       RowBox[{
       "Dataset", " ", "containing", " ", "utility", " ", "values", " ", 
        "and", " ", "ground", " ", "truth", " ", "outcomes"}], "-", 
       "lambda"}], ":", 
      RowBox[{
       RowBox[{"Decision", " ", "parameter"}], "-", 
       RowBox[{"phaseGridSize", ":", 
        RowBox[{
         RowBox[{
         "Number", " ", "of", " ", "grid", " ", "points", " ", "for", " ", 
          "phase", " ", "search", " ", 
          RowBox[{"(", 
           RowBox[{"controls", " ", "precision"}], ")"}]}], "-", 
         "optimizationMethod"}], ":", 
        RowBox[{
         RowBox[{
         "\"\<GridSearch\>\"", " ", "or", " ", "\"\<RandomSampling\>\""}], 
         "-", 
         RowBox[{"numRandomSamples", ":", 
          RowBox[{
          "Number", " ", "of", " ", "random", " ", "phase", " ", 
           "combinations", " ", "to", " ", "test"}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FindOptimalPhases", "[", 
     RowBox[{"dataSet_", ",", "lambda_", ",", 
      RowBox[{"phaseGridSize_", ":", "10"}], ",", 
      RowBox[{"optimizationMethod_", ":", "\"\<GridSearch\>\""}], ",", 
      RowBox[{"numRandomSamples_", ":", "100"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phaseValues", ",", 
        RowBox[{"bestFit", "=", 
         RowBox[{"-", "Infinity"}]}], ",", "bestPhases", ",", "currentFit", 
        ",", "results", ",", "deltaTheta1", ",", "deltaTheta2", ",", 
        "deltaTheta3", ",", "deltaTheta4", ",", "safeLikelihood", ",", 
        "numToTest", ",", "rand01", ",", "statusCounter"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{
       "Create", " ", "grid", " ", "of", " ", "phase", " ", "values"}], 
       "*)"}], 
      RowBox[{
       RowBox[{"phaseValues", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"2", " ", "Pi", "*", 
            RowBox[{"i", "/", "phaseGridSize"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"phaseGridSize", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Initialize", " ", "best", " ", "phases"}], "*)"}], 
       RowBox[{"bestPhases", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Determine", " ", "method", " ", "and", " ", "number", " ", "of", " ",
          "tests"}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"optimizationMethod", "==", "\"\<GridSearch\>\""}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Grid", " ", "search"}], "-", 
           RowBox[{
           "test", " ", "all", " ", "combinations", " ", "of", " ", "4", " ", 
            "phases"}]}], "*)"}], 
         RowBox[{
          RowBox[{"numToTest", "=", 
           RowBox[{"phaseGridSize", "^", "4"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"numToTest", ">", "10000"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Warning: Grid search will test \>\"", ",", "numToTest", 
               ",", "\"\< combinations. This may take a long time.\>\""}], 
              "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "For", " ", "each", " ", "combination", " ", "of", " ", "phases"}],
            "*)"}], 
          RowBox[{"statusCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{"(*", 
            RowBox[{"Update", " ", "progress", " ", "every", " ", "5", "%"}], 
            "*)"}], 
           RowBox[{
            RowBox[{
             RowBox[{"statusCounter", "++"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"statusCounter", ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{"1", ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"numToTest", "/", "20"}], "]"}]}], "]"}]}], "]"}],
                 "==", "0"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Progress: \>\"", ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{"100.0", "*", 
                    RowBox[{"statusCounter", "/", "numToTest"}]}], "]"}], 
                  ",", "\"\<% complete\>\""}], "]"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Get", " ", "equilibrium", " ", "for", " ", "all", " ", "cases",
                " ", "in", " ", "dataset", " ", "with", " ", "these", " ", 
               "phase", " ", "parameters"}], "*)"}], 
             RowBox[{"results", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"row", "=", 
                    RowBox[{"dataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"FindFullEquilibrium", "[", 
                   RowBox[{
                    RowBox[{"row", "[", "\"\<U1War\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Cap1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Cap2\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Nego\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1SQ\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Acq1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Acq2\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2War\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Cap2\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Cap1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Nego\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2SQ\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Acq1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Acq2\>\"", "]"}], ",", 
                    "lambda", ",", "deltaTheta1", ",", "deltaTheta2", ",", 
                    "deltaTheta3", ",", "deltaTheta4"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", "dataSet", "]"}]}], "}"}]}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Calculate", " ", "fit", " ", "using", " ", "log"}], 
               "-", 
               RowBox[{
               "likelihood", " ", "with", " ", "numerical", " ", 
                "safeguards"}]}], "*)"}], 
             RowBox[{"currentFit", "=", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"row", "=", 
                    RowBox[{"dataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    RowBox[{"result", "=", 
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
                  RowBox[{
                   RowBox[{"safeLikelihood", "=", 
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<War\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pWar\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Cap1\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap1\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Cap2\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap2\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Nego\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pNego\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<SQ\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{"result", "[", "\"\<pSQ\>\"", "]"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Acq1\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{"result", "[", "\"\<pAcq1\>\"", "]"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Acq2\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{"result", "[", "\"\<pAcq2\>\"", "]"}]}], "]"}], 
                    "]"}], ",", "True", ",", "0"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", "safeLikelihood"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", "dataSet", "]"}]}], "}"}]}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Update", " ", "best", " ", "fit"}], "*)"}], 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"currentFit", ">", "bestFit"}], ",", 
               RowBox[{
                RowBox[{"bestFit", "=", "currentFit"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"bestPhases", "=", 
                 RowBox[{"{", 
                  RowBox[{
                  "deltaTheta1", ",", "deltaTheta2", ",", "deltaTheta3", ",", 
                   "deltaTheta4"}], "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<New best fit found: \>\"", ",", "bestFit", ",", 
                  "\"\< with phases: \>\"", ",", "bestPhases"}], "]"}], 
                ";"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"deltaTheta1", ",", "phaseValues"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"deltaTheta2", ",", "phaseValues"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"deltaTheta3", ",", "phaseValues"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"deltaTheta4", ",", "phaseValues"}], "}"}]}], "]"}]}], 
         ",", 
         RowBox[{"(*", 
          RowBox[{"Random", " ", "sampling", " ", "strategy"}], "*)"}], 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Using random sampling strategy with \>\"", ",", 
            "numRandomSamples", ",", "\"\< samples\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{"(*", 
            RowBox[{
            "Randomly", " ", "sample", " ", "phase", " ", "differences"}], 
            "*)"}], 
           RowBox[{
            RowBox[{
             RowBox[{"deltaTheta1", "=", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"2", " ", "Pi"}]}], "}"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"deltaTheta2", "=", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"2", " ", "Pi"}]}], "}"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"deltaTheta3", "=", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"2", " ", "Pi"}]}], "}"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"deltaTheta4", "=", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"2", " ", "Pi"}]}], "}"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Report", " ", "progress"}], "*)"}], 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{"1", ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"numRandomSamples", "/", "10"}], "]"}]}], "]"}]}],
                  "]"}], "==", "0"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Progress: \>\"", ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{"100.0", "*", 
                    RowBox[{"i", "/", "numRandomSamples"}]}], "]"}], ",", 
                  "\"\<% complete\>\""}], "]"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Get", " ", "equilibrium", " ", "for", " ", "all", " ", "cases",
                " ", "in", " ", "dataset", " ", "with", " ", "these", " ", 
               "random", " ", "phases"}], "*)"}], 
             RowBox[{"results", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"row", "=", 
                    RowBox[{"dataSet", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"FindFullEquilibrium", "[", 
                   RowBox[{
                    RowBox[{"row", "[", "\"\<U1War\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Cap1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Cap2\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Nego\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1SQ\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Acq1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Acq2\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2War\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Cap2\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Cap1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Nego\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2SQ\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Acq1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Acq2\>\"", "]"}], ",", 
                    "lambda", ",", "deltaTheta1", ",", "deltaTheta2", ",", 
                    "deltaTheta3", ",", "deltaTheta4"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", "dataSet", "]"}]}], "}"}]}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Calculate", " ", "fit", " ", "using", " ", "log"}], 
               "-", 
               RowBox[{
               "likelihood", " ", "with", " ", "numerical", " ", 
                "safeguards"}]}], "*)"}], 
             RowBox[{"currentFit", "=", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"row", "=", 
                    RowBox[{"dataSet", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                    RowBox[{"result", "=", 
                    RowBox[{"results", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], ",", 
                  RowBox[{
                   RowBox[{"safeLikelihood", "=", 
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<War\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pWar\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Cap1\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap1\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Cap2\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap2\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Nego\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pNego\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<SQ\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{"result", "[", "\"\<pSQ\>\"", "]"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Acq1\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{"result", "[", "\"\<pAcq1\>\"", "]"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Acq2\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{"result", "[", "\"\<pAcq2\>\"", "]"}]}], "]"}], 
                    "]"}], ",", "True", ",", "0"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", "safeLikelihood"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", "dataSet", "]"}]}], "}"}]}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Update", " ", "best", " ", "fit"}], "*)"}], 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"currentFit", ">", "bestFit"}], ",", 
               RowBox[{
                RowBox[{"bestFit", "=", "currentFit"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"bestPhases", "=", 
                 RowBox[{"{", 
                  RowBox[{
                  "deltaTheta1", ",", "deltaTheta2", ",", "deltaTheta3", ",", 
                   "deltaTheta4"}], "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<New best fit found: \>\"", ",", "bestFit", ",", 
                  "\"\< with phases: \>\"", ",", "bestPhases"}], "]"}], 
                ";"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "numRandomSamples"}], "}"}]}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Return", " ", "best", " ", "phases", " ", "and", " ", "fit"}], 
        "*)"}], 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<BestPhases\>\"", "->", "bestPhases"}], ",", 
         RowBox[{"\"\<LogLikelihood\>\"", "->", "bestFit"}], ",", 
         RowBox[{"\"\<Lambda\>\"", "->", "lambda"}], ",", 
         RowBox[{"\"\<Method\>\"", "->", "optimizationMethod"}]}], "|>"}]}]}],
      "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.954543965936157*^9, 3.9545439659371586`*^9}, {
  3.954556266320215*^9, 3.954556267074585*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"f4f5835e-5d1a-a740-810b-e4c9221bf4da"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PrepareDataset", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
  3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
  3.954545817149481*^9}, {3.9545459056234035`*^9, 3.954545908862875*^9}},
 FontWeight->"Plain",ExpressionUUID->"00ad7f89-3fe5-5545-955d-571d3d737b6a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"PrepareDataset", ":", 
   RowBox[{
   "Transforms", " ", "raw", " ", "data", " ", "into", " ", "the", " ", 
    "format", " ", "needed", " ", "for", " ", "model", " ", "analysis"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9545440045124226`*^9, 3.9545440045124226`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"13c459b4-16ca-ae4e-8940-fff20331dcae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PrepareDataset", "[", "dataset_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Agent1\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<Agent1\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<Agent2\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<Agent2\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<U1War\>\"", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dataset", "[", 
            RowBox[{"i", ",", "\"\<wrTu1wr1\>\""}], "]"}], "+", 
           RowBox[{"dataset", "[", 
            RowBox[{"i", ",", "\"\<wrTu1wr2\>\""}], "]"}]}], ")"}], "/", 
         "2"}]}], ",", 
       RowBox[{"\"\<U1Cap1\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<wrTu1cp1\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<U1Cap2\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<wrTu1cp2\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<U1Nego\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<wrTu1neg\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<U1SQ\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<wrTu1sq\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<U1Acq1\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<wrTu1ac1\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<U1Acq2\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<wrTu1ac2\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<U2War\>\"", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dataset", "[", 
            RowBox[{"i", ",", "\"\<wrTu2wr1\>\""}], "]"}], "+", 
           RowBox[{"dataset", "[", 
            RowBox[{"i", ",", "\"\<wrTu2wr2\>\""}], "]"}]}], ")"}], "/", 
         "2"}]}], ",", 
       RowBox[{"\"\<U2Cap1\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<wrTu2cp1\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<U2Cap2\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<wrTu2cp2\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<U2Nego\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<wrTu2neg\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<U2SQ\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<wrTu2sq\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<U2Acq1\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<wrTu2ac1\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<U2Acq2\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<wrTu2ac2\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<groundtruth\>\"", "->", 
        RowBox[{"dataset", "[", 
         RowBox[{"i", ",", "\"\<groundtruth\>\""}], "]"}]}]}], "|>"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "dataset", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[48]:=",ExpressionUUID->"2f87477f-6e3f-ca47-b558-a9316602e9ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PlotCrisisConvergence", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
  3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
  3.954545817149481*^9}, {3.9545459157835417`*^9, 3.954545919463518*^9}},
 FontWeight->"Plain",ExpressionUUID->"615555de-cfc2-9444-8c14-21a137803fb2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"PlotCrisisConvergence", ":", 
   RowBox[{
   "Visualizes", " ", "the", " ", "convergence", " ", "of", " ", "crisis", 
    " ", "game", " ", "probabilities"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9545440470301666`*^9, 3.9545440470301666`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"75130c9d-f6a8-424b-88d5-ddabe485dc0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PlotCrisisConvergence", "[", "history_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "playerPlot", ",", "outcomePlot", ",", "convergencePlot", ",", 
        "historyTable"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"Player", " ", "fight", " ", "probabilities"}], "*)"}], 
      RowBox[{
       RowBox[{"playerPlot", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"history", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "\"\<pF1\>\""}], "]"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"history", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "\"\<pF2\>\""}], "]"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
               "}"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"PlotLegends", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<Player 1\>\"", ",", "\"\<Player 2\>\""}], "}"}]}], 
          ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<Iteration\>\"", ",", "\"\<Probability\>\""}], 
            "}"}]}], ",", 
          RowBox[{
          "PlotLabel", "->", "\"\<Convergence of Fight Probabilities\>\""}], 
          ",", 
          RowBox[{"Joined", "->", "True"}], ",", 
          RowBox[{"Mesh", "->", "All"}], ",", 
          RowBox[{"PlotMarkers", "->", "Automatic"}], ",", 
          RowBox[{"GridLines", "->", "Automatic"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Outcome", " ", "probabilities"}], "*)"}], 
       RowBox[{"outcomePlot", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"history", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "\"\<pWar\>\""}], "]"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"history", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "\"\<pCap2\>\""}], "]"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"history", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "\"\<pCap1\>\""}], "]"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"history", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "\"\<pNego\>\""}], "]"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
               "}"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"PlotLegends", "->", 
           RowBox[{"{", 
            RowBox[{
            "\"\<pWar\>\"", ",", "\"\<pCap2\>\"", ",", "\"\<pCap1\>\"", ",", 
             "\"\<pNego\>\""}], "}"}]}], ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<Iteration\>\"", ",", "\"\<Probability\>\""}], 
            "}"}]}], ",", 
          RowBox[{
          "PlotLabel", "->", 
           "\"\<Convergence of Probabilities in Crisis Game\>\""}], ",", 
          RowBox[{"Joined", "->", "True"}], ",", 
          RowBox[{"Mesh", "->", "All"}], ",", 
          RowBox[{"PlotMarkers", "->", "Automatic"}], ",", 
          RowBox[{"GridLines", "->", "Automatic"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Convergence", " ", "rate"}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "history", "]"}], ">", "1"}], ",", 
         RowBox[{"convergencePlot", "=", 
          RowBox[{"ListLogPlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"history", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "\"\<DeltapF1\>\""}], "]"}],
                    "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"history", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "\"\<DeltapF2\>\""}], "]"}],
                    "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
                 "}"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"PlotLegends", "->", 
             RowBox[{"{", 
              RowBox[{"\"\<Player 1\>\"", ",", "\"\<Player 2\>\""}], "}"}]}], 
            ",", 
            RowBox[{"AxesLabel", "->", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Iteration\>\"", ",", "\"\<Log(\[CapitalDelta]p)\>\""}], 
              "}"}]}], ",", 
            RowBox[{"PlotLabel", "->", "\"\<Convergence Rate\>\""}], ",", 
            RowBox[{"Joined", "->", "True"}], ",", 
            RowBox[{"GridLines", "->", "Automatic"}]}], "]"}]}], ",", 
         RowBox[{"convergencePlot", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{
            "PlotLabel", "->", 
             "\"\<Insufficient data for convergence plot\>\""}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Iteration", " ", "table"}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "history", "]"}], ">", "1"}], ",", 
         RowBox[{"historyTable", "=", 
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Iteration\>\"", ",", "\"\<pF1\>\"", ",", "\"\<pF2\>\"", 
                ",", "\"\<DeltapF1\>\"", ",", "\"\<DeltapF2\>\"", ",", 
                "\"\<theta1a\>\"", ",", "\"\<theta1b\>\"", ",", 
                "\"\<theta2a\>\"", ",", "\"\<theta2b\>\"", ",", 
                "\"\<deltaTheta1\>\"", ",", "\"\<deltaTheta2\>\""}], "}"}], 
              "}"}], "~", "Join", "~", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"history", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "\"\<Iteration\>\""}], "]"}], "]"}], ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<pF1\>\""}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<pF2\>\""}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"i", ">", "1"}], ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<DeltapF1\>\""}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                   "\"\<-\>\""}], "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"i", ">", "1"}], ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<DeltapF2\>\""}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                   "\"\<-\>\""}], "]"}], ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<theta1a\>\""}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<theta1b\>\""}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<theta2a\>\""}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<theta2b\>\""}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<deltaTheta1\>\""}], "]"}], "]"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<deltaTheta2\>\""}], "]"}], "]"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"Length", "[", "history", "]"}], ",", "10"}], 
                  "]"}]}], "}"}]}], "]"}]}], ",", 
            RowBox[{"Frame", "->", "All"}], ",", 
            RowBox[{"Alignment", "->", "Center"}], ",", 
            RowBox[{"Background", "->", 
             RowBox[{"{", 
              RowBox[{"None", ",", 
               RowBox[{"{", 
                RowBox[{"LightGray", ",", "None"}], "}"}]}], "}"}]}]}], 
           "]"}]}], ",", 
         RowBox[{"historyTable", "=", 
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{"{", "\"\<No iteration data available\>\"", "}"}], "}"}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Return", " ", "all", " ", "visualizations"}], "*)"}], 
       RowBox[{"{", 
        RowBox[{
        "playerPlot", ",", "outcomePlot", ",", "convergencePlot", ",", 
         "historyTable"}], "}"}]}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.95454407063916*^9, 3.95454407063916*^9}, 
   3.954545929469103*^9, 3.9545532438824635`*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"55ab0b21-1bde-e442-8268-a03ce21975df"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PlotDemandsConvergence", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
  3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
  3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545951813015*^9}},
 FontWeight->"Plain",ExpressionUUID->"6f4cdabc-dac8-9e46-9f9f-79d8cd49d4fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"PlotDemandsConvergence", ":", 
    RowBox[{
    "Visualizes", " ", "the", " ", "convergence", " ", "of", " ", "demands", 
     " ", "game", " ", "probabilities"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PlotDemandsConvergence", "[", "history_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "playerPlot", ",", "outcomePlot", ",", "convergencePlot", ",", 
         "historyTable"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Player", " ", "demand", " ", "probabilities"}], "*)"}], 
       RowBox[{
        RowBox[{"playerPlot", "=", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"history", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "\"\<pD1\>\""}], "]"}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"history", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "\"\<pD2\>\""}], "]"}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"PlotLegends", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<Player 1\>\"", ",", "\"\<Player 2\>\""}], "}"}]}], 
           ",", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<Iteration\>\"", ",", "\"\<Probability\>\""}], 
             "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "->", "\"\<Convergence of Demand Probabilities\>\""}],
            ",", 
           RowBox[{"Joined", "->", "True"}], ",", 
           RowBox[{"Mesh", "->", "All"}], ",", 
           RowBox[{"PlotMarkers", "->", "Automatic"}], ",", 
           RowBox[{"GridLines", "->", "Automatic"}], ",", 
           RowBox[{"PlotRange", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Outcome", " ", "probabilities"}], "*)"}], 
        RowBox[{"outcomePlot", "=", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"history", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "\"\<pCrisis\>\""}], "]"}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"history", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "\"\<pAcq2\>\""}], "]"}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"history", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "\"\<pAcq1\>\""}], "]"}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"history", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "\"\<pSQ\>\""}], "]"}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"PlotLegends", "->", 
            RowBox[{"{", 
             RowBox[{
             "\"\<pCrisis\>\"", ",", "\"\<pAcq2\>\"", ",", "\"\<pAcq1\>\"", 
              ",", "\"\<pSQ\>\""}], "}"}]}], ",", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<Iteration\>\"", ",", "\"\<Probability\>\""}], 
             "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "->", 
            "\"\<Convergence of Probabilities in Demands Game\>\""}], ",", 
           RowBox[{"Joined", "->", "True"}], ",", 
           RowBox[{"Mesh", "->", "All"}], ",", 
           RowBox[{"PlotMarkers", "->", "Automatic"}], ",", 
           RowBox[{"GridLines", "->", "Automatic"}], ",", 
           RowBox[{"PlotRange", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Convergence", " ", "rate"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "history", "]"}], ">", "1"}], ",", 
          RowBox[{"convergencePlot", "=", 
           RowBox[{"ListLogPlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "\"\<DeltapD1\>\""}], "]"}],
                     "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
                  "}"}]}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "\"\<DeltapD2\>\""}], "]"}],
                     "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "history", "]"}], "-", "1"}]}], 
                  "}"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotLegends", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<Player 1\>\"", ",", "\"\<Player 2\>\""}], "}"}]}],
              ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Iteration\>\"", ",", "\"\<Log(\[CapitalDelta]p)\>\""}], 
               "}"}]}], ",", 
             RowBox[{
             "PlotLabel", "->", "\"\<Demand Game Convergence Rate\>\""}], ",", 
             RowBox[{"Joined", "->", "True"}], ",", 
             RowBox[{"GridLines", "->", "Automatic"}]}], "]"}]}], ",", 
          RowBox[{"convergencePlot", "=", 
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{
             "PlotLabel", "->", 
              "\"\<Insufficient data for convergence plot\>\""}]}], "]"}]}]}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Iteration", " ", "table"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "history", "]"}], ">", "1"}], ",", 
          RowBox[{"historyTable", "=", 
           RowBox[{"Grid", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                "\"\<Iteration\>\"", ",", "\"\<pD1\>\"", ",", "\"\<pD2\>\"", 
                 ",", "\"\<DeltapD1\>\"", ",", "\"\<DeltapD2\>\"", ",", 
                 "\"\<theta3a\>\"", ",", "\"\<theta3b\>\"", ",", 
                 "\"\<theta4a\>\"", ",", "\"\<theta4b\>\"", ",", 
                 "\"\<deltaTheta3\>\"", ",", "\"\<deltaTheta4\>\""}], "}"}], 
               "}"}], "~", "Join", "~", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<Iteration\>\""}], "]"}], "]"}], 
                  ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<pD1\>\""}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<pD2\>\""}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"i", ">", "1"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<DeltapD1\>\""}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                    "\"\<-\>\""}], "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"i", ">", "1"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<DeltapD2\>\""}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                    "\"\<-\>\""}], "]"}], ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<theta3a\>\""}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<theta3b\>\""}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<theta4a\>\""}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<theta4b\>\""}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<deltaTheta3\>\""}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "\"\<deltaTheta4\>\""}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", "history", "]"}], ",", "10"}], 
                   "]"}]}], "}"}]}], "]"}]}], ",", 
             RowBox[{"Frame", "->", "All"}], ",", 
             RowBox[{"Alignment", "->", "Center"}], ",", 
             RowBox[{"Background", "->", 
              RowBox[{"{", 
               RowBox[{"None", ",", 
                RowBox[{"{", 
                 RowBox[{"LightGray", ",", "None"}], "}"}]}], "}"}]}]}], 
            "]"}]}], ",", 
          RowBox[{"historyTable", "=", 
           RowBox[{"Grid", "[", 
            RowBox[{"{", 
             RowBox[{"{", "\"\<No iteration data available\>\"", "}"}], "}"}],
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Return", " ", "all", " ", "visualizations"}], "*)"}], 
        RowBox[{"{", 
         RowBox[{
         "playerPlot", ",", "outcomePlot", ",", "convergencePlot", ",", 
          "historyTable"}], "}"}]}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{3.954545934408604*^9},
 CellLabel->"In[50]:=",ExpressionUUID->"0279d52c-fc67-5d45-8558-cb79a0a1d374"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CreateSummaryTable", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
  3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
  3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545919463518*^9}, {
  3.954545955108715*^9, 3.9545459583816547`*^9}},
 FontWeight->"Plain",ExpressionUUID->"52e56281-474b-8549-8ddc-31a15e06a676"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Corrected", " ", "CreateSummaryTable", " ", "function"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"CreateSummaryTable", ":", 
    RowBox[{
    "Creates", " ", "a", " ", "summary", " ", "table", " ", "of", " ", 
     "outcome", " ", "probabilities", " ", "from", " ", "the", " ", "full", 
     " ", 
     RowBox[{"game", ".", "This"}], " ", "corrected", " ", "version", " ", 
     "properly", " ", "calculates", " ", "the", " ", "total", " ", 
     "probabilities", " ", "by", " ", "multiplying", " ", "crisis", " ", 
     "game", " ", "outcomes", " ", "by", " ", "the", " ", "probability", " ", 
     "of", " ", "the", " ", "crisis", " ", 
     RowBox[{"occurring", "."}]}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CreateSummaryTable", "[", "fullResult_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"crisisEq", "=", 
          RowBox[{"fullResult", "[", "\"\<CrisisEquilibrium\>\"", "]"}]}], 
         ",", 
         RowBox[{"crisisProb", "=", 
          RowBox[{"fullResult", "[", "\"\<pCrisis\>\"", "]"}]}], ",", 
         RowBox[{"(*", 
          RowBox[{"Calculate", " ", "total", " ", "probabilities"}], "*)"}], 
         "totalWarProb", ",", "totalCap1Prob", ",", "totalCap2Prob", ",", 
         "totalNegoProb", ",", 
         RowBox[{"(*", 
          RowBox[{"Calculate", " ", "marginal", " ", "probabilities"}], 
          "*)"}], "marginalWarProb", ",", "marginalCap1Prob", ",", 
         "marginalCap2Prob", ",", "marginalNegoProb"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Get", " ", "marginal", " ", "probabilities", " ", 
         RowBox[{"(", 
          RowBox[{"within", " ", "crisis", " ", "game"}], ")"}]}], "*)"}], 
       RowBox[{
        RowBox[{"marginalWarProb", "=", 
         RowBox[{"crisisEq", "[", "\"\<pWar\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"marginalCap1Prob", "=", 
         RowBox[{"crisisEq", "[", "\"\<pCap1\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"marginalCap2Prob", "=", 
         RowBox[{"crisisEq", "[", "\"\<pCap2\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"marginalNegoProb", "=", 
         RowBox[{"crisisEq", "[", "\"\<pNego\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Calculate", " ", "total", " ", "probabilities", " ", 
          RowBox[{"(", 
           RowBox[{
           "accounting", " ", "for", " ", "crisis", " ", "probability"}], 
           ")"}]}], "*)"}], 
        RowBox[{"totalWarProb", "=", 
         RowBox[{"crisisProb", "*", "marginalWarProb"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"totalCap1Prob", "=", 
         RowBox[{"crisisProb", "*", "marginalCap1Prob"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"totalCap2Prob", "=", 
         RowBox[{"crisisProb", "*", "marginalCap2Prob"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"totalNegoProb", "=", 
         RowBox[{"crisisProb", "*", "marginalNegoProb"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Create", " ", "the", " ", "summary", " ", "table", " ", "with", " ",
           "both", " ", "marginal", " ", "and", " ", "total", " ", 
          "probabilities"}], "*)"}], 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<Game Stage\>\"", ",", "\"\<Outcome\>\"", ",", 
              "\"\<Marginal Probability\>\"", ",", 
              "\"\<Total Probability\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Crisis Game\>\"", ",", "\"\<War\>\"", ",", 
              "marginalWarProb", ",", "totalWarProb"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Crisis Game\>\"", ",", "\"\<Capitulation 1\>\"", ",", 
              "marginalCap1Prob", ",", "totalCap1Prob"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Crisis Game\>\"", ",", "\"\<Capitulation 2\>\"", ",", 
              "marginalCap2Prob", ",", "totalCap2Prob"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Crisis Game\>\"", ",", "\"\<Negotiation\>\"", ",", 
              "marginalNegoProb", ",", "totalNegoProb"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Demands Game\>\"", ",", "\"\<Crisis\>\"", ",", 
              RowBox[{"fullResult", "[", "\"\<pCrisis\>\"", "]"}], ",", 
              RowBox[{"fullResult", "[", "\"\<pCrisis\>\"", "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Demands Game\>\"", ",", "\"\<Acquiescence 1\>\"", ",", 
              RowBox[{"fullResult", "[", "\"\<pAcq1\>\"", "]"}], ",", 
              RowBox[{"fullResult", "[", "\"\<pAcq1\>\"", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Demands Game\>\"", ",", "\"\<Acquiescence 2\>\"", ",", 
              RowBox[{"fullResult", "[", "\"\<pAcq2\>\"", "]"}], ",", 
              RowBox[{"fullResult", "[", "\"\<pAcq2\>\"", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Demands Game\>\"", ",", "\"\<Status Quo\>\"", ",", 
              RowBox[{"fullResult", "[", "\"\<pSQ\>\"", "]"}], ",", 
              RowBox[{"fullResult", "[", "\"\<pSQ\>\"", "]"}]}], "}"}]}], 
           "}"}], ",", 
          RowBox[{"Frame", "->", "All"}], ",", 
          RowBox[{"Alignment", "->", 
           RowBox[{"{", 
            RowBox[{"Left", ",", "Left", ",", "Right", ",", "Right"}], 
            "}"}]}], ",", 
          RowBox[{"Background", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LightGray", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "LightGray", ",", "None", ",", "LightGray", ",", "None", ",", 
               "LightGray", ",", "None", ",", "LightGray", ",", "None", ",", 
               "LightGray"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Dividers", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"None", ",", "None", ",", 
               RowBox[{"{", "True", "}"}], ",", "None"}], "}"}], ",", 
             "None"}], "}"}]}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.954546992123377*^9, 3.954547045001047*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"7f4951c0-3497-7447-9b5f-266837cb5cf9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CreateSummaryTableTotalOnly", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
  3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
  3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545919463518*^9}, {
  3.954545955108715*^9, 3.9545459583816547`*^9}, {3.954547010156273*^9, 
  3.954547011723858*^9}},
 FontWeight->"Plain",ExpressionUUID->"1f3df66f-ce49-e64d-86b0-210e69dd369a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Alternative", " ", "version", " ", "with", " ", "total", " ", 
    "probabilities", " ", "only"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CreateSummaryTableTotalOnly", "[", "fullResult_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"crisisEq", "=", 
          RowBox[{"fullResult", "[", "\"\<CrisisEquilibrium\>\"", "]"}]}], 
         ",", 
         RowBox[{"crisisProb", "=", 
          RowBox[{"fullResult", "[", "\"\<pCrisis\>\"", "]"}]}], ",", 
         RowBox[{"(*", 
          RowBox[{"Calculate", " ", "total", " ", "probabilities"}], "*)"}], 
         "totalWarProb", ",", "totalCap1Prob", ",", "totalCap2Prob", ",", 
         "totalNegoProb"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Calculate", " ", "total", " ", "probabilities", " ", 
         RowBox[{"(", 
          RowBox[{
          "accounting", " ", "for", " ", "crisis", " ", "probability"}], 
          ")"}]}], "*)"}], 
       RowBox[{
        RowBox[{"totalWarProb", "=", 
         RowBox[{"crisisProb", "*", 
          RowBox[{"crisisEq", "[", "\"\<pWar\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"totalCap1Prob", "=", 
         RowBox[{"crisisProb", "*", 
          RowBox[{"crisisEq", "[", "\"\<pCap1\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"totalCap2Prob", "=", 
         RowBox[{"crisisProb", "*", 
          RowBox[{"crisisEq", "[", "\"\<pCap2\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"totalNegoProb", "=", 
         RowBox[{"crisisProb", "*", 
          RowBox[{"crisisEq", "[", "\"\<pNego\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Create", " ", "the", " ", "summary", " ", "table", " ", "with", " ",
           "total", " ", "probabilities", " ", "only"}], "*)"}], 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<Game Stage\>\"", ",", "\"\<Outcome\>\"", ",", 
              "\"\<Total Probability\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Full Game\>\"", ",", "\"\<War\>\"", ",", "totalWarProb"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Full Game\>\"", ",", "\"\<Capitulation 1\>\"", ",", 
              "totalCap1Prob"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Full Game\>\"", ",", "\"\<Capitulation 2\>\"", ",", 
              "totalCap2Prob"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Full Game\>\"", ",", "\"\<Negotiation\>\"", ",", 
              "totalNegoProb"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Full Game\>\"", ",", "\"\<Crisis\>\"", ",", 
              RowBox[{"fullResult", "[", "\"\<pCrisis\>\"", "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Full Game\>\"", ",", "\"\<Acquiescence 1\>\"", ",", 
              RowBox[{"fullResult", "[", "\"\<pAcq1\>\"", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Full Game\>\"", ",", "\"\<Acquiescence 2\>\"", ",", 
              RowBox[{"fullResult", "[", "\"\<pAcq2\>\"", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Full Game\>\"", ",", "\"\<Status Quo\>\"", ",", 
              RowBox[{"fullResult", "[", "\"\<pSQ\>\"", "]"}]}], "}"}]}], 
           "}"}], ",", 
          RowBox[{"Frame", "->", "All"}], ",", 
          RowBox[{"Alignment", "->", 
           RowBox[{"{", 
            RowBox[{"Left", ",", "Left", ",", "Right"}], "}"}]}], ",", 
          RowBox[{"Background", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LightGray", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "LightGray", ",", "None", ",", "LightGray", ",", "None", ",", 
               "LightGray", ",", "None", ",", "LightGray", ",", "None", ",", 
               "LightGray"}], "}"}]}], "}"}]}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\n"}]}]], "Input",
 CellLabel->"In[52]:=",ExpressionUUID->"01dfd9a5-c21b-0649-8536-f4b69bda7029"]
}, Open  ]],

Cell[CellGroupData[{

Cell["VerifyFullGameProbabilities", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
  3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
  3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545919463518*^9}, {
  3.954545955108715*^9, 3.9545459583816547`*^9}, {3.954547010156273*^9, 
  3.9545470397221966`*^9}},
 FontWeight->"Plain",ExpressionUUID->"66ac1f4d-db24-bb40-bbaf-bb9f044efe0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "to", " ", "verify", " ", "that", " ", "probabilities", 
    " ", "sum", " ", "to", " ", "1"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"VerifyFullGameProbabilities", "[", "fullResult_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"crisisEq", "=", 
          RowBox[{"fullResult", "[", "\"\<CrisisEquilibrium\>\"", "]"}]}], 
         ",", 
         RowBox[{"crisisProb", "=", 
          RowBox[{"fullResult", "[", "\"\<pCrisis\>\"", "]"}]}], ",", 
         "totalWarProb", ",", "totalCap1Prob", ",", "totalCap2Prob", ",", 
         "totalNegoProb", ",", "totalSum", ",", "crisisSumCheck", ",", 
         "demandsSumCheck"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Calculate", " ", "total", " ", "probabilities"}], "*)"}], 
       RowBox[{
        RowBox[{"totalWarProb", "=", 
         RowBox[{"crisisProb", "*", 
          RowBox[{"crisisEq", "[", "\"\<pWar\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"totalCap1Prob", "=", 
         RowBox[{"crisisProb", "*", 
          RowBox[{"crisisEq", "[", "\"\<pCap1\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"totalCap2Prob", "=", 
         RowBox[{"crisisProb", "*", 
          RowBox[{"crisisEq", "[", "\"\<pCap2\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"totalNegoProb", "=", 
         RowBox[{"crisisProb", "*", 
          RowBox[{"crisisEq", "[", "\"\<pNego\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Verify", " ", "that", " ", "probabilities", " ", "sum", " ", "to", 
          " ", "1"}], "*)"}], 
        RowBox[{"totalSum", "=", 
         RowBox[{
         "totalWarProb", "+", "totalCap1Prob", "+", "totalCap2Prob", "+", 
          "totalNegoProb", "+", 
          RowBox[{"fullResult", "[", "\"\<pAcq1\>\"", "]"}], "+", 
          RowBox[{"fullResult", "[", "\"\<pAcq2\>\"", "]"}], "+", 
          RowBox[{"fullResult", "[", "\"\<pSQ\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"crisisSumCheck", "=", 
         RowBox[{
          RowBox[{"crisisEq", "[", "\"\<pWar\>\"", "]"}], "+", 
          RowBox[{"crisisEq", "[", "\"\<pCap1\>\"", "]"}], "+", 
          RowBox[{"crisisEq", "[", "\"\<pCap2\>\"", "]"}], "+", 
          RowBox[{"crisisEq", "[", "\"\<pNego\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"demandsSumCheck", "=", 
         RowBox[{
          RowBox[{"fullResult", "[", "\"\<pCrisis\>\"", "]"}], "+", 
          RowBox[{"fullResult", "[", "\"\<pAcq1\>\"", "]"}], "+", 
          RowBox[{"fullResult", "[", "\"\<pAcq2\>\"", "]"}], "+", 
          RowBox[{"fullResult", "[", "\"\<pSQ\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<TotalProbabilitySum\>\"", "->", "totalSum"}], ",", 
          RowBox[{"\"\<SumsToOne\>\"", "->", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"totalSum", "-", "1.0"}], "]"}], "<", 
            RowBox[{"10", "^", 
             RowBox[{"-", "10"}]}]}]}], ",", 
          RowBox[{"\"\<CrisisGameSum\>\"", "->", "crisisSumCheck"}], ",", 
          RowBox[{"\"\<DemandsGameSum\>\"", "->", "demandsSumCheck"}], ",", 
          RowBox[{"\"\<Crisis-War\>\"", "->", "totalWarProb"}], ",", 
          RowBox[{"\"\<Crisis-Cap1\>\"", "->", "totalCap1Prob"}], ",", 
          RowBox[{"\"\<Crisis-Cap2\>\"", "->", "totalCap2Prob"}], ",", 
          RowBox[{"\"\<Crisis-Nego\>\"", "->", "totalNegoProb"}], ",", 
          RowBox[{"\"\<Acquiescence 1\>\"", "->", 
           RowBox[{"fullResult", "[", "\"\<pAcq1\>\"", "]"}]}], ",", 
          RowBox[{"\"\<Acquiescence 2\>\"", "->", 
           RowBox[{"fullResult", "[", "\"\<pAcq2\>\"", "]"}]}], ",", 
          RowBox[{"\"\<Status Quo\>\"", "->", 
           RowBox[{"fullResult", "[", "\"\<pSQ\>\"", "]"}]}]}], "|>"}]}]}], 
      "]"}]}], ";"}], "\n"}]}]], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"7df1ea14-b90e-3149-95ab-a87110a725e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["VisualizeGridSearchHeatmap", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
  3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
  3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545919463518*^9}, {
  3.954545955108715*^9, 3.9545459583816547`*^9}, {3.954547010156273*^9, 
  3.9545470613362484`*^9}},
 FontWeight->"Plain",ExpressionUUID->"a9e620a9-1426-3f4e-a9ee-fa5561535c2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Grid", " ", "Search", " ", "Visualizations", " ", "for", " ", 
     "Quantum"}], "-", 
    RowBox[{"Like", " ", "Model"}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "code", " ", "provides", " ", "visualization", " ", "tools", 
     " ", "for", " ", "grid", " ", "search", " ", "optimization", " ", "in", 
     " ", "the", " ", "quantum"}], "-", 
    RowBox[{"like", " ", "international", " ", "relations", " ", 
     RowBox[{"model", ".", "It"}], " ", 
     RowBox[{"includes", ":", 
      RowBox[{
       RowBox[{
       "1.", " ", "Heatmap", " ", "visualizations", " ", "of", " ", 
        "parameter", " ", "space", " ", "2.", " ", "3", "D", " ", "surface", 
        " ", "plots", " ", "of", " ", "log"}], "-", 
       RowBox[{
       "likelihood", " ", "landscapes", " ", "3.", " ", "Optimization", " ", 
        "trajectory", " ", "tracking", " ", "and", " ", "visualization", " ", 
        "4.", " ", "Comparative", " ", "analysis", " ", "of", " ", 
        "different", " ", "optimization", " ", "methods", " ", "5.", " ", 
        "Parallel", " ", "coordinates", " ", "plots", " ", "for", " ", 
        "multi"}], "-", 
       RowBox[{"dimensional", " ", "analysis"}]}]}]}]}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{"===", 
    RowBox[{"==", 
     RowBox[{
     "GRID", " ", "SEARCH", " ", "VISUALIZATION", " ", "FUNCTIONS"}]}], "===",
     "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"VisualizeGridSearchHeatmap", ":", 
    RowBox[{
     RowBox[{"Creates", " ", "a", " ", "heatmap", " ", "of", " ", "log"}], 
     "-", 
     RowBox[{
     "likelihood", " ", "values", " ", "for", " ", "a", " ", "2", "D", " ", 
      "slice", " ", "of", " ", "the", " ", "parameter", " ", 
      RowBox[{"space", ".", "Parameters"}]}]}], ":", 
    RowBox[{"-", 
     RowBox[{"dataSet", ":", 
      RowBox[{
       RowBox[{
       "Dataset", " ", "containing", " ", "utility", " ", "values", " ", 
        "and", " ", "ground", " ", "truth", " ", "outcomes"}], "-", 
       "lambda"}], ":", 
      RowBox[{
       RowBox[{"Decision", " ", "parameter"}], "-", 
       RowBox[{"fixedParams", ":", 
        RowBox[{
         RowBox[{
         "Association", " ", "with", " ", "fixed", " ", "parameter", " ", 
          "values"}], "-", "varyParams"}], ":", 
        RowBox[{
         RowBox[{
         "List", " ", "of", " ", "two", " ", "parameters", " ", "to", " ", 
          "vary"}], "-", 
         RowBox[{"gridSize", ":", 
          RowBox[{
          "Number", " ", "of", " ", "grid", " ", "points", " ", "per", " ", 
           "dimension"}]}]}]}]}]}]}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"VisualizeGridSearchHeatmap", "[", 
     RowBox[{
     "dataSet_", ",", "lambda_", ",", "fixedParams_Association", ",", 
      "varyParams_List", ",", 
      RowBox[{"gridSize_", ":", "10"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "phaseValues", ",", "results", ",", "heatmapData", ",", "bestPoint", 
        ",", 
        RowBox[{"bestFit", "=", 
         RowBox[{"-", "Infinity"}]}], ",", "bestParams", ",", "xLabel", ",", 
        "yLabel"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"Validate", " ", "input"}], "*)"}], 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "varyParams", "]"}], "!=", "2"}], ",", 
         RowBox[{
          RowBox[{
          "Return", "[", 
           "\"\<Error: varyParams must contain exactly two parameters\>\"", 
           "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Create", " ", "grid", " ", "of", " ", "phase", " ", "values"}], 
        "*)"}], 
       RowBox[{"phaseValues", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"2", " ", "Pi", "*", 
            RowBox[{"i", "/", "gridSize"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"gridSize", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Initialize", " ", "results", " ", "grid"}], "*)"}], 
       RowBox[{"heatmapData", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "gridSize", "}"}], ",", 
          RowBox[{"{", "gridSize", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Set", " ", "x", " ", "and", " ", "y", " ", "axis", " ", "labels"}], 
        "*)"}], 
       RowBox[{"xLabel", "=", 
        RowBox[{"varyParams", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"yLabel", "=", 
        RowBox[{"varyParams", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Compute", " ", "likelihood", " ", "for", " ", "each", " ", "point", 
         " ", "in", " ", "the", " ", "grid"}], "*)"}], 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Computing likelihood values for \>\"", ",", "gridSize", ",", 
         "\"\<\[Times]\>\"", ",", "gridSize", ",", "\"\< grid...\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Initialize", " ", "progress", " ", "counter"}], "*)"}], 
       RowBox[{"statusCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"totalPoints", "=", 
        RowBox[{"gridSize", "^", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Loop", " ", "through", " ", "parameter", " ", "grid"}], 
        "*)"}], 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<=", "gridSize"}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<=", "gridSize"}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{"Update", " ", "progress"}], "*)"}], 
            RowBox[{
             RowBox[{"statusCounter", "++"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"statusCounter", ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{"1", ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"totalPoints", "/", "10"}], "]"}]}], "]"}]}], 
                 "]"}], "==", "0"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Progress: \>\"", ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{"100.0", "*", 
                    RowBox[{"statusCounter", "/", "totalPoints"}]}], "]"}], 
                  ",", "\"\<% complete\>\""}], "]"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Set", " ", "parameter", " ", "values"}], "*)"}], 
             RowBox[{"params", "=", "fixedParams"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"params", "[", 
               RowBox[{"varyParams", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "=", 
              RowBox[{"phaseValues", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"params", "[", 
               RowBox[{"varyParams", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "=", 
              RowBox[{"phaseValues", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Get", " ", "equilibrium", " ", "for", " ", "all", " ", "cases",
                " ", "in", " ", "dataset", " ", "with", " ", "these", " ", 
               "parameters"}], "*)"}], 
             RowBox[{"results", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"row", "=", 
                    RowBox[{"dataSet", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"FindFullEquilibrium", "[", 
                   RowBox[{
                    RowBox[{"row", "[", "\"\<U1War\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Cap1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Cap2\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Nego\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1SQ\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Acq1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Acq2\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2War\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Cap2\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Cap1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Nego\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2SQ\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Acq1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Acq2\>\"", "]"}], ",", 
                    "lambda", ",", 
                    RowBox[{"params", "[", "\"\<deltaTheta1\>\"", "]"}], ",", 
                    RowBox[{"params", "[", "\"\<deltaTheta2\>\"", "]"}], ",", 
                    RowBox[{"params", "[", "\"\<deltaTheta3\>\"", "]"}], ",", 
                    RowBox[{"params", "[", "\"\<deltaTheta4\>\"", "]"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", "dataSet", "]"}], ",", "10"}], 
                   "]"}]}], "}"}]}], "  ", 
               RowBox[{"(*", 
                RowBox[{
                "Limit", " ", "to", " ", "first", " ", "10", " ", "data", " ",
                  "points", " ", "for", " ", "efficiency"}], "*)"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Calculate", " ", "log"}], "-", 
               RowBox[{
               "likelihood", " ", "with", " ", "numerical", " ", 
                "safeguards"}]}], "*)"}], 
             RowBox[{"currentFit", "=", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"row", "=", 
                    RowBox[{"dataSet", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], ",", 
                    RowBox[{"result", "=", 
                    RowBox[{"results", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}]}], "}"}], ",", 
                  RowBox[{
                   RowBox[{"safeLikelihood", "=", 
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<War\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pWar\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Cap1\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap1\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Cap2\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap2\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Nego\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pNego\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<SQ\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{"result", "[", "\"\<pSQ\>\"", "]"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Acq1\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{"result", "[", "\"\<pAcq1\>\"", "]"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Acq2\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{"result", "[", "\"\<pAcq2\>\"", "]"}]}], "]"}], 
                    "]"}], ",", "True", ",", "0"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", "safeLikelihood"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", "dataSet", "]"}], ",", "10"}], 
                   "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Store", " ", "result", " ", "in", " ", "heatmap", " ", 
               "data"}], "*)"}], 
             RowBox[{
              RowBox[{"heatmapData", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "currentFit"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Update", " ", "best", " ", "fit"}], "*)"}], 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"currentFit", ">", "bestFit"}], ",", 
               RowBox[{
                RowBox[{"bestFit", "=", "currentFit"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"bestPoint", "=", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j"}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"bestParams", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"phaseValues", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"phaseValues", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], ";"}]}], "]"}],
              ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Create", " ", "heatmap", " ", "visualization"}], "*)"}], 
       RowBox[{"heatmap", "=", 
        RowBox[{"ArrayPlot", "[", 
         RowBox[{"heatmapData", ",", 
          RowBox[{"ColorFunction", "->", "\"\<Temperature\>\""}], ",", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"yLabel", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"xLabel", ",", "\"\<Log-Likelihood Heatmap\>\""}], 
              "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
          RowBox[{"DataRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", " ", "Pi"}]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"Epilog", "->", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"bestParams", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"bestParams", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Create", " ", "contour", " ", "plot"}], "*)"}], 
       RowBox[{"contourPlot", "=", 
        RowBox[{"ListContourPlot", "[", 
         RowBox[{"heatmapData", ",", 
          RowBox[{"ColorFunction", "->", "\"\<Temperature\>\""}], ",", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"yLabel", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"xLabel", ",", "\"\<Log-Likelihood Contours\>\""}], 
              "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
          RowBox[{"DataRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", " ", "Pi"}]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"Contours", "->", "15"}], ",", 
          RowBox[{"ContourLabels", "->", "True"}], ",", 
          RowBox[{"Epilog", "->", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"bestParams", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"bestParams", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Create", " ", "3", "D", " ", "surface", " ", "plot"}], 
        "*)"}], 
       RowBox[{"surfacePlot", "=", 
        RowBox[{"ListPlot3D", "[", 
         RowBox[{"heatmapData", ",", 
          RowBox[{"ColorFunction", "->", "\"\<Temperature\>\""}], ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"xLabel", ",", "yLabel", ",", "\"\<Log-Likelihood\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotLabel", "->", "\"\<Log-Likelihood Surface\>\""}], ",", 
          RowBox[{"DataRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", " ", "Pi"}]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
          RowBox[{"Mesh", "->", "10"}], ",", 
          RowBox[{"Epilog", "->", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"bestParams", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"bestParams", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Return", " ", "visualizations", " ", "and", " ", "best", " ", 
         "parameters"}], "*)"}], 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Heatmap\>\"", "->", "heatmap"}], ",", 
         RowBox[{"\"\<ContourPlot\>\"", "->", "contourPlot"}], ",", 
         RowBox[{"\"\<SurfacePlot\>\"", "->", "surfacePlot"}], ",", 
         RowBox[{"\"\<BestParameters\>\"", "->", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{
             RowBox[{"varyParams", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "->", 
             RowBox[{"bestParams", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"varyParams", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "->", 
             RowBox[{"bestParams", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"\"\<LogLikelihood\>\"", "->", "bestFit"}]}], "|>"}]}], 
         ",", 
         RowBox[{"\"\<HeatmapData\>\"", "->", "heatmapData"}]}], "|>"}]}]}], 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.95454602735985*^9, 3.95454602735985*^9}, {
  3.954547081245062*^9, 3.954547082666678*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"03efcd41-8af2-8748-bb80-da745ceb50a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["VisualizeOptimizationTrajectory", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
   3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
   3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545919463518*^9}, {
   3.954545955108715*^9, 3.9545459583816547`*^9}, {3.954547010156273*^9, 
   3.9545470613362484`*^9}, 3.954547108529665*^9},
 FontWeight->"Plain",ExpressionUUID->"27f52cdd-2aab-f643-b5d0-6db60e6f66ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"VisualizeOptimizationTrajectory", ":", 
    RowBox[{
    "Visualizes", " ", "the", " ", "optimization", " ", "path", " ", 
     "through", " ", "parameter", " ", 
     RowBox[{"space", ".", "Parameters"}]}], ":", 
    RowBox[{"-", 
     RowBox[{"optimizationHistory", ":", 
      RowBox[{
       RowBox[{
       "List", " ", "of", " ", "parameter", " ", "values", " ", "and", " ", 
        "likelihoods", " ", "from", " ", "optimization"}], "-", 
       "paramNames"}], ":", 
      RowBox[{
      "List", " ", "of", " ", "parameter", " ", "names", " ", "to", " ", 
       "visualize"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"VisualizeOptimizationTrajectory", "[", 
     RowBox[{"optimizationHistory_List", ",", "paramNames_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "trajectoryPlot", ",", "parameterTimeSeries", ",", "likelihoodPlot", 
        ",", "parallelPlot", ",", "bestSolutions", ",", "gradientGraph"}], 
       "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{
       "Extract", " ", "parameter", " ", "values", " ", "and", " ", 
        "likelihoods"}], "*)"}], 
      RowBox[{
       RowBox[{"parameterValues", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"point", "[", 
             RowBox[{"paramNames", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "paramNames", "]"}]}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"point", ",", "optimizationHistory"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"likelihoods", "=", 
        RowBox[{"optimizationHistory", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "\"\<LogLikelihood\>\""}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Plot", " ", "likelihood", " ", "over", " ", "iterations"}], 
        "*)"}], 
       RowBox[{"likelihoodPlot", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{"likelihoods", ",", 
          RowBox[{"PlotLabel", "->", "\"\<Log-Likelihood Progress\>\""}], ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<Iteration\>\"", ",", "\"\<Log-Likelihood\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotStyle", "->", "Red"}], ",", 
          RowBox[{"GridLines", "->", "Automatic"}], ",", 
          RowBox[{"PlotMarkers", "->", "Automatic"}], ",", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Parameter", " ", "time", " ", "series"}], "*)"}], 
       RowBox[{"parameterTimeSeries", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ListLinePlot", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"optimizationHistory", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"paramNames", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "optimizationHistory", "]"}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"PlotLabel", "->", 
             RowBox[{
              RowBox[{"paramNames", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "<>", 
              "\"\< Over Iterations\>\""}]}], ",", 
            RowBox[{"AxesLabel", "->", 
             RowBox[{"{", 
              RowBox[{"\"\<Iteration\>\"", ",", 
               RowBox[{"paramNames", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"PlotStyle", "->", 
             RowBox[{
              RowBox[{"ColorData", "[", "112", "]"}], "[", "j", "]"}]}], ",", 
            RowBox[{"GridLines", "->", "Automatic"}], ",", 
            RowBox[{"PlotRange", "->", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", " ", "Pi"}]}], "}"}]}], ",", 
            RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "paramNames", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Parallel", " ", "coordinates", " ", "plot"}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "paramNames", "]"}], ">=", "2"}], ",", 
         RowBox[{"(*", 
          RowBox[{
          "Create", " ", "data", " ", "for", " ", "parallel", " ", "plot"}], 
          "*)"}], 
         RowBox[{
          RowBox[{"parallelData", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"optimizationHistory", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"paramNames", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"Length", "[", "paramNames", "]"}]}], "}"}]}], 
                "]"}], ",", 
               RowBox[{"likelihoods", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "optimizationHistory", "]"}]}], "}"}]}],
             "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"parallelPlot", "=", 
           RowBox[{"ParallelAxisPlot", "[", 
            RowBox[{"parallelData", ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"Append", "[", 
               RowBox[{"paramNames", ",", "\"\<LogLikelihood\>\""}], "]"}]}], 
             ",", 
             RowBox[{
             "PlotLabel", "->", "\"\<Parameter Space Exploration\>\""}], ",", 
             RowBox[{"ColorFunction", "->", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
                 RowBox[{"Rescale", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", "likelihoods", "]"}], ",", 
                    RowBox[{"Max", "[", "likelihoods", "]"}]}], "}"}]}], 
                  "]"}], "]"}], "&"}], ")"}]}], ",", 
             RowBox[{"GridLines", "->", "Automatic"}], ",", 
             RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}]}], ",", 
         RowBox[{
         "parallelPlot", "=", 
          "\"\<Parallel coordinates plot requires at least 2 \
parameters\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Identify", " ", "top", " ", "solutions"}], "*)"}], 
       RowBox[{"bestIndices", "=", 
        RowBox[{"Ordering", "[", 
         RowBox[{
          RowBox[{"-", "likelihoods"}], ",", 
          RowBox[{"Min", "[", 
           RowBox[{"5", ",", 
            RowBox[{"Length", "[", "likelihoods", "]"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"bestSolutions", "=", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"optimizationHistory", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bestIndices", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"paramNames", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "paramNames", "]"}]}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{"likelihoods", "[", 
                   RowBox[{"[", 
                    RowBox[{"bestIndices", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"6", ",", "4"}], "}"}]}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "bestIndices", "]"}]}], "}"}]}], "]"}],
             ",", 
            RowBox[{"Append", "[", 
             RowBox[{"paramNames", ",", "\"\<LogLikelihood\>\""}], "]"}]}], 
           "]"}], ",", 
          RowBox[{"Frame", "->", "All"}], ",", 
          RowBox[{"Background", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "LightGray", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "LightGray", ",", "None", ",", "None", ",", "None", ",", 
               "None"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Return", " ", "all", " ", "visualizations"}], "*)"}], 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<LikelihoodProgress\>\"", "->", "likelihoodPlot"}], ",", 
         RowBox[{"\"\<ParameterTimeSeries\>\"", "->", "parameterTimeSeries"}],
          ",", 
         RowBox[{"\"\<ParallelCoordinates\>\"", "->", "parallelPlot"}], ",", 
         RowBox[{"\"\<BestSolutions\>\"", "->", "bestSolutions"}]}], 
        "|>"}]}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.9545471238729477`*^9, {3.954547162575781*^9, 3.954547183159096*^9}, {
   3.9545472142645607`*^9, 3.954547251694973*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"693d66af-8a3e-ed4f-b2dc-16550e1a721c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CompareOptimizationMethods", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
   3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
   3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545919463518*^9}, {
   3.954545955108715*^9, 3.9545459583816547`*^9}, {3.954547010156273*^9, 
   3.9545470613362484`*^9}, 3.954547108529665*^9, {3.9545471520041637`*^9, 
   3.954547178292944*^9}, {3.9545472201067657`*^9, 3.954547248564314*^9}},
 FontWeight->"Plain",ExpressionUUID->"46269c6c-f724-0748-a8c3-ee2c6b807115"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"CompareOptimizationMethods", ":", 
    RowBox[{
     RowBox[{
     "Compares", " ", "different", " ", "optimization", " ", "approaches", 
      " ", "based", " ", "on", " ", "final", " ", "log"}], "-", 
     RowBox[{"likelihood", " ", "and", " ", 
      RowBox[{"convergence", ".", "Parameters"}]}]}], ":", 
    RowBox[{"-", 
     RowBox[{"results", ":", 
      RowBox[{
      "Association", " ", "with", " ", "optimization", " ", "results", " ", 
       "from", " ", "different", " ", "methods"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CompareOptimizationMethods", "[", "results_Association", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "barChart", ",", "convergencePlot", ",", "parameterComparisonPlot", 
        ",", "methodNames", ",", "finalLikelihoods", ",", "iterationCounts", 
        ",", "numMethods", ",", "parameterValues", ",", "bestParams"}], "}"}],
       ",", 
      RowBox[{"(*", 
       RowBox[{
       "Extract", " ", "method", " ", "names", " ", "and", " ", "results"}], 
       "*)"}], 
      RowBox[{
       RowBox[{"methodNames", "=", 
        RowBox[{"Keys", "[", "results", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numMethods", "=", 
        RowBox[{"Length", "[", "methodNames", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Extract", " ", "final", " ", "likelihoods", " ", "and", " ", 
         "iteration", " ", "counts"}], "*)"}], 
       RowBox[{"finalLikelihoods", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"results", "[", "method", "]"}], "[", 
           "\"\<LogLikelihood\>\"", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"method", ",", "methodNames"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"iterationCounts", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"results", "[", "method", "]"}], "[", "\"\<Iterations\>\"",
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"method", ",", "methodNames"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Bar", " ", "chart", " ", "comparing", " ", "final", " ", 
         "likelihoods"}], "*)"}], 
       RowBox[{"barChart", "=", 
        RowBox[{"BarChart", "[", 
         RowBox[{"finalLikelihoods", ",", 
          RowBox[{"ChartLabels", "->", 
           RowBox[{"{", 
            RowBox[{"methodNames", ",", "None"}], "}"}]}], ",", 
          RowBox[{
          "PlotLabel", "->", "\"\<Final Log-Likelihood by Method\>\""}], ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"None", ",", "\"\<Log-Likelihood\>\""}], "}"}]}], ",", 
          RowBox[{"ChartStyle", "->", "\"\<Pastel\>\""}], ",", 
          RowBox[{"GridLines", "->", "Automatic"}], ",", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Iteration", " ", "counts", " ", "comparison"}], "*)"}], 
       RowBox[{"iterationPlot", "=", 
        RowBox[{"BarChart", "[", 
         RowBox[{"iterationCounts", ",", 
          RowBox[{"ChartLabels", "->", 
           RowBox[{"{", 
            RowBox[{"methodNames", ",", "None"}], "}"}]}], ",", 
          RowBox[{
          "PlotLabel", "->", "\"\<Iterations Required by Method\>\""}], ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"None", ",", "\"\<Iterations\>\""}], "}"}]}], ",", 
          RowBox[{"ChartStyle", "->", "\"\<Pastel\>\""}], ",", 
          RowBox[{"GridLines", "->", "Automatic"}], ",", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Parameter", " ", "comparison", " ", "table"}], "*)"}], 
       RowBox[{"parameterNames", "=", 
        RowBox[{"Keys", "[", 
         RowBox[{
          RowBox[{"results", "[", 
           RowBox[{"First", "[", "methodNames", "]"}], "]"}], "[", 
          "\"\<BestPhases\>\"", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"parameterTable", "=", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"results", "[", "method", "]"}], "[", 
                    "\"\<BestPhases\>\"", "]"}], "[", "param", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"param", ",", "parameterNames"}], "}"}]}], "]"}], 
                ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"results", "[", "method", "]"}], "[", 
                   "\"\<LogLikelihood\>\"", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"6", ",", "4"}], "}"}]}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"method", ",", "methodNames"}], "}"}]}], "]"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{"parameterNames", ",", "\"\<LogLikelihood\>\""}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"Frame", "->", "All"}], ",", 
          RowBox[{"Background", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "LightGray", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "LightGray", ",", "None", ",", "None", ",", "None", ",", 
               "None"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Extract", " ", "best", " ", "method", " ", "based", " ", "on", " ", 
         "likelihood"}], "*)"}], 
       RowBox[{"bestMethod", "=", 
        RowBox[{"methodNames", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"finalLikelihoods", ",", 
             RowBox[{"Max", "[", "finalLikelihoods", "]"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Return", " ", "comparison", " ", "results"}], "*)"}], 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<LikelihoodComparison\>\"", "->", "barChart"}], ",", 
         RowBox[{"\"\<IterationComparison\>\"", "->", "iterationPlot"}], ",", 
         RowBox[{"\"\<ParameterComparison\>\"", "->", "parameterTable"}], ",", 
         RowBox[{"\"\<BestMethod\>\"", "->", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<Name\>\"", "->", "bestMethod"}], ",", 
            RowBox[{"\"\<LogLikelihood\>\"", "->", 
             RowBox[{"Max", "[", "finalLikelihoods", "]"}]}], ",", 
            RowBox[{"\"\<Parameters\>\"", "->", 
             RowBox[{
              RowBox[{"results", "[", "bestMethod", "]"}], "[", 
              "\"\<BestPhases\>\"", "]"}]}]}], "|>"}]}]}], "|>"}]}]}], 
     "]"}]}], ";"}]}]], "Input",
 CellLabel->"In[56]:=",ExpressionUUID->"ed1e8599-5c7f-9947-b878-356ff2c2d975"]
}, Open  ]],

Cell[CellGroupData[{

Cell["VisualizeParameterSensitivity", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
   3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
   3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545919463518*^9}, {
   3.954545955108715*^9, 3.9545459583816547`*^9}, {3.954547010156273*^9, 
   3.9545470613362484`*^9}, 3.954547108529665*^9, {3.9545471520041637`*^9, 
   3.954547178292944*^9}, 3.9545472201067657`*^9},
 FontWeight->"Plain",ExpressionUUID->"c5485c24-89d9-fd44-b1ad-d522dbc2fe28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"VisualizeParameterSensitivity", ":", 
    RowBox[{
    "Analyzes", " ", "how", " ", "sensitive", " ", "the", " ", "model", " ", 
     "is", " ", "to", " ", "changes", " ", "in", " ", "each", " ", 
     RowBox[{"parameter", ".", "Parameters"}]}], ":", 
    RowBox[{"-", 
     RowBox[{"baselineParams", ":", 
      RowBox[{
       RowBox[{"Baseline", " ", "parameter", " ", "values"}], "-", 
       "dataSet"}], ":", 
      RowBox[{
       RowBox[{"Dataset", " ", "for", " ", "evaluation"}], "-", 
       RowBox[{"lambda", ":", 
        RowBox[{
         RowBox[{"Decision", " ", "parameter"}], "-", "variationRange"}], ":", 
        RowBox[{
         RowBox[{
         "How", " ", "much", " ", "to", " ", "vary", " ", "each", " ", 
          "parameter", " ", 
          RowBox[{"(", 
           RowBox[{"+", 
            RowBox[{"/", "-"}]}], ")"}]}], "-", 
         RowBox[{"numPoints", ":", 
          RowBox[{
          "Number", " ", "of", " ", "points", " ", "to", " ", "evaluate", " ",
            "for", " ", "each", " ", "parameter"}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"VisualizeParameterSensitivity", "[", 
     RowBox[{
     "baselineParams_Association", ",", "dataSet_", ",", "lambda_", ",", 
      RowBox[{"variationRange_", ":", 
       RowBox[{"Pi", "/", "4"}]}], ",", 
      RowBox[{"numPoints_", ":", "11"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "paramNames", ",", "sensitivityData", ",", "sensitivityPlots", ",", 
        "baselineLikelihood", ",", "currentParams", ",", "results", ",", 
        "currentFit"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"Extract", " ", "parameter", " ", "names"}], "*)"}], 
      RowBox[{
       RowBox[{"paramNames", "=", 
        RowBox[{"Keys", "[", "baselineParams", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Calculate", " ", "baseline", " ", "likelihood"}], "*)"}], 
       RowBox[{"baselineResults", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"row", "=", 
              RowBox[{"dataSet", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"FindFullEquilibrium", "[", 
             RowBox[{
              RowBox[{"row", "[", "\"\<U1War\>\"", "]"}], ",", 
              RowBox[{"row", "[", "\"\<U1Cap1\>\"", "]"}], ",", 
              RowBox[{"row", "[", "\"\<U1Cap2\>\"", "]"}], ",", 
              RowBox[{"row", "[", "\"\<U1Nego\>\"", "]"}], ",", 
              RowBox[{"row", "[", "\"\<U1SQ\>\"", "]"}], ",", 
              RowBox[{"row", "[", "\"\<U1Acq1\>\"", "]"}], ",", 
              RowBox[{"row", "[", "\"\<U1Acq2\>\"", "]"}], ",", 
              RowBox[{"row", "[", "\"\<U2War\>\"", "]"}], ",", 
              RowBox[{"row", "[", "\"\<U2Cap2\>\"", "]"}], ",", 
              RowBox[{"row", "[", "\"\<U2Cap1\>\"", "]"}], ",", 
              RowBox[{"row", "[", "\"\<U2Nego\>\"", "]"}], ",", 
              RowBox[{"row", "[", "\"\<U2SQ\>\"", "]"}], ",", 
              RowBox[{"row", "[", "\"\<U2Acq1\>\"", "]"}], ",", 
              RowBox[{"row", "[", "\"\<U2Acq2\>\"", "]"}], ",", "lambda", ",", 
              RowBox[{"baselineParams", "[", "\"\<deltaTheta1\>\"", "]"}], 
              ",", 
              RowBox[{"baselineParams", "[", "\"\<deltaTheta2\>\"", "]"}], 
              ",", 
              RowBox[{"baselineParams", "[", "\"\<deltaTheta3\>\"", "]"}], 
              ",", 
              RowBox[{"baselineParams", "[", "\"\<deltaTheta4\>\"", "]"}]}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"Length", "[", "dataSet", "]"}], ",", "10"}], "]"}]}], 
           "}"}]}], "  ", 
         RowBox[{"(*", 
          RowBox[{
          "Limit", " ", "to", " ", "first", " ", "10", " ", "data", " ", 
           "points", " ", "for", " ", "efficiency"}], "*)"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"baselineLikelihood", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"row", "=", 
               RowBox[{"dataSet", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", 
              RowBox[{"result", "=", 
               RowBox[{"baselineResults", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"safeLikelihood", "=", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                 "\"\<War\>\""}], ",", 
                RowBox[{"Log", "[", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                   RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pWar\>\"", "]"}]}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                 "\"\<Cap1\>\""}], ",", 
                RowBox[{"Log", "[", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                   RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap1\>\"", "]"}]}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                 "\"\<Cap2\>\""}], ",", 
                RowBox[{"Log", "[", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                   RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap2\>\"", "]"}]}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                 "\"\<Nego\>\""}], ",", 
                RowBox[{"Log", "[", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                   RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pNego\>\"", "]"}]}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                 "\"\<SQ\>\""}], ",", 
                RowBox[{"Log", "[", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                   RowBox[{"result", "[", "\"\<pSQ\>\"", "]"}]}], "]"}], 
                 "]"}], ",", 
                RowBox[{
                 RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                 "\"\<Acq1\>\""}], ",", 
                RowBox[{"Log", "[", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                   RowBox[{"result", "[", "\"\<pAcq1\>\"", "]"}]}], "]"}], 
                 "]"}], ",", 
                RowBox[{
                 RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                 "\"\<Acq2\>\""}], ",", 
                RowBox[{"Log", "[", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                   RowBox[{"result", "[", "\"\<pAcq2\>\"", "]"}]}], "]"}], 
                 "]"}], ",", "True", ",", "0"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "safeLikelihood"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"Length", "[", "dataSet", "]"}], ",", "10"}], "]"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Baseline log-likelihood: \>\"", ",", "baselineLikelihood"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Calculate", " ", "sensitivity", " ", "for", " ", "each", " ", 
         "parameter"}], "*)"}], 
       RowBox[{"sensitivityData", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"param", "=", 
            RowBox[{"paramNames", "[", 
             RowBox[{"[", "p", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Analyzing sensitivity for parameter: \>\"", ",", "param"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Create", " ", "variation", " ", "range"}], "*)"}], 
           RowBox[{"baseValue", "=", 
            RowBox[{"baselineParams", "[", "param", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"variationPoints", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"baseValue", "+", 
               RowBox[{"variationRange", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", 
                   RowBox[{"i", "/", 
                    RowBox[{"(", 
                    RowBox[{"numPoints", "-", "1"}], ")"}]}]}], "-", "1"}], 
                 ")"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{"numPoints", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Calculate", " ", "likelihood", " ", "for", " ", "each", " ", 
             "variation"}], "*)"}], 
           RowBox[{"likelihoods", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"(*", 
              RowBox[{
              "Create", " ", "parameter", " ", "set", " ", "with", " ", 
               "current", " ", "variation"}], "*)"}], 
             RowBox[{
              RowBox[{
               RowBox[{"currentParams", "=", "baselineParams"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"currentParams", "[", "param", "]"}], "=", 
                RowBox[{"variationPoints", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Calculate", " ", "likelihood"}], "*)"}], 
               RowBox[{"results", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"row", "=", 
                    RowBox[{"dataSet", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"FindFullEquilibrium", "[", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<U1War\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Cap1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Cap2\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Nego\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1SQ\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Acq1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U1Acq2\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2War\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Cap2\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Cap1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Nego\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2SQ\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Acq1\>\"", "]"}], ",", 
                    RowBox[{"row", "[", "\"\<U2Acq2\>\"", "]"}], ",", 
                    "lambda", ",", 
                    RowBox[{
                    "currentParams", "[", "\"\<deltaTheta1\>\"", "]"}], ",", 
                    RowBox[{
                    "currentParams", "[", "\"\<deltaTheta2\>\"", "]"}], ",", 
                    RowBox[{
                    "currentParams", "[", "\"\<deltaTheta3\>\"", "]"}], ",", 
                    RowBox[{
                    "currentParams", "[", "\"\<deltaTheta4\>\"", "]"}]}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "dataSet", "]"}], ",", "10"}], 
                    "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"currentFit", "=", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"row", "=", 
                    RowBox[{"dataSet", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                    RowBox[{"result", "=", 
                    RowBox[{"results", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"safeLikelihood", "=", 
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<War\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pWar\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Cap1\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap1\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Cap2\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap2\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Nego\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pNego\>\"", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<SQ\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{"result", "[", "\"\<pSQ\>\"", "]"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Acq1\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{"result", "[", "\"\<pAcq1\>\"", "]"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}], "==", 
                    "\"\<Acq2\>\""}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "10"}]}], ",", 
                    RowBox[{"result", "[", "\"\<pAcq2\>\"", "]"}]}], "]"}], 
                    "]"}], ",", "True", ",", "0"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "safeLikelihood"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "dataSet", "]"}], ",", "10"}], 
                    "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               "currentFit"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "numPoints"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"param", ",", "variationPoints", ",", "likelihoods"}], 
            "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", 
            RowBox[{"Length", "[", "paramNames", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Create", " ", "sensitivity", " ", "plots"}], "*)"}], 
       RowBox[{"sensitivityPlots", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"paramData", "=", 
            RowBox[{"sensitivityData", "[", 
             RowBox[{"[", "p", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"param", "=", 
            RowBox[{"paramData", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"points", "=", 
            RowBox[{"paramData", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"likelihoods", "=", 
            RowBox[{"paramData", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"points", ",", "likelihoods"}], "}"}], "]"}], ",", 
             RowBox[{"PlotLabel", "->", 
              RowBox[{"\"\<Sensitivity to \>\"", "<>", "param"}]}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"param", ",", "\"\<Log-Likelihood\>\""}], "}"}]}], ",", 
             RowBox[{"GridLines", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"baselineParams", "[", "param", "]"}], "}"}], ",", 
                RowBox[{"{", "baselineLikelihood", "}"}]}], "}"}]}], ",", 
             RowBox[{"GridLinesStyle", "->", 
              RowBox[{"Directive", "[", 
               RowBox[{"Red", ",", "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "->", "All"}], ",", 
             RowBox[{"PlotMarkers", "->", "Automatic"}], ",", 
             RowBox[{"Epilog", "->", 
              RowBox[{"{", 
               RowBox[{"Text", "[", 
                RowBox[{"\"\<Baseline\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"baselineParams", "[", "param", "]"}], ",", 
                   "baselineLikelihood"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "}"}]}], 
             ",", 
             RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", 
            RowBox[{"Length", "[", "paramNames", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Rank", " ", "parameters", " ", "by", " ", "sensitivity"}], 
        "*)"}], 
       RowBox[{"sensitivities", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sensitivityData", "[", 
             RowBox[{"[", 
              RowBox[{"p", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"sensitivityData", "[", 
               RowBox[{"[", 
                RowBox[{"p", ",", "3"}], "]"}], "]"}], "]"}], "-", 
             RowBox[{"Min", "[", 
              RowBox[{"sensitivityData", "[", 
               RowBox[{"[", 
                RowBox[{"p", ",", "3"}], "]"}], "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", 
            RowBox[{"Length", "[", "paramNames", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"sortedSensitivities", "=", 
        RowBox[{"Reverse", "[", 
         RowBox[{"SortBy", "[", 
          RowBox[{"sensitivities", ",", "Last"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sensitivityRanking", "=", 
        RowBox[{"BarChart", "[", 
         RowBox[{
          RowBox[{"sortedSensitivities", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"ChartLabels", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sortedSensitivities", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "None"}], 
            "}"}]}], ",", 
          RowBox[{
          "PlotLabel", "->", "\"\<Parameter Sensitivity Ranking\>\""}], ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"None", ",", "\"\<Log-Likelihood Range\>\""}], "}"}]}], 
          ",", 
          RowBox[{"ChartStyle", "->", "\"\<Pastel\>\""}], ",", 
          RowBox[{"GridLines", "->", "Automatic"}], ",", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Return", " ", "results"}], "*)"}], 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<SensitivityPlots\>\"", "->", "sensitivityPlots"}], ",", 
         RowBox[{"\"\<SensitivityRanking\>\"", "->", "sensitivityRanking"}], 
         ",", 
         RowBox[{"\"\<BaselineLikelihood\>\"", "->", "baselineLikelihood"}], 
         ",", 
         RowBox[{"\"\<SensitivityData\>\"", "->", "sensitivityData"}], ",", 
         RowBox[{
         "\"\<RankedSensitivities\>\"", "->", "sortedSensitivities"}]}], 
        "|>"}]}]}], "]"}]}], ";"}]}]], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"0ea944cf-bd89-864d-9abc-6603b643b23d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["VisualizePhaseInteractions", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
   3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
   3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545919463518*^9}, {
   3.954545955108715*^9, 3.9545459583816547`*^9}, {3.954547010156273*^9, 
   3.9545470613362484`*^9}, 3.954547108529665*^9, {3.9545471520041637`*^9, 
   3.954547178292944*^9}},
 FontWeight->"Plain",ExpressionUUID->"58b2b4ff-39a7-4942-b2ee-8c453f95d376"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"VisualizePhaseInteractions", ":", 
    RowBox[{
    "Shows", " ", "how", " ", "pairs", " ", "of", " ", "phase", " ", 
     "parameters", " ", "interact", " ", "with", " ", "each", " ", 
     RowBox[{"other", ".", "Parameters"}]}], ":", 
    RowBox[{"-", 
     RowBox[{"dataSet", ":", 
      RowBox[{
       RowBox[{"Dataset", " ", "for", " ", "evaluation"}], "-", 
       "baseParams"}], ":", 
      RowBox[{
       RowBox[{"Base", " ", "parameter", " ", "values"}], "-", 
       RowBox[{"lambda", ":", 
        RowBox[{
         RowBox[{"Decision", " ", "parameter"}], "-", "phaseGridSize"}], ":", 
        RowBox[{
        "Number", " ", "of", " ", "grid", " ", "points", " ", "per", " ", 
         "dimension"}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"VisualizePhaseInteractions", "[", 
      RowBox[{"dataSet_", ",", "baseParams_Association", ",", "lambda_", ",", 
       RowBox[{"phaseGridSize_", ":", "5"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "paramNames", ",", "interactionPlots", ",", "paramPairs", ",", 
         "fixedParams", ",", "currentInteractionPlot"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "phase", " ", "parameter", " ", "names"}], 
        "*)"}], 
       RowBox[{
        RowBox[{"paramNames", "=", 
         RowBox[{"{", 
          RowBox[{
          "\"\<deltaTheta1\>\"", ",", "\"\<deltaTheta2\>\"", ",", 
           "\"\<deltaTheta3\>\"", ",", "\"\<deltaTheta4\>\""}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "all", " ", "parameter", " ", "pairs"}], 
         "*)"}], 
        RowBox[{"paramPairs", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"paramNames", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"paramNames", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"Length", "[", "paramNames", "]"}], "-", "1"}]}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"i", "+", "1"}], ",", 
             RowBox[{"Length", "[", "paramNames", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"paramPairs", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"paramPairs", ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Generate", " ", "interaction", " ", "plots", " ", "for", " ", 
          "each", " ", "parameter", " ", "pair"}], "*)"}], 
        RowBox[{"interactionPlots", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Analyzing interaction between \>\"", ",", 
              RowBox[{"paramPair", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< and \>\"", ",", 
              RowBox[{"paramPair", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Set", " ", "fixed", " ", "parameters"}], "*)"}], 
            RowBox[{"fixedParams", "=", "baseParams"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Generate", " ", "interaction", " ", "plot"}], "*)"}], 
            RowBox[{"currentInteractionPlot", "=", 
             RowBox[{"VisualizeGridSearchHeatmap", "[", 
              RowBox[{
              "dataSet", ",", "lambda", ",", "fixedParams", ",", "paramPair", 
               ",", "phaseGridSize"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"paramPair", ",", "currentInteractionPlot"}], "}"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"paramPair", ",", "paramPairs"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Return", " ", "results"}], "*)"}], 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<InteractionPairs\>\"", "->", "paramPairs"}], ",", 
          RowBox[{"\"\<InteractionHeatmaps\>\"", "->", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"interactionPlots", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", "\"\<Heatmap\>\"",
               "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "interactionPlots", "]"}]}], "}"}]}], 
            "]"}]}], ",", 
          RowBox[{"\"\<InteractionContours\>\"", "->", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"interactionPlots", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
              "\"\<ContourPlot\>\"", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "interactionPlots", "]"}]}], "}"}]}], 
            "]"}]}], ",", 
          RowBox[{"\"\<BestParameterSets\>\"", "->", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"interactionPlots", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
              "\"\<BestParameters\>\"", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "interactionPlots", "]"}]}], "}"}]}], 
            "]"}]}]}], "|>"}]}]}], "]"}]}], ";"}], "\n"}]}]], "Input",
 CellLabel->"In[58]:=",ExpressionUUID->"e0523063-8f73-514b-acf9-7e0fc64ef83d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["VisualizeOptimalPhasesResult", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
   3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
   3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545919463518*^9}, {
   3.954545955108715*^9, 3.9545459583816547`*^9}, {3.954547010156273*^9, 
   3.9545470613362484`*^9}, 3.954547108529665*^9, 3.9545471520041637`*^9, 
   3.954549411931267*^9},
 FontWeight->"Plain",ExpressionUUID->"7f4f7e53-f6b9-b047-b1b9-8b6bd74bdf9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"VisualizeOptimalPhasesResult", ":", 
    RowBox[{
    "Creates", " ", "a", " ", "comprehensive", " ", "visualization", " ", 
     "of", " ", "the", " ", "optimal", " ", "phases", " ", "result", " ", 
     "Parameters"}], ":", 
    RowBox[{"-", 
     RowBox[{"optimalPhasesResult", ":", 
      RowBox[{
       RowBox[{"Output", " ", "from", " ", "FindOptimalPhases"}], "-", 
       "testData"}], ":", 
      RowBox[{
      "Data", " ", "used", " ", "to", " ", "validate", " ", "the", " ", 
       "resulting", " ", "phases", " ", 
       RowBox[{"(", "optional", ")"}]}]}]}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"VisualizeOptimalPhasesResult", "[", 
     RowBox[{"optimalPhasesResult_", ",", 
      RowBox[{"testData_", ":", "None"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "bestPhases", ",", "logLikelihood", ",", "lambda", ",", "method", ",", 
        RowBox[{"phaseNames", "=", 
         RowBox[{"{", 
          RowBox[{
          "\"\<deltaTheta1\>\"", ",", "\"\<deltaTheta2\>\"", ",", 
           "\"\<deltaTheta3\>\"", ",", "\"\<deltaTheta4\>\""}], "}"}]}], ",", 
        "phaseTable", ",", "methodInfo", ",", "summaryText", ",", "phasePlot",
         ",", "phaseCirclePlot", ",", "validationInfo", ",", "degrees", ",", 
        "validationResults", ",", "correctPredictions", ",", "accuracy", ",", 
        "maxProb", ",", "predictedOutcome"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"Extract", " ", "key", " ", "information"}], "*)"}], 
      RowBox[{
       RowBox[{"bestPhases", "=", 
        RowBox[{"optimalPhasesResult", "[", "\"\<BestPhases\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"logLikelihood", "=", 
        RowBox[{"optimalPhasesResult", "[", "\"\<LogLikelihood\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"lambda", "=", 
        RowBox[{"optimalPhasesResult", "[", "\"\<Lambda\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"method", "=", 
        RowBox[{"optimalPhasesResult", "[", "\"\<Method\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Create", " ", "summary", " ", "table"}], "*)"}], 
       RowBox[{"phaseTable", "=", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Phase Parameter\>\"", ",", "\"\<Value (radians)\>\"", ",", 
              "\"\<Value (degrees)\>\""}], "}"}], "}"}], "~", "Join", "~", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"phaseNames", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"bestPhases", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"bestPhases", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                    RowBox[{"180", "/", "Pi"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], "]"}], "<>", 
                "\"\<\[Degree]\>\""}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "bestPhases", "]"}]}], "}"}]}], "]"}], 
           "~", "Join", "~", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\"\<Log-Likelihood\>\"", ",", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"logLikelihood", ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", "\"\<\>\""}], 
             "}"}], "}"}]}], ",", 
          RowBox[{"Frame", "->", "All"}], ",", 
          RowBox[{"Background", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "LightGray", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "LightGray", ",", "None", ",", "None", ",", "None", ",", "None",
                ",", "LightGray"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Alignment", "->", 
           RowBox[{"{", 
            RowBox[{"Left", ",", "Center"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Create", " ", "information", " ", "about", " ", "the", " ", 
         "method"}], "*)"}], 
       RowBox[{"methodInfo", "=", 
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<Optimization Details:\>\"", ",", 
           RowBox[{"\"\<  \[Bullet] Method: \>\"", "<>", 
            RowBox[{"ToString", "[", "method", "]"}]}], ",", 
           RowBox[{"\"\<  \[Bullet] Lambda: \>\"", "<>", 
            RowBox[{"ToString", "[", "lambda", "]"}]}], ",", 
           RowBox[{"\"\<  \[Bullet] Final Log-Likelihood: \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"logLikelihood", ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "4"}], "}"}]}], "]"}], "]"}]}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Create", " ", "summary", " ", "text", " ", "explaining", " ", 
         "results"}], "*)"}], 
       RowBox[{"summaryText", "=", 
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<Optimal Phase Parameters for Quantum-Like International \
Relations Model\>\"", ",", "Bold", ",", "14"}], "]"}], ",", "\"\<\>\"", ",", 
           "\"\<The optimal phase differences represent the quantum \
interference effects in the model.\>\"", ",", 
           "\"\<These parameters capture the non-classical aspects of \
decision-making in international relations.\>\""}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Create", " ", "radar", " ", "plot", " ", "of", " ", "phases"}], 
        "*)"}], 
       RowBox[{"phasePlot", "=", 
        RowBox[{"RadarChart", "[", 
         RowBox[{
          RowBox[{"{", "bestPhases", "}"}], ",", 
          RowBox[{"ChartLabels", "->", "phaseNames"}], ",", 
          RowBox[{"PlotLabel", "->", "\"\<Optimal Phase Parameters\>\""}], 
          ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"2", " ", "Pi"}]}], "}"}]}], ",", 
          RowBox[{"ScalingFunctions", "->", "\"\<Linear\>\""}], ",", 
          RowBox[{"GridLines", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "->", 
           RowBox[{"{", 
            RowBox[{"Directive", "[", 
             RowBox[{"Thick", ",", "Blue", ",", 
              RowBox[{"Opacity", "[", "0.7", "]"}]}], "]"}], "}"}]}], ",", 
          RowBox[{"ChartBaseStyle", "->", 
           RowBox[{"EdgeForm", "[", "Gray", "]"}]}], ",", 
          RowBox[{"ImageSize", "->", "300"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Create", " ", "circle", " ", "plots", " ", "showing", " ", "phase", 
         " ", "values"}], "*)"}], 
       RowBox[{"phaseCirclePlot", "=", 
        RowBox[{"Grid", "[", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"phase", "=", 
                  RowBox[{"bestPhases", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{"phaseName", "=", 
                  RowBox[{"phaseNames", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", "phaseDegrees"}], 
                "}"}], ",", 
               RowBox[{
                RowBox[{"phaseDegrees", "=", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"phase", "*", 
                    RowBox[{"180", "/", "Pi"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Graphics", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{"Gray", ",", "0.5"}], "]"}], ",", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Darker", "[", 
                    RowBox[{"Blue", ",", "0.1"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.008", "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "phase", "]"}], ",", 
                    RowBox[{"Cos", "[", "phase", "]"}]}], "}"}]}], "}"}], 
                    "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"phaseName", ",", "Bold", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1.2"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"phase", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}], "<>", 
                    "\"\< rad\>\""}], ",", "10"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1.2"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"phaseDegrees", "<>", "\"\<\[Degree]\>\""}], ",", 
                    "10"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1.4"}]}], "}"}]}], "]"}]}], "}"}], ",", 
                  RowBox[{"PlotRange", "->", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.5"}], ",", "1.5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.5"}], ",", "1.5"}], "}"}]}], "}"}]}], ",", 
                  RowBox[{"ImageSize", "->", "150"}]}], "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "bestPhases", "]"}]}], "}"}]}], "]"}], 
           ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", " ", "test", " ", "data", " ", "is", " ", "provided"}],
          ",", 
         RowBox[{"validate", " ", "results"}]}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"testData", "=!=", "None"}], ",", 
         RowBox[{
          RowBox[{"validationResults", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"row", "=", 
                 RowBox[{"testData", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"Check", "[", 
                RowBox[{
                 RowBox[{"FindFullEquilibrium", "[", 
                  RowBox[{
                   RowBox[{"row", "[", "\"\<U1War\>\"", "]"}], ",", 
                   RowBox[{"row", "[", "\"\<U1Cap1\>\"", "]"}], ",", 
                   RowBox[{"row", "[", "\"\<U1Cap2\>\"", "]"}], ",", 
                   RowBox[{"row", "[", "\"\<U1Nego\>\"", "]"}], ",", 
                   RowBox[{"row", "[", "\"\<U1SQ\>\"", "]"}], ",", 
                   RowBox[{"row", "[", "\"\<U1Acq1\>\"", "]"}], ",", 
                   RowBox[{"row", "[", "\"\<U1Acq2\>\"", "]"}], ",", 
                   RowBox[{"row", "[", "\"\<U2War\>\"", "]"}], ",", 
                   RowBox[{"row", "[", "\"\<U2Cap2\>\"", "]"}], ",", 
                   RowBox[{"row", "[", "\"\<U2Cap1\>\"", "]"}], ",", 
                   RowBox[{"row", "[", "\"\<U2Nego\>\"", "]"}], ",", 
                   RowBox[{"row", "[", "\"\<U2SQ\>\"", "]"}], ",", 
                   RowBox[{"row", "[", "\"\<U2Acq1\>\"", "]"}], ",", 
                   RowBox[{"row", "[", "\"\<U2Acq2\>\"", "]"}], ",", "lambda",
                    ",", 
                   RowBox[{"bestPhases", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"bestPhases", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"bestPhases", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"bestPhases", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"(*", 
                  RowBox[{
                  "Return", " ", "a", " ", "default", " ", "result", " ", 
                   "if", " ", 
                   RowBox[{"there", "'"}], "s", " ", "an", " ", "error"}], 
                  "*)"}], 
                 RowBox[{"<|", 
                  RowBox[{
                   RowBox[{"\"\<CrisisEquilibrium\>\"", "->", 
                    RowBox[{"<|", 
                    RowBox[{
                    RowBox[{"\"\<pWar\>\"", "->", "0.25"}], ",", 
                    RowBox[{"\"\<pCap1\>\"", "->", "0.25"}], ",", 
                    RowBox[{"\"\<pCap2\>\"", "->", "0.25"}], ",", 
                    RowBox[{"\"\<pNego\>\"", "->", "0.25"}]}], "|>"}]}], ",", 
                   RowBox[{"\"\<pCrisis\>\"", "->", "0.25"}], ",", 
                   RowBox[{"\"\<pAcq1\>\"", "->", "0.25"}], ",", 
                   RowBox[{"\"\<pAcq2\>\"", "->", "0.25"}], ",", 
                   RowBox[{"\"\<pSQ\>\"", "->", "0.25"}]}], "|>"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Infinity", "::", "indet"}], ",", 
                   RowBox[{"Divide", "::", "infy"}]}], "}"}]}], "]"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"Length", "[", "testData", "]"}], ",", "10"}], 
                "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Calculate", " ", "accuracy", " ", "statistics"}], "*)"}], 
          RowBox[{"correctPredictions", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"row", "=", 
                  RowBox[{"testData", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{"result", "=", 
                  RowBox[{"validationResults", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{
                RowBox[{"maxProb", "=", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pWar\>\"", "]"}], ",", 
                   RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap1\>\"", "]"}], ",", 
                   RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap2\>\"", "]"}], ",", 
                   RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pNego\>\"", "]"}], ",", 
                   RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}], ",", 
                   RowBox[{"result", "[", "\"\<pAcq1\>\"", "]"}], ",", 
                   RowBox[{"result", "[", "\"\<pAcq2\>\"", "]"}], ",", 
                   RowBox[{"result", "[", "\"\<pSQ\>\"", "]"}]}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"predictedOutcome", "=", 
                 RowBox[{"Which", "[", 
                  RowBox[{
                   RowBox[{"maxProb", "==", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pWar\>\"", "]"}]}], ",", "\"\<War\>\"", ",", 
                   RowBox[{"maxProb", "==", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap1\>\"", "]"}]}], ",", "\"\<Cap1\>\"", ",", 
                   RowBox[{"maxProb", "==", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap2\>\"", "]"}]}], ",", "\"\<Cap2\>\"", ",", 
                   RowBox[{"maxProb", "==", 
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pNego\>\"", "]"}]}], ",", "\"\<Nego\>\"", ",", 
                   RowBox[{"maxProb", "==", 
                    RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}]}], ",", 
                   "\"\<Crisis\>\"", ",", 
                   RowBox[{"maxProb", "==", 
                    RowBox[{"result", "[", "\"\<pAcq1\>\"", "]"}]}], ",", 
                   "\"\<Acq1\>\"", ",", 
                   RowBox[{"maxProb", "==", 
                    RowBox[{"result", "[", "\"\<pAcq2\>\"", "]"}]}], ",", 
                   "\"\<Acq2\>\"", ",", 
                   RowBox[{"maxProb", "==", 
                    RowBox[{"result", "[", "\"\<pSQ\>\"", "]"}]}], ",", 
                   "\"\<SQ\>\"", ",", "True", ",", "\"\<Unknown\>\""}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"predictedOutcome", "==", 
                   RowBox[{"row", "[", "\"\<groundtruth\>\"", "]"}]}], ",", 
                  "1", ",", "0"}], "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"Length", "[", "testData", "]"}], ",", "10"}], 
                "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"accuracy", "=", 
           RowBox[{"N", "[", 
            RowBox[{"correctPredictions", "/", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Length", "[", "testData", "]"}], ",", "10"}], "]"}]}],
             "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"validationInfo", "=", 
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Validation Results\>\"", ",", "Bold"}], "]"}], 
              ",", 
              RowBox[{"\"\<Validation sample size: \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"Length", "[", "testData", "]"}], ",", "10"}], 
                 "]"}], "]"}]}], ",", 
              RowBox[{"\"\<Prediction accuracy: \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{"accuracy", "*", "100"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "1"}], "}"}]}], "]"}], "]"}], "<>", 
               "\"\<%\>\""}], ",", 
              RowBox[{"\"\<Average log-likelihood: \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{"logLikelihood", "/", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "testData", "]"}], ",", "10"}], 
                    "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "2"}], "}"}]}], "]"}], "]"}]}]}], "}"}], 
            "]"}]}]}], ",", 
         RowBox[{
         "validationInfo", "=", "\"\<No validation data provided\>\""}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Combine", " ", "all", " ", "visualizations"}], "*)"}], 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{"summaryText", ",", 
          RowBox[{"Spacer", "[", "10", "]"}], ",", "phaseTable", ",", 
          RowBox[{"Spacer", "[", "10", "]"}], ",", 
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"phasePlot", ",", "phaseCirclePlot"}], "}"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Spacer", "[", "10", "]"}], ",", "methodInfo", ",", 
          RowBox[{"Spacer", "[", "10", "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"testData", "=!=", "None"}], ",", "validationInfo", ",", 
            "\"\<\>\""}], "]"}]}], "}"}], "]"}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{3.954550235911129*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"1004aa06-1309-4f42-b6ef-b52c603e8b0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["VisualizePhaseDistribution", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
   3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
   3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545919463518*^9}, {
   3.954545955108715*^9, 3.9545459583816547`*^9}, {3.954547010156273*^9, 
   3.9545470613362484`*^9}, 3.954547108529665*^9, 3.9545471520041637`*^9, 
   3.954549411931267*^9, 3.9545502607802505`*^9},
 FontWeight->"Plain",ExpressionUUID->"eb572ea0-b4ec-a341-9597-6c39b015b763"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"VisualizePhaseDistribution", ":", 
     RowBox[{"For", " ", "random", " ", "sampling", " ", "results"}]}], ",", 
    RowBox[{
     RowBox[{
     "visualizes", " ", "the", " ", "distribution", " ", "of", " ", "sampled",
       " ", "phases", " ", "and", " ", "their", " ", "relationship", " ", 
      "to", " ", "log"}], "-", 
     RowBox[{"likelihood", " ", 
      RowBox[{"Parameters", ":", 
       RowBox[{"-", "optimalPhasesResult"}], ":", 
       RowBox[{
        RowBox[{"Output", " ", "from", " ", "FindOptimalPhases"}], "-", 
        RowBox[{"sampledPoints", ":", 
         RowBox[{
         "All", " ", "points", " ", "sampled", " ", "during", " ", 
          "optimization", " ", 
          RowBox[{"(", 
           RowBox[{"if", " ", "available"}], ")"}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"VisualizePhaseDistribution", "[", 
      RowBox[{"optimalPhasesResult_", ",", 
       RowBox[{"sampledPoints_", ":", "None"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "bestPhases", ",", "logLikelihood", ",", "lambda", ",", "method", ",", 
         RowBox[{"phaseNames", "=", 
          RowBox[{"{", 
           RowBox[{
           "\"\<deltaTheta1\>\"", ",", "\"\<deltaTheta2\>\"", ",", 
            "\"\<deltaTheta3\>\"", ",", "\"\<deltaTheta4\>\""}], "}"}]}], ",",
          "distributionPlots", ",", "heatmapGrid", ",", "scatterMatrix"}], 
        "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "key", " ", "information"}], "*)"}], 
       RowBox[{
        RowBox[{"bestPhases", "=", 
         RowBox[{"optimalPhasesResult", "[", "\"\<BestPhases\>\"", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"logLikelihood", "=", 
         RowBox[{"optimalPhasesResult", "[", "\"\<LogLikelihood\>\"", "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"lambda", "=", 
         RowBox[{"optimalPhasesResult", "[", "\"\<Lambda\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"method", "=", 
         RowBox[{"optimalPhasesResult", "[", "\"\<Method\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "If", " ", "no", " ", "sampled", " ", "points", " ", "are", " ", 
          "provided"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sampledPoints", "===", "None"}], ",", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<This visualization requires sampled points data which is \
not available.\>\"", ",", "Bold", ",", "Red"}], "]"}], "]"}], ";"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Create", " ", "distribution", " ", "plots", " ", "for", " ", "each",
           " ", "phase", " ", "parameter"}], "*)"}], 
        RowBox[{"distributionPlots", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"phaseSamples", "=", 
                RowBox[{"sampledPoints", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
               RowBox[{"llSamples", "=", 
                RowBox[{"sampledPoints", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "5"}], "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Histogram", "[", 
                 RowBox[{"phaseSamples", ",", 
                  RowBox[{"{", 
                   RowBox[{"Pi", "/", "8"}], "}"}], ",", 
                  "\"\<Probability\>\"", ",", 
                  RowBox[{"PlotLabel", "->", 
                   RowBox[{
                    RowBox[{"phaseNames", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", 
                    "\"\< Distribution\>\""}]}], ",", 
                  RowBox[{"AxesLabel", "->", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"phaseNames", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", 
                    "\"\< (radians)\>\""}], ",", "\"\<Frequency\>\""}], 
                    "}"}]}], ",", 
                  RowBox[{"GridLines", "->", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"bestPhases", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", "None"}], 
                    "}"}]}], ",", 
                  RowBox[{"GridLinesStyle", "->", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Red", ",", "Dashed"}], "]"}]}], ",", 
                  RowBox[{"PlotRange", "->", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi"}]}], "}"}], ",", "All"}], "}"}]}], ",", 
                  RowBox[{"ImageSize", "->", "250"}]}], "]"}], ",", 
                RowBox[{"ListPlot", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"phaseSamples", ",", "llSamples"}], "}"}], "]"}], 
                  ",", 
                  RowBox[{"PlotLabel", "->", 
                   RowBox[{
                    RowBox[{"phaseNames", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", 
                    "\"\< vs Log-Likelihood\>\""}]}], ",", 
                  RowBox[{"AxesLabel", "->", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"phaseNames", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    "\"\<Log-Likelihood\>\""}], "}"}]}], ",", 
                  RowBox[{"PlotStyle", "->", 
                   RowBox[{"PointSize", "[", "0.01", "]"}]}], ",", 
                  RowBox[{"GridLines", "->", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"bestPhases", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
                    RowBox[{"{", "logLikelihood", "}"}]}], "}"}]}], ",", 
                  RowBox[{"GridLinesStyle", "->", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Red", ",", "Dashed"}], "]"}]}], ",", 
                  RowBox[{"PlotRange", "->", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi"}]}], "}"}], ",", "All"}], "}"}]}], ",", 
                  RowBox[{"ImageSize", "->", "250"}]}], "]"}]}], "}"}], 
              "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "phaseNames", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Create", " ", "heatmaps", " ", "for", " ", "pairs", " ", "of", " ", 
          "parameters"}], "*)"}], 
        RowBox[{"heatmapGrid", "=", 
         RowBox[{"Grid", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "!=", "j"}], ",", 
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xSamples", "=", 
                   RowBox[{"sampledPoints", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
                  RowBox[{"ySamples", "=", 
                   RowBox[{"sampledPoints", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "j"}], "]"}], "]"}]}], ",", 
                  RowBox[{"llSamples", "=", 
                   RowBox[{"sampledPoints", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "5"}], "]"}], "]"}]}]}], "}"}], ",", 
                RowBox[{"ListDensityPlot", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"xSamples", ",", "ySamples", ",", "llSamples"}], 
                    "}"}], "]"}], ",", 
                  RowBox[{"PlotLabel", "->", 
                   RowBox[{
                    RowBox[{"phaseNames", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\< vs \>\"", "<>", 
                    RowBox[{"phaseNames", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ",", 
                  RowBox[{"AxesLabel", "->", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"phaseNames", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"phaseNames", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], ",", 
                  RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
                  RowBox[{"ColorFunction", "->", "\"\<TemperatureMap\>\""}], 
                  ",", 
                  RowBox[{"PlotRange", "->", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi"}]}], "}"}]}], "}"}]}], ",", 
                  RowBox[{"ImageSize", "->", "200"}], ",", 
                  RowBox[{"Epilog", "->", 
                   RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"bestPhases", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"bestPhases", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}], 
                    "}"}]}]}], "]"}]}], "]"}], ",", 
              RowBox[{"(*", 
               RowBox[{"Diagonal", " ", "elements"}], "*)"}], 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"phaseNames", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "Bold", ",", "14"}], 
                "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "phaseNames", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "phaseNames", "]"}]}], "}"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Create", " ", "scatter", " ", "matrix", " ", "for", " ", "all", " ",
           "parameters"}], "*)"}], 
        RowBox[{"scatterMatrix", "=", 
         RowBox[{"ScatterPlotMatrix", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"sampledPoints", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"sampledPoints", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "5"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"ChartLabels", "->", 
            RowBox[{"{", 
             RowBox[{"phaseNames", ",", "phaseNames"}], "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "->", 
            "\"\<Relationships Between Phase Parameters and \
Log-Likelihood\>\""}], ",", 
           RowBox[{"ImageSize", "->", "600"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Combine", " ", "all", " ", "visualizations"}], "*)"}], 
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<Phase Parameter Distribution Analysis\>\"", ",", "Bold", ",",
              "16"}], "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{
             "\"\<Method: \>\"", "<>", "method", "<>", "\"\<, Lambda: \>\"", "<>", 
              RowBox[{"ToString", "[", "lambda", "]"}]}], ",", "Italic"}], 
            "]"}], ",", 
           RowBox[{"Spacer", "[", "10", "]"}], ",", 
           "\"\<The following visualizations show the distribution of sampled \
phase parameters and their relationship to model fit:\>\"", ",", 
           RowBox[{"Spacer", "[", "10", "]"}], ",", 
           RowBox[{"Grid", "[", 
            RowBox[{"Partition", "[", 
             RowBox[{"distributionPlots", ",", "2", ",", "2", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", "\"\<\>\""}], "]"}], 
            "]"}], ",", 
           RowBox[{"Spacer", "[", "20", "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<Phase Parameter Interactions\>\"", ",", "Bold", ",", "14"}], 
            "]"}], ",", 
           RowBox[{"Spacer", "[", "5", "]"}], ",", "heatmapGrid", ",", 
           RowBox[{"Spacer", "[", "20", "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<Parameter Correlation Matrix\>\"", ",", "Bold", ",", "14"}], 
            "]"}], ",", 
           RowBox[{"Spacer", "[", "5", "]"}], ",", "scatterMatrix"}], "}"}], 
         "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.954548937386482*^9, 3.95454893738748*^9}, 
   3.954549057429337*^9, {3.95454943256961*^9, 3.9545494342744875`*^9}, 
   3.95454980380726*^9, {3.954549885750101*^9, 3.9545499019072037`*^9}, {
   3.954550000381836*^9, 3.954550150124744*^9}, {3.9545501834783683`*^9, 
   3.954550254846384*^9}, {3.9545502898215294`*^9, 3.9545503280828266`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"2afefde3-d58f-6e43-9582-e9b28fa59641"]
}, Open  ]],

Cell[CellGroupData[{

Cell["confusionPlot", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
   3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
   3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545919463518*^9}, {
   3.954545955108715*^9, 3.9545459583816547`*^9}, {3.954547010156273*^9, 
   3.9545470613362484`*^9}, 3.954547108529665*^9, 3.9545471520041637`*^9, 
   3.954549411931267*^9, 3.9545502607802505`*^9, {3.95455037827005*^9, 
   3.954550382321068*^9}},
 FontWeight->"Plain",ExpressionUUID->"5c483d72-9f6e-3747-844a-12c3cac9ad9c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Fixed", " ", "ArrayPlot", " ", "in", " ", "VisualizePredictionAccuracy"}],
    "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "Create", " ", "confusion", " ", "matrix", " ", "heatmap", " ", "using", 
    " ", "ArrayPlot", " ", "instead", " ", "of", " ", "GridGraph"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"confusionPlot", "=", 
    RowBox[{"ArrayPlot", "[", 
     RowBox[{"confusionMatrix", ",", "\[IndentingNewLine]", "\t\t\t\t\t   ", 
      RowBox[{"PlotLabel", "->", "\"\<Confusion Matrix\>\""}], ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t   ", 
      RowBox[{"FrameTicks", "->", 
       RowBox[{"{", "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"outcomes", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"outcomes", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}]}], "]"}]}], 
        "}"}]}], ",", "\[IndentingNewLine]", "\t\t\t\t\t   ", 
      RowBox[{"ColorFunction", "->", "\"\<TemperatureMap\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Epilog", "->", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Text", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"confusionMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"confusionMatrix", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", "Bold", 
               ",", "Black"}], "]"}], ",", "\[IndentingNewLine]", 
             "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"j", "-", "0.5"}], ",", 
             RowBox[{"i", "-", "0.5"}]}], "}"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "->", "400"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"eac28e56-2988-fc44-8e89-3586d88c0cca"],

Cell[BoxData[
 TemplateBox[{
  "ArrayPlot", "mat", 
   "\"Argument \\!\\(\\*RowBox[{\\\"confusionMatrix\\\"}]\\) at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a list of lists.\"", 2, 62, 2, 
   34314582772473427201, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.9545563209391727`*^9, 3.9545563405961933`*^9}},
 CellLabel->
  "During evaluation of \
In[62]:=",ExpressionUUID->"cdcc1d1e-5dbe-1747-b84a-e69a10bf3260"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["VisualizePredictionAccuracy", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
   3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
   3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545919463518*^9}, {
   3.954545955108715*^9, 3.9545459583816547`*^9}, {3.954547010156273*^9, 
   3.9545470613362484`*^9}, 3.954547108529665*^9, 3.9545471520041637`*^9, 
   3.954549411931267*^9, 3.9545502607802505`*^9, 3.9545503869763737`*^9},
 FontWeight->"Plain",ExpressionUUID->"4ef1e3ef-cc74-1c43-9206-d62835e18b8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VisualizePredictionAccuracy", "[", 
    RowBox[{"optimalPhasesResult_", ",", "testData_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "bestPhases", ",", "lambda", ",", "testResults", ",", "groundTruths", 
       ",", "predictions", ",", "\[IndentingNewLine]", "confusionMatrix", ",",
        "outcomes", ",", "outcomeProbs", ",", "correctCount", ",", "accuracy",
        ",", "\[IndentingNewLine]", "confusionPlot", ",", "accuracyBar", ",", 
       "outcomeDist", ",", "predictionExamples", ",", "accuracyStats"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Extract", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bestPhases", "=", 
       RowBox[{"optimalPhasesResult", "[", "\"\<BestPhases\>\"", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"lambda", "=", 
       RowBox[{"optimalPhasesResult", "[", "\"\<Lambda\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Define", " ", "possible", " ", "outcomes"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"outcomes", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<War\>\"", ",", "\"\<Cap1\>\"", ",", "\"\<Cap2\>\"", ",", 
         "\"\<Nego\>\"", ",", "\"\<Acq1\>\"", ",", "\"\<Acq2\>\"", ",", 
         "\"\<SQ\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Run", " ", "model", " ", "on", " ", "test", " ", "data"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"testResults", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"row", "=", 
             RowBox[{"testData", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Check", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FindFullEquilibrium", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"row", "[", "\"\<U1War\>\"", "]"}], ",", 
               RowBox[{"row", "[", "\"\<U1Cap1\>\"", "]"}], ",", 
               RowBox[{"row", "[", "\"\<U1Cap2\>\"", "]"}], ",", 
               RowBox[{"row", "[", "\"\<U1Nego\>\"", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"row", "[", "\"\<U1SQ\>\"", "]"}], ",", 
               RowBox[{"row", "[", "\"\<U1Acq1\>\"", "]"}], ",", 
               RowBox[{"row", "[", "\"\<U1Acq2\>\"", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"row", "[", "\"\<U2War\>\"", "]"}], ",", 
               RowBox[{"row", "[", "\"\<U2Cap2\>\"", "]"}], ",", 
               RowBox[{"row", "[", "\"\<U2Cap1\>\"", "]"}], ",", 
               RowBox[{"row", "[", "\"\<U2Nego\>\"", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"row", "[", "\"\<U2SQ\>\"", "]"}], ",", 
               RowBox[{"row", "[", "\"\<U2Acq1\>\"", "]"}], ",", 
               RowBox[{"row", "[", "\"\<U2Acq2\>\"", "]"}], ",", 
               "\[IndentingNewLine]", "lambda", ",", "\[IndentingNewLine]", 
               RowBox[{"bestPhases", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"bestPhases", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"bestPhases", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"bestPhases", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Return", " ", "a", " ", "default", " ", "result", " ", "if", 
               " ", 
               RowBox[{"there", "'"}], "s", " ", "an", " ", "error"}], "*)"}],
              "\[IndentingNewLine]", 
             RowBox[{"<|", "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{
               "\"\<CrisisEquilibrium\>\"", "->", "\[IndentingNewLine]", 
                "\t\t\t\t\t", 
                RowBox[{"<|", "\[IndentingNewLine]", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"\"\<pWar\>\"", "->", "\"\<ERROR\>\""}], ",", 
                  "\[IndentingNewLine]", "\t\t\t\t\t", 
                  RowBox[{"\"\<pCap1\>\"", "->", "\"\<ERROR\>\""}], ",", 
                  "\[IndentingNewLine]", "\t\t\t\t\t", 
                  RowBox[{"\"\<pCap2\>\"", "->", "\"\<ERROR\>\""}], ",", 
                  "\[IndentingNewLine]", "\t\t\t\t\t", 
                  RowBox[{"\"\<pNego\>\"", "->", "\"\<ERROR\>\""}]}], 
                 "\[IndentingNewLine]", "\t\t\t\t\t", "|>"}]}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<pCrisis\>\"", "->", "\"\<ERROR\>\""}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<pAcq1\>\"", "->", "\"\<ERROR\>\""}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<pAcq2\>\"", "->", "\"\<ERROR\>\""}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<pSQ\>\"", "->", "\"\<ERROR\>\""}]}], 
              "\[IndentingNewLine]", "|>"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Infinity", "::", "indet"}], ",", 
               RowBox[{"Divide", "::", "infy"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"Length", "[", "testData", "]"}], ",", "50"}], "]"}]}], 
          "}"}]}], "  ", 
        RowBox[{"(*", 
         RowBox[{
         "Limit", " ", "to", " ", "50", " ", "test", " ", "cases", " ", "for",
           " ", "efficiency"}], "*)"}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Extract", " ", "ground", " ", "truths"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"groundTruths", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"testData", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "\"\<groundtruth\>\""}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"Length", "[", "testData", "]"}], ",", "50"}], "]"}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Determine", " ", "predicted", " ", "outcomes"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"predictions", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"result", "=", 
             RowBox[{"testResults", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"outcomeProbs", "=", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}], 
                 "[", "\"\<pWar\>\"", "]"}], "*", 
                RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{"Total", " ", "War", " ", "probability"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}], 
                 "[", "\"\<pCap1\>\"", "]"}], "*", 
                RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{"Total", " ", "Cap1", " ", "probability"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}], 
                 "[", "\"\<pCap2\>\"", "]"}], "*", 
                RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{"Total", " ", "Cap2", " ", "probability"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}], 
                 "[", "\"\<pNego\>\"", "]"}], "*", 
                RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{"Total", " ", "Nego", " ", "probability"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"result", "[", "\"\<pAcq1\>\"", "]"}], ",", 
               RowBox[{"result", "[", "\"\<pAcq2\>\"", "]"}], ",", 
               RowBox[{"result", "[", "\"\<pSQ\>\"", "]"}]}], 
              "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Find", " ", "index", " ", "of", " ", "maximum", " ", 
              "probability"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"maxIndex", "=", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"outcomeProbs", ",", 
                RowBox[{"Max", "[", "outcomeProbs", "]"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Return", " ", "the", " ", "corresponding", " ", "outcome"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"outcomes", "[", 
             RowBox[{"[", "maxIndex", "]"}], "]"}]}]}], "\[IndentingNewLine]",
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "\[IndentingNewLine]", 
           RowBox[{"Length", "[", "testResults", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Calculate", " ", "confusion", " ", "matrix"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"confusionMatrix", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"groundTruths", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "==", 
                 RowBox[{"outcomes", "[", 
                  RowBox[{"[", "row", "]"}], "]"}]}], "&&", 
                RowBox[{
                 RowBox[{"predictions", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "==", 
                 RowBox[{"outcomes", "[", 
                  RowBox[{"[", "col", "]"}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", "0"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "groundTruths", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"row", ",", 
           RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"col", ",", 
           RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Calculate", " ", "accuracy"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"correctCount", "=", 
       RowBox[{"Sum", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"groundTruths", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "==", 
            RowBox[{"predictions", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", "1", ",", "0"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "groundTruths", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"accuracy", "=", 
       RowBox[{"N", "[", 
        RowBox[{"correctCount", "/", 
         RowBox[{"Length", "[", "groundTruths", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Create", " ", "confusion", " ", "matrix", " ", "heatmap", " ", 
        "using", " ", "ArrayPlot", " ", "instead", " ", "of", " ", 
        "GridGraph"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"confusionPlot", "=", 
       RowBox[{"ArrayPlot", "[", 
        RowBox[{"confusionMatrix", ",", "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "->", "\"\<Confusion Matrix\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "->", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "-", "0.5"}], ",", 
                RowBox[{"outcomes", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "-", "0.5"}], ",", 
                RowBox[{"outcomes", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "->", "\"\<TemperatureMap\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Epilog", "->", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Text", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"confusionMatrix", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], ">", "0"}], ",", 
                "\[IndentingNewLine]", "    ", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", 
                   RowBox[{"confusionMatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", "Bold",
                   ",", "Black"}], "]"}], ",", "\[IndentingNewLine]", 
                "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"j", "-", "0.5"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", "outcomes", "]"}], "-", "i", "+", 
                 "0.5"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "->", "400"}]}], "\[IndentingNewLine]", "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Create", " ", "accuracy", " ", "bar", " ", "chart"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"accuracyBar", "=", 
       RowBox[{"BarChart", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"count", "=", 
               RowBox[{"Count", "[", 
                RowBox[{"groundTruths", ",", 
                 RowBox[{"outcomes", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"count", ">", "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"groundTruths", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "==", 
                    RowBox[{"outcomes", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"predictions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "==", 
                    RowBox[{"outcomes", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ",", "1", ",", "0"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "groundTruths", "]"}]}], "}"}]}], 
                   "\[IndentingNewLine]", "]"}], ",", "1"}], "]"}], "/", 
                "count"}], ",", "\[IndentingNewLine]", "0"}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ChartLabels", "->", "outcomes"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "PlotLabel", "->", "\"\<Prediction Accuracy by Outcome\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "->", 
          RowBox[{"{", 
           RowBox[{"None", ",", "\"\<Accuracy\>\""}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ChartStyle", "->", "\"\<Pastel\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "->", 
          RowBox[{"{", 
           RowBox[{"None", ",", "Automatic"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "->", "400"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Create", " ", "outcome", " ", "distribution", " ", "plot"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"outcomeDist", "=", 
       RowBox[{"BarChart", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{"groundTruths", ",", 
               RowBox[{"outcomes", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{"predictions", ",", 
               RowBox[{"outcomes", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ChartLabels", "->", 
          RowBox[{"{", 
           RowBox[{"outcomes", ",", "None"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "PlotLabel", "->", 
          "\"\<Outcome Distribution: Ground Truth vs Prediction\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ChartLegends", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<Ground Truth\>\"", ",", "\"\<Predicted\>\""}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ChartStyle", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<Pastel\>\"", ",", "\"\<Rainbow\>\""}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "->", 
          RowBox[{"{", 
           RowBox[{"None", ",", "Automatic"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "->", "400"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Create", " ", "examples", " ", "table", " ", "for", " ", "sample", 
        " ", "predictions"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"sampleSize", "=", 
       RowBox[{"Length", "[", "groundTruths", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"predictionExamples", "=", 
       RowBox[{"Grid", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Case\>\"", ",", "\"\<Ground Truth\>\"", ",", 
             "\"\<Prediction\>\"", ",", "\"\<Match?\>\"", ",", 
             "\"\<Top Probabilities\>\""}], "}"}], "}"}], "~", "Join", "~", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"result", "=", 
                 RowBox[{"testResults", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ",", "probs"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"probs", "=", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<War\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pWar\>\"", "]"}], "*", 
                    RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}]}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Cap1\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap1\>\"", "]"}], "*", 
                    RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}]}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Cap2\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pCap2\>\"", "]"}], "*", 
                    RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}]}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Nego\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}],
                     "[", "\"\<pNego\>\"", "]"}], "*", 
                    RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}]}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Acq1\>\"", ",", 
                    RowBox[{"result", "[", "\"\<pAcq1\>\"", "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Acq2\>\"", ",", 
                    RowBox[{"result", "[", "\"\<pAcq2\>\"", "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<SQ\>\"", ",", 
                    RowBox[{"result", "[", "\"\<pSQ\>\"", "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"sortedProbs", "=", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"SortBy", "[", 
                  RowBox[{"probs", ",", "Last"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"i", ",", "\[IndentingNewLine]", 
                 RowBox[{"groundTruths", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"predictions", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"groundTruths", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "==", 
                    RowBox[{"predictions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                   "\"\<\[Checkmark]\>\"", ",", "\"\<\:2717\>\""}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Column", "[", "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"sortedProbs", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "<>", "\"\<: \>\"",
                     "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"sortedProbs", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{"3", ",", 
                    RowBox[{"Length", "[", "sortedProbs", "]"}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "]"}], 
                  "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "sampleSize"}], "}"}]}], "\[IndentingNewLine]",
            "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Frame", "->", "All"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Background", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "LightGray", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "LightGray", ",", "None", ",", "None", ",", "None", ",", "None", 
              ",", "None", ",", "None", ",", "None", ",", "None", ",", "None",
               ",", "None"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Alignment", "->", 
          RowBox[{"{", 
           RowBox[{"Left", ",", "Center"}], "}"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Calculate", " ", "accuracy", " ", "statistics", " ", "by", " ", 
        "category"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"accuracyStats", "=", 
       RowBox[{"Grid", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Outcome\>\"", ",", "\"\<Count\>\"", ",", "\"\<Correct\>\"", 
             ",", "\"\<Accuracy\>\""}], "}"}], "}"}], "~", "Join", "~", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"count", "=", 
                 RowBox[{"Count", "[", 
                  RowBox[{"groundTruths", ",", 
                   RowBox[{"outcomes", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"correct", "=", 
                 RowBox[{"Count", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"groundTruths", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "==", 
                    RowBox[{"outcomes", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"predictions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "==", 
                    RowBox[{"outcomes", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ",", "1", ",", "0"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "groundTruths", "]"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "]"}], ",", "1"}], "]"}]}]}], 
               "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"outcomes", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "\[IndentingNewLine]", 
                "count", ",", "\[IndentingNewLine]", "correct", ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"count", ">", "0"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"100.0", "*", 
                    RowBox[{"correct", "/", "count"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], "]"}], "<>", 
                   "\"\<%\>\""}], ",", "\[IndentingNewLine]", "\"\<N/A\>\""}],
                  "]"}]}], "\[IndentingNewLine]", "}"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], "~", "Join", "~", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"\"\<Overall\>\"", ",", 
             RowBox[{"Length", "[", "groundTruths", "]"}], ",", 
             "correctCount", ",", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"100.0", "*", "accuracy"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "1"}], "}"}]}], "]"}], "]"}], "<>", 
              "\"\<%\>\""}]}], "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Frame", "->", "All"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Background", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "LightGray", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "LightGray", ",", "None", ",", "None", ",", "None", ",", "None", 
              ",", "None", ",", "None", ",", "None", ",", "LightGray"}], 
             "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Alignment", "->", 
          RowBox[{"{", 
           RowBox[{"Left", ",", "Right", ",", "Right", ",", "Right"}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Combine", " ", "all", " ", "visualizations"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<Model Prediction Accuracy Analysis\>\"", ",", "Bold", ",", 
           "16"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"\"\<Test set size: \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Length", "[", "groundTruths", "]"}], "]"}], "<>", 
            "\"\<, Overall accuracy: \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"accuracy", "*", "100"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "1"}], "}"}]}], "]"}], "]"}], "<>", 
            "\"\<%\>\""}], ",", "Bold"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"confusionPlot", ",", 
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{"accuracyBar", ",", 
                RowBox[{"Spacer", "[", "10", "]"}], ",", "outcomeDist"}], 
               "}"}], "]"}]}], "}"}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<Accuracy Statistics by Outcome\>\"", ",", "Bold", ",", "14"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
         "accuracyStats", ",", "\[IndentingNewLine]", 
         RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Sample Predictions\>\"", ",", "Bold", ",", "14"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
         "predictionExamples"}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.954550399620868*^9, 3.954550638827658*^9}, {
  3.9545506785415998`*^9, 3.954550941665373*^9}, {3.954550975594019*^9, 
  3.9545513671506786`*^9}, {3.954551397864331*^9, 3.954551572359604*^9}, {
  3.954551660942894*^9, 3.954551916822685*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"5906e349-1b1c-c942-b237-d5d2d8dc0453"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CompareOptimalPhaseResults", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}, {
   3.954545764862734*^9, 3.954545772351383*^9}, {3.9545458165513744`*^9, 
   3.954545817149481*^9}, {3.9545459157835426`*^9, 3.954545919463518*^9}, {
   3.954545955108715*^9, 3.9545459583816547`*^9}, {3.954547010156273*^9, 
   3.9545470613362484`*^9}, 3.954547108529665*^9, 3.9545471520041637`*^9, 
   3.954549411931267*^9, 3.9545502607802505`*^9, 3.9545503869763737`*^9, 
   3.954551621996645*^9},
 FontWeight->"Plain",ExpressionUUID->"31552222-7956-9146-a3f3-96772c233d84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"CompareOptimalPhaseResults", ":", 
    RowBox[{
    "Compares", " ", "multiple", " ", "optimal", " ", "phase", " ", "results",
      " ", "from", " ", "different", " ", "runs", " ", "Parameters"}], ":", 
    RowBox[{"-", 
     RowBox[{"resultsList", ":", 
      RowBox[{
       RowBox[{
       "List", " ", "of", " ", "results", " ", "from", " ", 
        "FindOptimalPhases", " ", "runs"}], "-", "labels"}], ":", 
      RowBox[{
      "Optional", " ", "labels", " ", "for", " ", "each", " ", 
       "result"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CompareOptimalPhaseResults", "[", 
     RowBox[{"resultsList_List", ",", 
      RowBox[{"labels_", ":", "None"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"phaseNames", "=", 
         RowBox[{"{", 
          RowBox[{
          "\"\<deltaTheta1\>\"", ",", "\"\<deltaTheta2\>\"", ",", 
           "\"\<deltaTheta3\>\"", ",", "\"\<deltaTheta4\>\""}], "}"}]}], ",", 
        "resultLabels", ",", "phasesMatrix", ",", "likelihoodList", ",", 
        "lambdaList", ",", "methodList", ",", "phaseComparisonPlot", ",", 
        "likelihoodBar", ",", "comparisonTable"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{
       "Create", " ", "labels", " ", "if", " ", "not", " ", "provided"}], 
       "*)"}], 
      RowBox[{
       RowBox[{"resultLabels", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"labels", "===", "None"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"\"\<Run \>\"", "<>", 
             RowBox[{"ToString", "[", "i", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "resultsList", "]"}]}], "}"}]}], "]"}], 
          ",", "labels"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "data", " ", "from", " ", "results"}], "*)"}], 
       RowBox[{"phasesMatrix", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"resultsList", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "\"\<BestPhases\>\""}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "resultsList", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"likelihoodList", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"resultsList", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "\"\<LogLikelihood\>\""}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "resultsList", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"lambdaList", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"resultsList", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "\"\<Lambda\>\""}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "resultsList", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"methodList", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"resultsList", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "\"\<Method\>\""}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "resultsList", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Create", " ", "phase", " ", "radar", " ", "chart", " ", 
         "comparison"}], "*)"}], 
       RowBox[{"phaseComparisonPlot", "=", 
        RowBox[{"RadarChart", "[", 
         RowBox[{"phasesMatrix", ",", 
          RowBox[{"ChartLabels", "->", "phaseNames"}], ",", 
          RowBox[{
          "PlotLabel", "->", "\"\<Optimal Phase Parameter Comparison\>\""}], 
          ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"2", " ", "Pi"}]}], "}"}]}], ",", 
          RowBox[{"ScalingFunctions", "->", "\"\<Linear\>\""}], ",", 
          RowBox[{"GridLines", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"PlotLegends", "->", "resultLabels"}], ",", 
          RowBox[{"ChartBaseStyle", "->", 
           RowBox[{"EdgeForm", "[", "Gray", "]"}]}], ",", 
          RowBox[{"ImageSize", "->", "400"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Create", " ", "log"}], "-", 
         RowBox[{"likelihood", " ", "bar", " ", "chart"}]}], "*)"}], 
       RowBox[{"likelihoodBar", "=", 
        RowBox[{"BarChart", "[", 
         RowBox[{"likelihoodList", ",", 
          RowBox[{"ChartLabels", "->", "resultLabels"}], ",", 
          RowBox[{"PlotLabel", "->", "\"\<Log-Likelihood Comparison\>\""}], 
          ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"None", ",", "\"\<Log-Likelihood\>\""}], "}"}]}], ",", 
          RowBox[{"ChartStyle", "->", "\"\<Pastel\>\""}], ",", 
          RowBox[{"GridLines", "->", 
           RowBox[{"{", 
            RowBox[{"None", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"ImageSize", "->", "400"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Create", " ", "comparison", " ", "table"}], "*)"}], 
       RowBox[{"comparisonTable", "=", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<Run\>\"", ",", "\"\<Method\>\"", ",", "\"\<Lambda\>\"", 
               ",", "\"\<Log-Likelihood\>\""}], "}"}], "~", "Join", "~", 
             "phaseNames"}], "}"}], "~", "Join", "~", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"resultLabels", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"methodList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"lambdaList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{"likelihoodList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"6", ",", "4"}], "}"}]}], "]"}]}], "}"}], "~", 
              "Join", "~", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"phasesMatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "<>", 
                 "\"\< (\>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"phasesMatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                    RowBox[{"180", "/", "Pi"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}], "<>", 
                 "\"\<\[Degree])\>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", "phaseNames", "]"}]}], "}"}]}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "resultsList", "]"}]}], "}"}]}], 
            "]"}]}], ",", 
          RowBox[{"Frame", "->", "All"}], ",", 
          RowBox[{"Background", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "LightGray", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "LightGray", ",", "None", ",", "None", ",", "None", ",", "None",
                ",", "None", ",", "None", ",", "None", ",", "None"}], "}"}]}],
             "}"}]}], ",", 
          RowBox[{"Alignment", "->", 
           RowBox[{"{", 
            RowBox[{"Left", ",", "Center"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Calculate", " ", "consistency", " ", "statistics"}], "*)"}], 
       RowBox[{"phaseStdDevs", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"StandardDeviation", "[", 
           RowBox[{"phasesMatrix", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "i"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "phaseNames", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"consistencyStats", "=", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Phase Parameter\>\"", ",", "\"\<Mean (rad)\>\"", ",", 
              "\"\<Mean (deg)\>\"", ",", "\"\<Std. Dev. (rad)\>\"", ",", 
              "\"\<Std. Dev. (deg)\>\"", ",", "\"\<Consistency\>\""}], "}"}], 
            "}"}], "~", "Join", "~", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mean", "=", 
                  RowBox[{"Mean", "[", 
                   RowBox[{"phasesMatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "i"}], "]"}], "]"}], "]"}]}], ",", 
                 RowBox[{"stdDev", "=", 
                  RowBox[{"phaseStdDevs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", "consistency"}], 
                "}"}], ",", 
               RowBox[{"(*", 
                RowBox[{"Calculate", " ", "consistency", " ", "metric", " ", 
                 RowBox[{"(", 
                  RowBox[{"0", "-", 
                   RowBox[{"100", "%"}]}], ")"}]}], "*)"}], 
               RowBox[{
                RowBox[{"consistency", "=", 
                 RowBox[{"Max", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"100", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"stdDev", "/", 
                    RowBox[{"(", 
                    RowBox[{"Pi", "/", "2"}], ")"}]}]}], ")"}]}]}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"phaseNames", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"mean", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"mean", "*", 
                    RowBox[{"180", "/", "Pi"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], "<>", 
                   "\"\<\[Degree]\>\""}], ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"stdDev", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"stdDev", "*", 
                    RowBox[{"180", "/", "Pi"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], "<>", 
                   "\"\<\[Degree]\>\""}], ",", 
                  RowBox[{"ProgressIndicator", "[", 
                   RowBox[{
                    RowBox[{"consistency", "/", "100"}], ",", 
                    RowBox[{"ImageSize", "->", "100"}]}], "]"}]}], "}"}]}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "phaseNames", "]"}]}], "}"}]}], "]"}]}],
           ",", 
          RowBox[{"Frame", "->", "All"}], ",", 
          RowBox[{"Background", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "LightGray", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "LightGray", ",", "None", ",", "None", ",", "None", ",", "None",
                ",", "None", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Alignment", "->", 
           RowBox[{"{", 
            RowBox[{"Left", ",", "Center"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Combine", " ", "all", " ", "visualizations"}], "*)"}], 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<Comparison of Multiple Optimization Results\>\"", ",", "Bold",
             ",", "16"}], "]"}], ",", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", 
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"phaseComparisonPlot", ",", "likelihoodBar"}], "}"}], 
            "}"}], "]"}], ",", 
          RowBox[{"Spacer", "[", "20", "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Detailed Comparison\>\"", ",", "Bold", ",", "14"}], 
           "]"}], ",", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", "comparisonTable", ",", 
          RowBox[{"Spacer", "[", "20", "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<Parameter Consistency Analysis\>\"", ",", "Bold", ",", "14"}],
            "]"}], ",", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", "consistencyStats", ",", 
          RowBox[{"Spacer", "[", "10", "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<Note: Higher consistency (closer to 100%) indicates the \
optimization consistently finds similar values for that parameter across \
runs.\>\"", ",", "Italic"}], "]"}]}], "}"}], "]"}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellLabel->"In[64]:=",ExpressionUUID->"7c33c1be-8e34-6445-ae47-827c821edf30"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Testing", "Section"]], "Chapter",
 CellChangeTimes->{{3.952131256973952*^9, 3.952131297933844*^9}, {
  3.9539402951916103`*^9, 3.953940307039828*^9}, {3.953940435457733*^9, 
  3.953940439675889*^9}},ExpressionUUID->"aa180197-1398-4398-88c3-\
21624f8cd6c1"],

Cell[CellGroupData[{

Cell["Load Data", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544238321707*^9}},
 FontWeight->"Plain",ExpressionUUID->"de48ae4c-8a41-684a-8fbb-495278ed9653"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"load", " ", "data"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.954544123241062*^9, 3.9545441290630445`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"0d2bd081-4735-1e46-8091-5cd086d9830e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\<C:\\\\Users\\\\cmore\\\\Documents\\\\Github\\\\quantum_international_\
interaction_game\\\\Norm_Form\\\\first_dataset_with_SQ.csv\>\"", ",", 
     "\"\<CSV\>\"", ",", 
     RowBox[{"\"\<HeaderLines\>\"", "->", "1"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dataset", "=", 
   RowBox[{"Dataset", "[", 
    RowBox[{"Association", "@@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "@@@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<Agent1\>\"", ",", "\"\<Agent2\>\"", ",", "\"\<wrTu1sq\>\"", 
              ",", "\"\<wrTu1ac1\>\"", ",", "\"\<wrTu1ac2\>\"", ",", 
              "\"\<wrTu1neg\>\"", ",", "\"\<wrTu1cp1\>\"", ",", 
              "\"\<wrTu1cp2\>\"", ",", "\"\<wrTu1wr1\>\"", ",", 
              "\"\<wrTu1wr2\>\"", ",", "\"\<wrTu2sq\>\"", ",", 
              "\"\<wrTu2ac2\>\"", ",", "\"\<wrTu2ac1\>\"", ",", 
              "\"\<wrTu2neg\>\"", ",", "\"\<wrTu2cp2\>\"", ",", 
              "\"\<wrTu2cp1\>\"", ",", "\"\<wrTu2wr2\>\"", ",", 
              "\"\<wrTu2wr1\>\"", ",", "\"\<groundtruth\>\""}], "}"}], ",", 
            "#"}], "}"}], "]"}]}], "&"}], "/@", "data"}], ")"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.954544131326784*^9, 3.9545441481492786`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"afe2af3f-41b5-4849-a486-c562e5947bfc"],

Cell[BoxData[
 RowBox[{"Length", "[", "dataset", "]"}]], "Input",
 CellChangeTimes->{{3.9545495008817787`*^9, 3.9545495045963936`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"bb0420b8-f076-7245-b7ec-97f1e3d81c2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Prepare Data", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544248015337*^9}},
 FontWeight->"Plain",ExpressionUUID->"01035a6a-4984-134c-b1ca-ce5236c0a325"],

Cell[BoxData[
 RowBox[{"   ", 
  RowBox[{
   RowBox[{"preparedData", " ", "=", " ", 
    RowBox[{"PrepareDataset", "[", "dataset", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.954544168548033*^9, 3.954544172833208*^9}, 
   3.954544301975401*^9, 3.954556359710829*^9},
 FontWeight->"Plain",
 CellLabel->"In[68]:=",ExpressionUUID->"e06242bf-406b-c448-8e47-c42c5135d91c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Params", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544285857935*^9}, {
  3.9545480675777626`*^9, 3.954548069633732*^9}, {3.9545483476522427`*^9, 
  3.954548348331415*^9}},
 FontWeight->"Plain",ExpressionUUID->"aa7f8aa8-445f-a348-87a4-59f95d81ece3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NumSamples", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lambda", " ", "=", " ", "1.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dt1", " ", "=", " ", "Pi"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dt2", " ", "=", " ", 
   RowBox[{"3", " ", 
    RowBox[{"Pi", " ", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dt3", " ", "=", " ", 
   RowBox[{"Pi", " ", "/", " ", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dt4", " ", "=", " ", 
   RowBox[{"Pi", " ", "/", " ", "6"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxIter", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"threshold", " ", "=", " ", "0.000001"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"verboseMode", " ", "=", " ", "True"}], ";"}]}], "Input",
 CellChangeTimes->{{3.954548355049757*^9, 3.954548520265899*^9}, {
   3.954549521873932*^9, 3.9545495226089783`*^9}, 3.954549580364679*^9},
 CellLabel->"In[69]:=",ExpressionUUID->"9c8d2f38-264e-e44f-acbb-dee3cfbd66ce"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.954548476470207*^9, 3.954548478253805*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"977dd470-6743-4445-813b-52f80a4fc408"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Subsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544285857935*^9}, {
  3.9545480675777626`*^9, 3.954548069633732*^9}},
 FontWeight->"Plain",ExpressionUUID->"efbf4230-3dd5-4b46-a733-d80b5ecb6de4"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"sampleCase", "=", 
    RowBox[{"preparedData", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "NumSamples"}], "]"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.954548073266069*^9, 3.954548095403473*^9}, 
   3.954548352610817*^9},
 CellLabel->"In[78]:=",ExpressionUUID->"4fc01bde-156b-b749-b614-798b7c16f752"],

Cell[CellGroupData[{

Cell["Crisis Game", "Subsubsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544285857935*^9}, {
  3.9545480675777626`*^9, 3.954548069633732*^9}, {3.9545481151436844`*^9, 
  3.9545481189212112`*^9}},
 FontWeight->"Plain",ExpressionUUID->"9129694f-f725-314f-8406-acb14b8987d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"crisisResult", "=", 
   RowBox[{"FindCrisisEquilibrium", "[", 
    RowBox[{
     RowBox[{"sampleCase", "[", "\"\<U1War\>\"", "]"}], ",", 
     RowBox[{"sampleCase", "[", "\"\<U1Cap1\>\"", "]"}], ",", 
     RowBox[{"sampleCase", "[", "\"\<U1Cap2\>\"", "]"}], ",", 
     RowBox[{"sampleCase", "[", "\"\<U1Nego\>\"", "]"}], ",", 
     RowBox[{"sampleCase", "[", "\"\<U2War\>\"", "]"}], ",", 
     RowBox[{"sampleCase", "[", "\"\<U2Cap2\>\"", "]"}], ",", 
     RowBox[{"sampleCase", "[", "\"\<U2Cap1\>\"", "]"}], ",", 
     RowBox[{"sampleCase", "[", "\"\<U2Nego\>\"", "]"}], ",", "1.0", ",", 
     "Pi", ",", 
     RowBox[{"3", 
      RowBox[{"Pi", "/", "2"}]}], ",", "100", ",", "0.000001", ",", "True"}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->"In[80]:=",ExpressionUUID->"aef73dd4-6851-0f45-ba74-704310f14698"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"crisisResult", "=", 
    RowBox[{"FindCrisisEquilibrium", "[", 
     RowBox[{
      RowBox[{"sampleCase", "[", "\"\<U1War\>\"", "]"}], ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t ", 
      RowBox[{"sampleCase", "[", "\"\<U1Cap1\>\"", "]"}], ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t ", 
      RowBox[{"sampleCase", "[", "\"\<U1Cap2\>\"", "]"}], ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t ", 
      RowBox[{"sampleCase", "[", "\"\<U1Nego\>\"", "]"}], ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t ", 
      RowBox[{"sampleCase", "[", "\"\<U2War\>\"", "]"}], ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t ", 
      RowBox[{"sampleCase", "[", "\"\<U2Cap2\>\"", "]"}], ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t          ", 
      RowBox[{"sampleCase", "[", "\"\<U2Cap1\>\"", "]"}], ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t ", 
      RowBox[{"sampleCase", "[", "\"\<U2Nego\>\"", "]"}], ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t ", "lambda", ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t ", "dt1", ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t ", "dt2", ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t ", "maxIter", ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t ", "threshold", ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t ", "verboseMode"}], "]"}]}], 
   ";"}], "\n"}]], "Input",
 CellChangeTimes->{{3.954544330515297*^9, 3.9545444279054775`*^9}, {
  3.954548457234106*^9, 3.954548471835535*^9}, {3.9545485229789944`*^9, 
  3.954548544082018*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"07a5eb30-117d-6f4a-a352-737bd6558c3e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"visualise", " ", "results"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9545444359110737`*^9, 3.954544439140724*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"66a346b6-4ae9-e24e-b988-a2509448d2cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"crisisConvergenceViz", " ", "=", " ", 
   RowBox[{"PlotCrisisConvergence", "[", 
    RowBox[{"crisisResult", "[", "\"\<IterationHistory\>\"", "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.954544463522106*^9, 3.954544463522106*^9}, {
  3.9545479372058077`*^9, 3.9545479781641483`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"70f04e63-416a-564d-9c84-76378941e1e0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"crisisConvergenceViz", "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.954547983774223*^9, 3.9545479844870834`*^9}, {
  3.9545496315896063`*^9, 3.9545496320274277`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"a5f32752-a751-c643-b585-d06a0ab15db7"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{}, 
     InterpretationBox[{
       TagBox[{{{}, {}, 
          TagBox[{
            Hue[0.67, 0.6, 0.6], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]], 
            LineBox[{{0., 0.25}, {1., 0.25}, {1., 0.25}}]}, 
           Annotation[#, "Charting`Private`Tag#1"]& ], 
          TagBox[{
            Hue[0.9060679774997897, 0.6, 0.6], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.880722, 0.611041, 0.142051], 
             AbsoluteThickness[2]], 
            LineBox[{{0., 0.25}, {1., 0.25}, {1., 0.25}}]}, 
           Annotation[#, "Charting`Private`Tag#2"]& ], 
          TagBox[{
            Hue[0.1421359549995791, 0.6, 0.6], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.560181, 0.691569, 0.194885], 
             AbsoluteThickness[2]], 
            LineBox[{{0., 0.25}, {1., 0.25}, {1., 0.25}}]}, 
           Annotation[#, "Charting`Private`Tag#3"]& ], 
          TagBox[{
            Hue[0.37820393249936934`, 0.6, 0.6], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.922526, 0.385626, 0.209179], 
             AbsoluteThickness[2]], 
            LineBox[{{0., 0.25}, {1., 0.25}, {1., 0.25}}]}, 
           Annotation[#, "Charting`Private`Tag#4"]& ]}, {
          TagBox[{
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]], 
            GeometricTransformationBox[
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 GraphicsBox[{
                   EdgeForm[], 
                   DiskBox[{0, 0}]}, PlotRangePadding -> Scaled[0.15]], 
                 GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                    PointSize[0.012833333333333334`], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[2]]}, StripOnInput -> False], 
                TraditionalForm]], {0., 0.}, Automatic, 
              Offset[10.976]], {{{0., 0.25}}, {{1., 0.25}}, {{1., 0.25}}}]}, 
           Annotation[#, "Charting`Private`Tag#1"]& ], 
          TagBox[{
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.880722, 0.611041, 0.142051], 
             AbsoluteThickness[2]], 
            GeometricTransformationBox[
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 GraphicsBox[{
                   EdgeForm[], 
                   PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}, 
                  PlotRangePadding -> Scaled[0.15]], 
                 GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                    PointSize[0.012833333333333334`], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[2]]}, StripOnInput -> False], 
                TraditionalForm]], {0., 0.}, Automatic, 
              Offset[10.5]], {{{0., 0.25}}, {{1., 0.25}}, {{1., 0.25}}}]}, 
           Annotation[#, "Charting`Private`Tag#2"]& ], 
          TagBox[{
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.560181, 0.691569, 0.194885], 
             AbsoluteThickness[2]], 
            GeometricTransformationBox[
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 GraphicsBox[{
                   EdgeForm[], 
                   PolygonBox[{{0, 1}, {1, 0}, {0, -1}, {-1, 0}}]}], 
                 GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                    PointSize[0.012833333333333334`], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[2]]}, StripOnInput -> False], 
                TraditionalForm]], {0., 0.}, Automatic, 
              Offset[10.2]], {{{0., 0.25}}, {{1., 0.25}}, {{1., 0.25}}}]}, 
           Annotation[#, "Charting`Private`Tag#3"]& ], 
          TagBox[{
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.922526, 0.385626, 0.209179], 
             AbsoluteThickness[2]], 
            GeometricTransformationBox[
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 GraphicsBox[{
                   EdgeForm[], 
                   PolygonBox[
                    
                    NCache[{{0, 1}, {-1, 1 - 3^Rational[1, 2]}, {
                    1, 1 - 3^Rational[1, 2]}}, {{0, 
                    1}, {-1, -0.7320508075688772}, {
                    1, -0.7320508075688772}}]]}], 
                 GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                    PointSize[0.012833333333333334`], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[2]]}, StripOnInput -> False], 
                TraditionalForm]], {0., 0.}, Automatic, 
              Offset[11.4]], {{{0., 0.25}}, {{1., 0.25}}, {{1., 0.25}}}]}, 
           Annotation[#, "Charting`Private`Tag#4"]& ]}, {
          TagBox[{
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]], {
             PointBox[{0., 0.25}], 
             PointBox[{1., 0.25}], 
             PointBox[{1., 0.25}]}}, 
           Annotation[#, "Charting`Private`Tag#1"]& ], 
          TagBox[{
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.880722, 0.611041, 0.142051], 
             AbsoluteThickness[2]], {
             PointBox[{0., 0.25}], 
             PointBox[{1., 0.25}], 
             PointBox[{1., 0.25}]}}, 
           Annotation[#, "Charting`Private`Tag#2"]& ], 
          TagBox[{
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.560181, 0.691569, 0.194885], 
             AbsoluteThickness[2]], {
             PointBox[{0., 0.25}], 
             PointBox[{1., 0.25}], 
             PointBox[{1., 0.25}]}}, 
           Annotation[#, "Charting`Private`Tag#3"]& ], 
          TagBox[{
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.922526, 0.385626, 0.209179], 
             AbsoluteThickness[2]], {
             PointBox[{0., 0.25}], 
             PointBox[{1., 0.25}], 
             PointBox[{1., 0.25}]}}, 
           Annotation[#, 
            "Charting`Private`Tag#4"]& ], {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}}}, {
        "WolframDynamicHighlight", <|
         "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>}], 
       StyleBox[
        DynamicBox[
         (Charting`HighlightActionBox["DynamicHighlight", {}, 
          Slot["HighlightElements"], 
          Slot["LayoutOptions"], 
          Slot["Meta"], 
          Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
             Annotation[{
               Hue[0.67, 0.6, 0.6], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.368417, 0.506779, 0.709798], 
                AbsoluteThickness[2]], 
               Line[{{0., 0.25}, {1., 0.25}, {1., 0.25}}]}, 
              "Charting`Private`Tag#1"], 
             Annotation[{
               Hue[0.9060679774997897, 0.6, 0.6], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.880722, 0.611041, 0.142051], 
                AbsoluteThickness[2]], 
               Line[{{0., 0.25}, {1., 0.25}, {1., 0.25}}]}, 
              "Charting`Private`Tag#2"], 
             Annotation[{
               Hue[0.1421359549995791, 0.6, 0.6], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.560181, 0.691569, 0.194885], 
                AbsoluteThickness[2]], 
               Line[{{0., 0.25}, {1., 0.25}, {1., 0.25}}]}, 
              "Charting`Private`Tag#3"], 
             Annotation[{
               Hue[0.37820393249936934`, 0.6, 0.6], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.922526, 0.385626, 0.209179], 
                AbsoluteThickness[2]], 
               Line[{{0., 0.25}, {1., 0.25}, {1., 0.25}}]}, 
              "Charting`Private`Tag#4"]}, {
             Annotation[{
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.368417, 0.506779, 0.709798], 
                AbsoluteThickness[2]], 
               GeometricTransformation[
                Inset[
                 Style[
                  Graphics[{
                    EdgeForm[], 
                    Disk[{0, 0}]}, PlotRangePadding -> Scaled[0.15]], 
                  GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                    PointSize[0.012833333333333334`], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[2]]}], {0., 0.}, Automatic, 
                 Offset[10.976]], {{{0., 0.25}}, {{1., 0.25}}, {{1., 
                0.25}}}]}, "Charting`Private`Tag#1"], 
             Annotation[{
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.880722, 0.611041, 0.142051], 
                AbsoluteThickness[2]], 
               GeometricTransformation[
                Inset[
                 Style[
                  Graphics[{
                    EdgeForm[], 
                    Polygon[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}, 
                   PlotRangePadding -> Scaled[0.15]], 
                  GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                    PointSize[0.012833333333333334`], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[2]]}], {0., 0.}, Automatic, 
                 Offset[10.5]], {{{0., 0.25}}, {{1., 0.25}}, {{1., 0.25}}}]}, 
              "Charting`Private`Tag#2"], 
             Annotation[{
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.560181, 0.691569, 0.194885], 
                AbsoluteThickness[2]], 
               GeometricTransformation[
                Inset[
                 Style[
                  Graphics[{
                    EdgeForm[], 
                    Polygon[{{0, 1}, {1, 0}, {0, -1}, {-1, 0}}]}], 
                  GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                    PointSize[0.012833333333333334`], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[2]]}], {0., 0.}, Automatic, 
                 Offset[10.2]], {{{0., 0.25}}, {{1., 0.25}}, {{1., 0.25}}}]}, 
              "Charting`Private`Tag#3"], 
             Annotation[{
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.922526, 0.385626, 0.209179], 
                AbsoluteThickness[2]], 
               GeometricTransformation[
                Inset[
                 Style[
                  Graphics[{
                    EdgeForm[], 
                    
                    Polygon[{{0, 1}, {-1, 1 - 3^Rational[1, 2]}, {
                    1, 1 - 3^Rational[1, 2]}}]}], 
                  GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                    PointSize[0.012833333333333334`], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[2]]}], {0., 0.}, Automatic, 
                 Offset[11.4]], {{{0., 0.25}}, {{1., 0.25}}, {{1., 0.25}}}]}, 
              "Charting`Private`Tag#4"]}, {
             Annotation[{
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.368417, 0.506779, 0.709798], 
                AbsoluteThickness[2]], {
                Point[{0., 0.25}], 
                Point[{1., 0.25}], 
                Point[{1., 0.25}]}}, "Charting`Private`Tag#1"], 
             Annotation[{
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.880722, 0.611041, 0.142051], 
                AbsoluteThickness[2]], {
                Point[{0., 0.25}], 
                Point[{1., 0.25}], 
                Point[{1., 0.25}]}}, "Charting`Private`Tag#2"], 
             Annotation[{
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.560181, 0.691569, 0.194885], 
                AbsoluteThickness[2]], {
                Point[{0., 0.25}], 
                Point[{1., 0.25}], 
                Point[{1., 0.25}]}}, "Charting`Private`Tag#3"], 
             Annotation[{
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.922526, 0.385626, 0.209179], 
                AbsoluteThickness[2]], {
                Point[{0., 0.25}], 
                Point[{1., 0.25}], 
                Point[{1., 0.25}]}}, 
              "Charting`Private`Tag#4"], {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}}}, <|
           "HighlightElements" -> <|
             "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
            "LayoutOptions" -> <|
             "PanelPlotLayout" -> <||>, "PlotRange" -> {{0, 1.}, {0., 1.}}, 
              "Frame" -> {{False, False}, {False, False}}, 
              "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
              "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
              GoldenRatio^(-1), "DefaultStyle" -> {
                Directive[
                 PointSize[0.012833333333333334`], 
                 RGBColor[0.922526, 0.385626, 0.209179], 
                 AbsoluteThickness[2]], 
                Directive[
                 PointSize[0.012833333333333334`], 
                 RGBColor[0.560181, 0.691569, 0.194885], 
                 AbsoluteThickness[2]], 
                Directive[
                 PointSize[0.012833333333333334`], 
                 RGBColor[0.880722, 0.611041, 0.142051], 
                 AbsoluteThickness[2]], 
                Directive[
                 PointSize[0.012833333333333334`], 
                 RGBColor[0.368417, 0.506779, 0.709798], 
                 AbsoluteThickness[2]]}, 
              "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                  Identity[
                   Part[#, 1]], 
                  Identity[
                   Part[#, 2]]}& ), 
                "ScalingFunctions" -> {{Identity, Identity}, {
                  Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
              False|>, 
            "Meta" -> <|
             "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
              "Function" -> ListPlot, "GroupHighlight" -> False|>|>]]& )[<|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
           "LayoutOptions" -> <|
            "PanelPlotLayout" -> <||>, "PlotRange" -> {{0, 1.}, {0., 1.}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
             "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
             GoldenRatio^(-1), "DefaultStyle" -> {
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.922526, 0.385626, 0.209179], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.560181, 0.691569, 0.194885], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.880722, 0.611041, 0.142051], 
                AbsoluteThickness[2]], 
               Directive[
                PointSize[0.012833333333333334`], 
                RGBColor[0.368417, 0.506779, 0.709798], 
                AbsoluteThickness[2]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 Identity[
                  Part[#, 1]], 
                 Identity[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> ListPlot, "GroupHighlight" -> False|>|>]], 
        Selectable -> False]}, 
      Annotation[{{{}, {}, 
         Annotation[{
           Hue[0.67, 0.6, 0.6], 
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.368417, 0.506779, 0.709798], 
            AbsoluteThickness[2]], 
           Line[{{0., 0.25}, {1., 0.25}, {1., 0.25}}]}, 
          "Charting`Private`Tag#1"], 
         Annotation[{
           Hue[0.9060679774997897, 0.6, 0.6], 
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.880722, 0.611041, 0.142051], 
            AbsoluteThickness[2]], 
           Line[{{0., 0.25}, {1., 0.25}, {1., 0.25}}]}, 
          "Charting`Private`Tag#2"], 
         Annotation[{
           Hue[0.1421359549995791, 0.6, 0.6], 
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.560181, 0.691569, 0.194885], 
            AbsoluteThickness[2]], 
           Line[{{0., 0.25}, {1., 0.25}, {1., 0.25}}]}, 
          "Charting`Private`Tag#3"], 
         Annotation[{
           Hue[0.37820393249936934`, 0.6, 0.6], 
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.922526, 0.385626, 0.209179], 
            AbsoluteThickness[2]], 
           Line[{{0., 0.25}, {1., 0.25}, {1., 0.25}}]}, 
          "Charting`Private`Tag#4"]}, {
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.368417, 0.506779, 0.709798], 
            AbsoluteThickness[2]], 
           GeometricTransformation[
            Inset[
             Style[
              Graphics[{
                EdgeForm[], 
                Disk[{0, 0}]}, PlotRangePadding -> Scaled[0.15]], 
              GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                  PointSize[0.012833333333333334`], 
                  RGBColor[0.368417, 0.506779, 0.709798], 
                  AbsoluteThickness[2]]}], {0., 0.}, Automatic, 
             Offset[10.976]], {{{0., 0.25}}, {{1., 0.25}}, {{1., 0.25}}}]}, 
          "Charting`Private`Tag#1"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.880722, 0.611041, 0.142051], 
            AbsoluteThickness[2]], 
           GeometricTransformation[
            Inset[
             Style[
              Graphics[{
                EdgeForm[], 
                Polygon[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}, 
               PlotRangePadding -> Scaled[0.15]], 
              GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                  PointSize[0.012833333333333334`], 
                  RGBColor[0.880722, 0.611041, 0.142051], 
                  AbsoluteThickness[2]]}], {0., 0.}, Automatic, 
             Offset[10.5]], {{{0., 0.25}}, {{1., 0.25}}, {{1., 0.25}}}]}, 
          "Charting`Private`Tag#2"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.560181, 0.691569, 0.194885], 
            AbsoluteThickness[2]], 
           GeometricTransformation[
            Inset[
             Style[
              Graphics[{
                EdgeForm[], 
                Polygon[{{0, 1}, {1, 0}, {0, -1}, {-1, 0}}]}], 
              GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                  PointSize[0.012833333333333334`], 
                  RGBColor[0.560181, 0.691569, 0.194885], 
                  AbsoluteThickness[2]]}], {0., 0.}, Automatic, 
             Offset[10.2]], {{{0., 0.25}}, {{1., 0.25}}, {{1., 0.25}}}]}, 
          "Charting`Private`Tag#3"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.922526, 0.385626, 0.209179], 
            AbsoluteThickness[2]], 
           GeometricTransformation[
            Inset[
             Style[
              Graphics[{
                EdgeForm[], 
                
                Polygon[{{0, 1}, {-1, 1 - 3^Rational[1, 2]}, {
                  1, 1 - 3^Rational[1, 2]}}]}], 
              GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                  PointSize[0.012833333333333334`], 
                  RGBColor[0.922526, 0.385626, 0.209179], 
                  AbsoluteThickness[2]]}], {0., 0.}, Automatic, 
             Offset[11.4]], {{{0., 0.25}}, {{1., 0.25}}, {{1., 0.25}}}]}, 
          "Charting`Private`Tag#4"]}, {
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.368417, 0.506779, 0.709798], 
            AbsoluteThickness[2]], {
            Point[{0., 0.25}], 
            Point[{1., 0.25}], 
            Point[{1., 0.25}]}}, "Charting`Private`Tag#1"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.880722, 0.611041, 0.142051], 
            AbsoluteThickness[2]], {
            Point[{0., 0.25}], 
            Point[{1., 0.25}], 
            Point[{1., 0.25}]}}, "Charting`Private`Tag#2"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.560181, 0.691569, 0.194885], 
            AbsoluteThickness[2]], {
            Point[{0., 0.25}], 
            Point[{1., 0.25}], 
            Point[{1., 0.25}]}}, "Charting`Private`Tag#3"], 
         Annotation[{
           Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.922526, 0.385626, 0.209179], 
            AbsoluteThickness[2]], {
            Point[{0., 0.25}], 
            Point[{1., 0.25}], 
            Point[{1., 0.25}]}}, 
          "Charting`Private`Tag#4"], {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}}}, <|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
        "LayoutOptions" -> <|
         "PanelPlotLayout" -> <||>, "PlotRange" -> {{0, 1.}, {0., 1.}}, 
          "Frame" -> {{False, False}, {False, False}}, "AxesOrigin" -> {0, 0},
           "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
          "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
          "DefaultStyle" -> {
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.922526, 0.385626, 0.209179], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.560181, 0.691569, 0.194885], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.880722, 0.611041, 0.142051], 
             AbsoluteThickness[2]], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              Identity[
               Part[#, 1]], 
              Identity[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          ListPlot, "GroupHighlight" -> False|>|>, 
       "DynamicHighlight"]], {{}, {}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, DisplayFunction -> 
     Identity, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {
       FormBox[
        TagBox["\"Iteration\"", HoldForm], TraditionalForm], 
       FormBox[
        TagBox["\"Probability\"", HoldForm], TraditionalForm]}, 
     AxesOrigin -> {0, 0}, DisplayFunction :> Identity, 
     Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {Automatic, Automatic}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
         Directive[
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.560181, 0.691569, 0.194885], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.922526, 0.385626, 0.209179], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.528488, 0.470624, 0.701351], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.772079, 0.431554, 0.102387], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.363898, 0.618501, 0.782349], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[1, 0.75, 0], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.647624, 0.37816, 0.614037], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.571589, 0.586483, 0.], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.915, 0.3325, 0.2125], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[
          0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
          AbsoluteThickness[2]], 
         Directive[
          RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
          AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
       "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> 
       Scaled[0.05], "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> 
       "CurrentSet", "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> 
       True, "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& )}}, PlotLabel -> 
     FormBox["\"Convergence of Probabilities in Crisis Game\"", 
       TraditionalForm], PlotRange -> {{0, 1.}, {0., 1.}}, PlotRangeClipping -> 
     True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {0, 0}}, Ticks -> {Automatic, Automatic}}], 
   FormBox[
    FormBox[
     TemplateBox[{"\"pWar\"", "\"pCap2\"", "\"pCap1\"", "\"pNego\""}, 
      "PointLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[2]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[2]], {
                    InsetBox[
                    GraphicsBox[{
                    EdgeForm[], 
                    DiskBox[{0, 0}]}, {DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[2]]}, PlotRangePadding -> 
                    Scaled[0.15]}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[2]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[2]], {
                    InsetBox[
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}, {
                    DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[2]]}, PlotRangePadding -> 
                    Scaled[0.15]}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[2]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[2]], {
                    InsetBox[
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{0, 1}, {1, 0}, {0, -1}, {-1, 0}}]}, {
                    DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[2]]}}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #3}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[2]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[2]], {
                    InsetBox[
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[
                    
                    NCache[{{0, 1}, {-1, 1 - 3^Rational[1, 2]}, {
                    1, 1 - 3^Rational[1, 2]}}, {{0, 
                    1}, {-1, -0.7320508075688772}, {
                    1, -0.7320508075688772}}]]}, {
                    DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[2]]}}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #4}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.922526, 0.385626, 0.209179]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], 
             "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3, ",", #4}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    GraphicsBox[{
                    EdgeForm[], 
                    DiskBox[{0, 0}]}, PlotRangePadding -> Scaled[0.15]], ",", 
                    RowBox[{"Offset", "[", "10.976`", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}, 
                    PlotRangePadding -> Scaled[0.15]], ",", 
                    RowBox[{"Offset", "[", "10.5`", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{0, 1}, {1, 0}, {0, -1}, {-1, 0}}]}], ",", 
                    RowBox[{"Offset", "[", "10.2`", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[
                    
                    NCache[{{0, 1}, {-1, 1 - 3^Rational[1, 2]}, {
                    1, 1 - 3^Rational[1, 2]}}, {{0, 
                    1}, {-1, -0.7320508075688772}, {
                    1, -0.7320508075688772}}]]}], ",", 
                    RowBox[{"Offset", "[", "11.4`", "]"}]}], "}"}]}], "}"}]}],
            ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "True", ",", "True", ",", "True"}], 
               "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{3.9545563933231945`*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"e6ea3aaf-b37d-c54e-b0db-cd9d95ea98a0"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.954548292155939*^9},
 CellLabel->"In[91]:=",ExpressionUUID->"8e6051a5-86d0-4a4a-93c7-4be6423cbbbe"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Full Game", "Subsubsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544285857935*^9}, {
  3.9545480675777626`*^9, 3.954548069633732*^9}, {3.9545481151436844`*^9, 
  3.9545481453296375`*^9}},
 FontWeight->"Plain",ExpressionUUID->"d1156b76-f939-4449-b98b-22e353289c7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fullResult", "=", 
   RowBox[{"FindFullEquilibrium", "[", 
    RowBox[{
     RowBox[{"sampleCase", "[", "\"\<U1War\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"sampleCase", "[", "\"\<U1Cap1\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"sampleCase", "[", "\"\<U1Cap2\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"sampleCase", "[", "\"\<U1Nego\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"sampleCase", "[", "\"\<U1SQ\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"sampleCase", "[", "\"\<U1Acq1\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"sampleCase", "[", "\"\<U1Acq2\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"sampleCase", "[", "\"\<U2War\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"sampleCase", "[", "\"\<U2Cap2\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"sampleCase", "[", "\"\<U2Cap1\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"sampleCase", "[", "\"\<U2Nego\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"sampleCase", "[", "\"\<U2SQ\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"sampleCase", "[", "\"\<U2Acq1\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"sampleCase", "[", "\"\<U2Acq2\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "lambda", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "dt1", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "dt2", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "dt3", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "dt4", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "maxIter", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "threshold", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "verboseMode"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.954544503782427*^9, 3.954544551184326*^9}, {
  3.954544733265505*^9, 3.9545448053578186`*^9}, {3.954548565182218*^9, 
  3.954548595778244*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"e50d641f-343e-6941-9cd6-e66a7a804636"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"visualise", " ", "results"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.954544909854458*^9, 3.954544913423717*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"6f8b59bd-6eb2-8747-ab3f-4b960ca0efea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fullGameConvergenceViz", " ", "=", " ", 
   RowBox[{"PlotDemandsConvergence", "[", 
    RowBox[{"fullResult", "[", "\"\<DemandsIterationHistory\>\"", "]"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{"CreateSummaryTable", "[", "fullResult", "]"}]}], "Input",
 CellChangeTimes->{{3.9545449211351624`*^9, 3.9545449211351624`*^9}, {
  3.9545450067780743`*^9, 3.954545009318968*^9}, {3.954547474297886*^9, 
  3.954547500352436*^9}, {3.954548160025404*^9, 3.954548178100658*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"8d54eb1e-2665-7e46-91cf-3766ebbca5d5"],

Cell[BoxData[
 RowBox[{"fullGameConvergenceViz", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9545481953446608`*^9, 3.9545481959129124`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"16d1ba23-a195-1b45-8227-b83d9f568e07"],

Cell[BoxData[
 RowBox[{"fullGameConvergenceViz", "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9545482041934223`*^9, 3.954548211169597*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"ca5e75cd-f17a-674d-a71f-458015fffdc2"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.954548288414898*^9},
 CellLabel->"In[98]:=",ExpressionUUID->"14e7374a-26d4-7c4a-bddd-c673e26364d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find Optimal Probabilities", "Subsubsection",
 CellChangeTimes->{{3.954544209871214*^9, 3.954544285857935*^9}, {
  3.9545480675777626`*^9, 3.954548069633732*^9}, {3.9545481151436844`*^9, 
  3.9545481453296375`*^9}, {3.95454824800111*^9, 3.9545482520768566`*^9}},
 FontWeight->"Plain",ExpressionUUID->"2f144f54-775c-0849-b3ae-ac11cc999c68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"optimalPhases", "=", 
   RowBox[{"FindOptimalPhases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"preparedData", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "NumSamples"}], "]"}], "]"}], ",", 
     RowBox[{"(*", 
      RowBox[{"Use", " ", "subset", " ", "for", " ", "testing"}], "*)"}], 
     "\[IndentingNewLine]", "lambda", ",", 
     RowBox[{"(*", "Lambda", "*)"}], "\[IndentingNewLine]", "1000", ",", 
     RowBox[{"(*", 
      RowBox[{"phaseGridSize", " ", "value", " ", "for", " ", "testing"}], 
      "*)"}], "\[IndentingNewLine]", "\"\<RandomSampling\>\"", ",", 
     RowBox[{"(*", 
      RowBox[{
      "Using", " ", "random", " ", "sampling", " ", "instead", " ", "of", " ",
        "grid", " ", "search"}], "*)"}], "\[IndentingNewLine]", "500"}], 
    "                    ", 
    RowBox[{"(*", 
     RowBox[{
     "Number", " ", "of", " ", "random", " ", "samples", " ", "to", " ", 
      "try"}], "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9545449552845936`*^9, 3.95454498378124*^9}, {
  3.954545047622879*^9, 3.9545450850829754`*^9}, {3.954548326689127*^9, 
  3.954548327553308*^9}, {3.9545486163995867`*^9, 3.954548618673052*^9}, {
  3.954549488802866*^9, 3.954549493571863*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"01025ef2-cc89-3a4b-a6f8-d2f6677301d7"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.954548317118517*^9},
 CellLabel->
  "In[100]:=",ExpressionUUID->"0404e001-ebad-e94c-aaf3-04b3ae389d7a"],

Cell[BoxData[
 RowBox[{"VisualizeOptimalPhasesResult", "[", 
  RowBox[{"optimalPhases", ",", "preparedData"}], "]"}]], "Input",
 CellChangeTimes->{{3.954548954793312*^9, 3.95454895921373*^9}, 
   3.954549068065176*^9},
 CellLabel->
  "In[101]:=",ExpressionUUID->"f274b070-89f3-824e-b465-edcfe7f1311f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testData", "=", 
   RowBox[{"preparedData", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"NumSamples", "+", "1"}], ";;", 
      RowBox[{"NumSamples", "+", "101"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9545492627530785`*^9, 3.954549298568699*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"46a5f811-f3d3-fe48-b104-fbcc7fe3a64a"],

Cell[BoxData[
 RowBox[{"VisualizePredictionAccuracy", "[", 
  RowBox[{"optimalPhases", ",", "testData"}], "]"}]], "Input",
 CellChangeTimes->{{3.954549254233774*^9, 3.954549254233774*^9}, {
  3.954549304764488*^9, 3.9545493071467533`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"b559cfde-6a72-834a-9be7-f8a344f89451"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{634.6666666666666, 727},
WindowMargins->{{-4, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
Magnification:>0.75 Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7ebb2c31-88ab-4a83-aa63-bd20f0109eec"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 198, 3, 121, "Title",ExpressionUUID->"c1042fb1-f1b4-4593-a5ef-dd40d4a27210"],
Cell[CellGroupData[{
Cell[803, 29, 248, 4, 50, "Section",ExpressionUUID->"ec665f0e-1b94-4c88-9520-0f4d058ed250"],
Cell[1054, 35, 190, 3, 27, "Text",ExpressionUUID->"3d93a3b2-b86f-411f-a986-336e290898c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1281, 43, 367, 6, 50, "Section",ExpressionUUID->"e4dcf874-0ea3-4ddc-8539-ab129ce0b9c0"],
Cell[CellGroupData[{
Cell[1673, 53, 217, 4, 41, "Subsection",ExpressionUUID->"3c695189-56a7-4d5b-803c-02d5f0581247"],
Cell[1893, 59, 2154, 46, 362, "Text",ExpressionUUID->"1882c8df-b893-4d99-a10c-ca410cf8faad"],
Cell[4050, 107, 1784, 39, 136, "Input",ExpressionUUID->"dd5191dc-bda1-4f1b-8452-d4c715b37568"],
Cell[5837, 148, 635, 16, 50, "Input",ExpressionUUID->"7a95404d-3df8-4ca3-80d8-8b9a219c990d"],
Cell[6475, 166, 490, 11, 36, "Input",ExpressionUUID->"b3eda1c4-5e4e-7e4c-b78d-7d40ff1b51d6"],
Cell[6968, 179, 12028, 330, 792, "Input",ExpressionUUID->"6a74c307-4745-3444-b346-17d95704923f"],
Cell[18999, 511, 166, 2, 36, "Input",ExpressionUUID->"18720e29-c57e-4463-9604-b09b99b42fa1"],
Cell[CellGroupData[{
Cell[19190, 517, 281, 4, 34, "Subsubsection",ExpressionUUID->"2d5e6ee2-d436-4353-8471-3db1208d367f"],
Cell[19474, 523, 7086, 199, 621, "Input",ExpressionUUID->"f0cbf99a-971d-a84e-89e7-8df4ee28500e"],
Cell[26563, 724, 559, 11, 45, "Text",ExpressionUUID->"1d7e8e82-a778-4c48-94d2-4cd3050af9f1"],
Cell[27125, 737, 855, 17, 155, "Text",ExpressionUUID->"75f710e7-23de-4eb0-a9ae-80059d2050db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28017, 759, 212, 4, 34, "Subsubsection",ExpressionUUID->"7fc05352-8e72-471b-8c5a-598dd4f4a68a"],
Cell[28232, 765, 848, 20, 112, "Text",ExpressionUUID->"be76a49a-e94c-452b-b4e5-c1610a1d05c8"],
Cell[29083, 787, 1628, 46, 64, "Input",ExpressionUUID->"92fb8eb3-38cd-4bd7-b7d0-add8c75edc8b"],
Cell[30714, 835, 12232, 331, 792, "Input",ExpressionUUID->"59f90979-ffd9-fa4e-9c50-0477df4a0d17"],
Cell[42949, 1168, 330, 7, 21, "Input",ExpressionUUID->"f522d8df-ddef-ff45-b146-5810c40eaa56"],
Cell[43282, 1177, 7071, 198, 621, "Input",ExpressionUUID->"a1bf14ad-7c61-d74b-8992-6bad0c830749"],
Cell[50356, 1377, 1059, 23, 155, "Text",ExpressionUUID->"602c86a0-7b60-4042-ad17-eab6553c1ef8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51476, 1407, 334, 5, 45, "Chapter",ExpressionUUID->"e9b4b5d2-07be-4507-8fdb-03f26a8cdd26"],
Cell[CellGroupData[{
Cell[51835, 1416, 235, 3, 41, "Subsection",ExpressionUUID->"216ec60a-991a-194c-af15-0000aa17d4db"],
Cell[52073, 1421, 18673, 392, 2077, "Input",ExpressionUUID->"bf115939-a91c-490b-a2df-58338346514c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70783, 1818, 284, 4, 41, "Subsection",ExpressionUUID->"367be9c2-97e8-c245-b723-e3e7ad61614e"],
Cell[71070, 1824, 24890, 526, 2776, "Input",ExpressionUUID->"32998cc0-6de7-6341-b3c8-81297a95c20e"],
Cell[95963, 2352, 24122, 527, 1135, "Input",ExpressionUUID->"f4f5835e-5d1a-a740-810b-e4c9221bf4da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120122, 2884, 327, 4, 41, "Subsection",ExpressionUUID->"00ad7f89-3fe5-5545-955d-571d3d737b6a"],
Cell[120452, 2890, 394, 8, 21, "Input",ExpressionUUID->"13c459b4-16ca-ae4e-8940-fff20331dcae"],
Cell[120849, 2900, 3108, 75, 164, "Input",ExpressionUUID->"2f87477f-6e3f-ca47-b558-a9316602e9ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123994, 2980, 334, 4, 41, "Subsection",ExpressionUUID->"615555de-cfc2-9444-8c14-21a137803fb2"],
Cell[124331, 2986, 368, 7, 21, "Input",ExpressionUUID->"75130c9d-f6a8-424b-88d5-ddabe485dc0f"],
Cell[124702, 2995, 14125, 342, 592, "Input",ExpressionUUID->"55ab0b21-1bde-e442-8268-a03ce21975df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138864, 3342, 335, 4, 41, "Subsection",ExpressionUUID->"6f4cdabc-dac8-9e46-9f9f-79d8cd49d4fb"],
Cell[139202, 3348, 14642, 349, 607, "Input",ExpressionUUID->"0279d52c-fc67-5d45-8558-cb79a0a1d374"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153881, 3702, 382, 5, 41, "Subsection",ExpressionUUID->"52e56281-474b-8549-8ddc-31a15e06a676"],
Cell[154266, 3709, 6651, 146, 464, "Input",ExpressionUUID->"7f4951c0-3497-7447-9b5f-266837cb5cf9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160954, 3860, 440, 6, 41, "Subsection",ExpressionUUID->"1f3df66f-ce49-e64d-86b0-210e69dd369a"],
Cell[161397, 3868, 4392, 103, 279, "Input",ExpressionUUID->"01dfd9a5-c21b-0649-8536-f4b69bda7029"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165826, 3976, 442, 6, 41, "Subsection",ExpressionUUID->"66ac1f4d-db24-bb40-bbaf-bb9f044efe0c"],
Cell[166271, 3984, 4162, 89, 307, "Input",ExpressionUUID->"7df1ea14-b90e-3149-95ab-a87110a725e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170470, 4078, 441, 6, 41, "Subsection",ExpressionUUID->"a9e620a9-1426-3f4e-a9ee-fa5561535c2b"],
Cell[170914, 4086, 22413, 512, 1049, "Input",ExpressionUUID->"03efcd41-8af2-8748-bb80-da745ceb50a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193364, 4603, 472, 6, 41, "Subsection",ExpressionUUID->"27f52cdd-2aab-f643-b5d0-6db60e6f66ab"],
Cell[193839, 4611, 10494, 251, 592, "Input",ExpressionUUID->"693d66af-8a3e-ed4f-b2dc-16550e1a721c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204370, 4867, 567, 7, 41, "Subsection",ExpressionUUID->"46269c6c-f724-0748-a8c3-ee2c6b807115"],
Cell[204940, 4876, 7567, 179, 507, "Input",ExpressionUUID->"ed1e8599-5c7f-9947-b878-356ff2c2d975"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212544, 5060, 546, 7, 41, "Subsection",ExpressionUUID->"c5485c24-89d9-fd44-b1ad-d522dbc2fe28"],
Cell[213093, 5069, 23603, 526, 1163, "Input",ExpressionUUID->"0ea944cf-bd89-864d-9abc-6603b643b23d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[236733, 5600, 519, 7, 41, "Subsection",ExpressionUUID->"58b2b4ff-39a7-4942-b2ee-8c453f95d376"],
Cell[237255, 5609, 5899, 142, 421, "Input",ExpressionUUID->"e0523063-8f73-514b-acf9-7e0fc64ef83d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243191, 5756, 519, 7, 41, "Subsection",ExpressionUUID->"7f4f7e53-f6b9-b047-b1b9-8b6bd74bdf9a"],
Cell[243713, 5765, 22619, 496, 1192, "Input",ExpressionUUID->"1004aa06-1309-4f42-b6ef-b52c603e8b0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266369, 6266, 541, 7, 41, "Subsection",ExpressionUUID->"eb572ea0-b4ec-a341-9597-6c39b015b763"],
Cell[266913, 6275, 14364, 324, 821, "Input",ExpressionUUID->"2afefde3-d58f-6e43-9582-e9b28fa59641"]
}, Open  ]],
Cell[CellGroupData[{
Cell[281314, 6604, 577, 8, 41, "Subsection",ExpressionUUID->"5c483d72-9f6e-3747-844a-12c3cac9ad9c"],
Cell[CellGroupData[{
Cell[281916, 6616, 3157, 76, 279, "Input",ExpressionUUID->"eac28e56-2988-fc44-8e89-3586d88c0cca"],
Cell[285076, 6694, 448, 10, 22, "Message",ExpressionUUID->"cdcc1d1e-5dbe-1747-b84a-e69a10bf3260"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[285573, 6710, 566, 7, 41, "Subsection",ExpressionUUID->"4ef1e3ef-cc74-1c43-9206-d62835e18b8b"],
Cell[286142, 6719, 35519, 769, 3247, "Input",ExpressionUUID->"5906e349-1b1c-c942-b237-d5d2d8dc0453"]
}, Open  ]],
Cell[CellGroupData[{
Cell[321698, 7493, 591, 8, 41, "Subsection",ExpressionUUID->"31552222-7956-9146-a3f3-96772c233d84"],
Cell[322292, 7503, 14590, 348, 807, "Input",ExpressionUUID->"7c33c1be-8e34-6445-ae47-827c821edf30"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[336931, 7857, 280, 4, 45, "Chapter",ExpressionUUID->"aa180197-1398-4398-88c3-21624f8cd6c1"],
Cell[CellGroupData[{
Cell[337236, 7865, 174, 2, 41, "Subsection",ExpressionUUID->"de48ae4c-8a41-684a-8fbb-495278ed9653"],
Cell[337413, 7869, 237, 4, 21, "Input",ExpressionUUID->"0d2bd081-4735-1e46-8091-5cd086d9830e"],
Cell[337653, 7875, 1508, 34, 164, "Input",ExpressionUUID->"afe2af3f-41b5-4849-a486-c562e5947bfc"],
Cell[339164, 7911, 214, 3, 21, "Input",ExpressionUUID->"bb0420b8-f076-7245-b7ec-97f1e3d81c2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[339415, 7919, 177, 2, 41, "Subsection",ExpressionUUID->"01035a6a-4984-134c-b1ca-ce5236c0a325"],
Cell[339595, 7923, 373, 8, 21, "Input",ExpressionUUID->"e06242bf-406b-c448-8e47-c42c5135d91c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[340005, 7936, 273, 4, 41, "Subsection",ExpressionUUID->"aa7f8aa8-445f-a348-87a4-59f95d81ece3"],
Cell[340281, 7942, 1111, 26, 136, "Input",ExpressionUUID->"9c8d2f38-264e-e44f-acbb-dee3cfbd66ce"],
Cell[341395, 7970, 171, 2, 21, "Input",ExpressionUUID->"977dd470-6743-4445-813b-52f80a4fc408"]
}, Open  ]],
Cell[CellGroupData[{
Cell[341603, 7977, 223, 3, 41, "Subsection",ExpressionUUID->"efbf4230-3dd5-4b46-a733-d80b5ecb6de4"],
Cell[341829, 7982, 388, 9, 36, "Input",ExpressionUUID->"4fc01bde-156b-b749-b614-798b7c16f752"],
Cell[CellGroupData[{
Cell[342242, 7995, 283, 4, 34, "Subsubsection",ExpressionUUID->"9129694f-f725-314f-8406-acb14b8987d6"],
Cell[342528, 8001, 848, 17, 50, "Input",ExpressionUUID->"aef73dd4-6851-0f45-ba74-704310f14698"],
Cell[343379, 8020, 1682, 32, 221, "Input",ExpressionUUID->"07a5eb30-117d-6f4a-a352-737bd6558c3e"],
Cell[345064, 8054, 245, 4, 21, "Input",ExpressionUUID->"66a346b6-4ae9-e24e-b988-a2509448d2cb"],
Cell[345312, 8060, 410, 8, 21, "Input",ExpressionUUID->"70f04e63-416a-564d-9c84-76378941e1e0"],
Cell[CellGroupData[{
Cell[345747, 8072, 296, 5, 21, "Input",ExpressionUUID->"a5f32752-a751-c643-b585-d06a0ab15db7"],
Cell[346046, 8079, 40999, 943, 186, "Output",ExpressionUUID->"e6ea3aaf-b37d-c54e-b0db-cd9d95ea98a0"]
}, Open  ]],
Cell[387060, 9025, 166, 2, 36, "Input",ExpressionUUID->"8e6051a5-86d0-4a4a-93c7-4be6423cbbbe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[387263, 9032, 281, 4, 34, "Subsubsection",ExpressionUUID->"d1156b76-f939-4449-b98b-22e353289c7e"],
Cell[387547, 9038, 2360, 45, 321, "Input",ExpressionUUID->"e50d641f-343e-6941-9cd6-e66a7a804636"],
Cell[389910, 9085, 243, 4, 21, "Input",ExpressionUUID->"6f8b59bd-6eb2-8747-ab3f-4b960ca0efea"],
Cell[390156, 9091, 587, 11, 50, "Input",ExpressionUUID->"8d54eb1e-2665-7e46-91cf-3766ebbca5d5"],
Cell[390746, 9104, 251, 5, 21, "Input",ExpressionUUID->"16d1ba23-a195-1b45-8227-b83d9f568e07"],
Cell[391000, 9111, 249, 5, 21, "Input",ExpressionUUID->"ca5e75cd-f17a-674d-a71f-458015fffdc2"],
Cell[391252, 9118, 166, 2, 36, "Input",ExpressionUUID->"14e7374a-26d4-7c4a-bddd-c673e26364d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[391455, 9125, 345, 4, 34, "Subsubsection",ExpressionUUID->"2f144f54-775c-0849-b3ae-ac11cc999c68"],
Cell[391803, 9131, 1364, 28, 107, "Input",ExpressionUUID->"01025ef2-cc89-3a4b-a6f8-d2f6677301d7"],
Cell[393170, 9161, 170, 3, 36, "Input",ExpressionUUID->"0404e001-ebad-e94c-aaf3-04b3ae389d7a"],
Cell[393343, 9166, 301, 6, 21, "Input",ExpressionUUID->"f274b070-89f3-824e-b465-edcfe7f1311f"],
Cell[393647, 9174, 391, 10, 21, "Input",ExpressionUUID->"46a5f811-f3d3-fe48-b104-fbcc7fe3a64a"],
Cell[394041, 9186, 322, 6, 21, "Input",ExpressionUUID->"b559cfde-6a72-834a-9be7-f8a344f89451"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

