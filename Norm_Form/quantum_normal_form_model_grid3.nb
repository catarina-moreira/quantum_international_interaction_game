(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    363632,       8655]
NotebookOptionsPosition[    350111,       8448]
NotebookOutlinePosition[    350566,       8466]
CellTagsIndexPosition[    350523,       8463]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["A Quantum-Like for the International Interaction Game", "Title",
 CellChangeTimes->{{3.901469939660698*^9, 
  3.9014699600327873`*^9}},ExpressionUUID->"c1042fb1-f1b4-4593-a5ef-\
dd40d4a27210"],

Cell[CellGroupData[{

Cell["Quantum-Like Normal Form Model", "Section",
 CellChangeTimes->{{3.901470103209635*^9, 3.901470108444337*^9}, {
  3.9400514701352787`*^9, 3.940051488190655*^9}, {3.9400515191234336`*^9, 
  3.940051525783704*^9}, {3.940051774497916*^9, 3.940051774937658*^9}, {
  3.940052756935771*^9, 3.9400527626031833`*^9}, {3.95860550853755*^9, 
  3.9586055224494343`*^9}},ExpressionUUID->"e4dcf874-0ea3-4ddc-8539-\
ab129ce0b9c0"],

Cell[TextData[{
 "We propose we can understand IIG as the sequence of two normal-form game - \
demands and crisis games\nIn each of these two game, both actors have a \
strategic set of two strategies, from which they choose simultaneously\n\n",
 Cell[BoxData[GridBox[{
    {
     RowBox[{"demands", " ", "game"}], "D2", "nD2"},
    {"D1", 
     RowBox[{"crisis", " ", "game"}], 
     RowBox[{"U1Acq2", ",", " ", "U2Acq2"}]},
    {"nD1", 
     RowBox[{"U1Acq1", ",", " ", "U2Acq1"}], 
     RowBox[{"U1SQ", ",", " ", "U2SQ"}]}
   },
   GridBoxDividers->{"Columns" -> {{True}}, "Rows" -> {{True}}}]],
  ExpressionUUID->"a0dec4a3-afef-4c9f-bdb5-9003bfed63af"],
 "\n\n",
 Cell[BoxData[GridBox[{
    {
     RowBox[{" ", 
      RowBox[{"crisis", " ", "game", " "}]}], "F2", "nF2"},
    {"F1", 
     RowBox[{"U1War", ",", " ", "U2War"}], 
     RowBox[{"U1Cap2", ",", " ", "U2Cap2"}]},
    {"nF1", 
     RowBox[{"U1Cap1", ",", " ", "U2Cap1"}], 
     RowBox[{"U1Nego", ",", " ", "U2Nego"}]}
   },
   GridBoxDividers->{"Columns" -> {{True}}, "Rows" -> {{True}}}]],
  ExpressionUUID->"c25b412a-7f1c-457c-868a-cc864a667b19"],
 "\n(we need to deal with the fact that we do not distinguish utilities of \
War1 and War2 in normal form game - we currently use an average of the two)\n\
\nwe take Signorino formula for the conditional probability of choosing \
between the strategies given their utilities and the expected strategy of the \
other player\np(F1|F2) = \
exp(lambda*U1War)/(exp(lambda*U1War)+exp(lambda*U1Cap1))\n\nwhich results in \
following probability amplitudes"
}], "Text",
 CellChangeTimes->{{3.9400527872543883`*^9, 3.940052958357076*^9}, {
   3.94005300615065*^9, 3.9400530632424145`*^9}, 3.940053111548642*^9, {
   3.9400531620779095`*^9, 3.9400532773130054`*^9}, {3.940053314262853*^9, 
   3.9400536155783997`*^9}, {3.940053658014623*^9, 3.940053741789645*^9}, {
   3.9400537826692376`*^9, 3.94005378736124*^9}, {3.9400538285721025`*^9, 
   3.940054092350127*^9}, 3.940054265769491*^9, {3.940054673034133*^9, 
   3.940054673465183*^9}, {3.9400594201374865`*^9, 3.940059450106407*^9}, 
   3.9586060285469017`*^9},ExpressionUUID->"1882c8df-b893-4d99-a10c-\
ca410cf8faad"],

Cell[CellGroupData[{

Cell["CRISIS GAME AMPLITUDE FUNCTION", "Subsection",
 CellChangeTimes->{
  3.9586060256608467`*^9},ExpressionUUID->"e9aeacdf-9925-a14b-bd35-\
31c9209d32e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Player", " ", 
    RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "fighting", 
    " ", "after", " ", "Player", " ", "2", " ", "fights"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aF1afterF2", "[", 
     RowBox[{"U1War_", ",", "U1Cap1_", ",", "lambda_", ",", "theta1a_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U1War"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1War"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1Cap1"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta1a", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "fighting", " ", "after", " ", "Player", " ", "2", " ", "fights"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aNF1afterF2", "[", 
     RowBox[{"U1War_", ",", "U1Cap1_", ",", "lambda_", ",", "theta1a_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U1Cap1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1War"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1Cap1"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta1a", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "fighting", 
     " ", "after", " ", "Player", " ", "2", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "fight"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aF1afterNF2", "[", 
     RowBox[{"U1Cap2_", ",", "U1Nego_", ",", "lambda_", ",", "theta1b_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U1Cap2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1Cap2"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1Nego"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta1b", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "fighting", " ", "after", " ", "Player", " ", "2", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "fight"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aNF1afterNF2", "[", 
     RowBox[{"U1Cap2_", ",", "U1Nego_", ",", "lambda_", ",", "theta1b_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U1Nego"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1Cap2"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1Nego"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta1b", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "fighting", 
     " ", "after", " ", "Player", " ", "1", " ", "fights"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aF2afterF1", "[", 
     RowBox[{"U2War_", ",", "U2Cap2_", ",", "lambda_", ",", "theta2a_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U2War"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2War"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2Cap2"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta2a", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "fighting", " ", "after", " ", "Player", " ", "1", " ", "fights"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aNF2afterF1", "[", 
     RowBox[{"U2War_", ",", "U2Cap2_", ",", "lambda_", ",", "theta2a_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U2Cap2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2War"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2Cap2"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta2a", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "fighting", 
     " ", "after", " ", "Player", " ", "1", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "fight"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aF2afterNF1", "[", 
     RowBox[{"U2Cap1_", ",", "U2Nego_", ",", "lambda_", ",", "theta2b_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U2Cap1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2Cap1"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2Nego"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta2b", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "fighting", " ", "after", " ", "Player", " ", "1", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "fight"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aNF2afterNF1", "[", 
     RowBox[{"U2Cap1_", ",", "U2Nego_", ",", "lambda_", ",", "theta2b_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U2Nego"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2Cap1"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2Nego"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta2b", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9586061664955196`*^9, 3.958606203108286*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"c7b3cdef-d5f2-8247-a252-08d65932d37c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Crisis Game Probability Functions", "Subsection",
 CellChangeTimes->{{3.9586062128917217`*^9, 
  3.958606242529417*^9}},ExpressionUUID->"2de4f504-9e76-2d43-b9fd-\
983fcd6fc1fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "1", " ", 
    "fighting"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aF1", "[", 
     RowBox[{"pF2norm_", ",", "aF1afterF2_", ",", "aF1afterNF2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", "pF2norm", "]"}], "*", "aF1afterF2"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "pF2norm"}], "]"}], "*", "aF1afterNF2"}], ")"}]}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "1", " ", "fighting"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"pF1", "[", "aF1_", "]"}], ":=", 
    RowBox[{"aF1", "*", 
     RowBox[{"Conjugate", "[", "aF1", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "1", " ", 
     "not", " ", "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"aNF1", "[", 
     RowBox[{"pF2norm_", ",", "aNF1afterF2_", ",", "aNF1afterNF2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", "pF2norm", "]"}], "*", "aNF1afterF2"}], ")"}], 
     "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "pF2norm"}], "]"}], "*", "aNF1afterNF2"}], 
      ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "1", " ", "not", " ", 
     "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"pNF1", "[", "aNF1_", "]"}], ":=", 
    RowBox[{"aNF1", "*", 
     RowBox[{"Conjugate", "[", "aNF1", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "1", " ",
      "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"pF1norm", "[", 
     RowBox[{"pF1_", ",", "pNF1_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"denominator", "=", 
        RowBox[{"pF1", "+", "pNF1"}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
        RowBox[{"pF1", "/", "denominator"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "1", " ",
      "not", " ", "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"pNF1norm", "[", 
     RowBox[{"pF1_", ",", "pNF1_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"denominator", "=", 
        RowBox[{"pF1", "+", "pNF1"}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
        RowBox[{"pNF1", "/", "denominator"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "2", " ", 
     "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"aF2", "[", 
     RowBox[{"pF1norm_", ",", "aF2afterF1_", ",", "aF2afterNF1_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", "pF1norm", "]"}], "*", "aF2afterF1"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "pF1norm"}], "]"}], "*", "aF2afterNF1"}], ")"}]}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "2", " ", "fighting"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"pF2", "[", "aF2_", "]"}], ":=", 
    RowBox[{"aF2", "*", 
     RowBox[{"Conjugate", "[", "aF2", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "2", " ", 
     "not", " ", "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"aNF2", "[", 
     RowBox[{"pF1norm_", ",", "aNF2afterF1_", ",", "aNF2afterNF1_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", "pF1norm", "]"}], "*", "aNF2afterF1"}], ")"}], 
     "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "pF1norm"}], "]"}], "*", "aNF2afterNF1"}], 
      ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "2", " ", "not", " ", 
     "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"pNF2", "[", "aNF2_", "]"}], ":=", 
    RowBox[{"aNF2", "*", 
     RowBox[{"Conjugate", "[", "aNF2", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "2", " ",
      "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"pF2norm", "[", 
     RowBox[{"pF2_", ",", "pNF2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"denominator", "=", 
        RowBox[{"pF2", "+", "pNF2"}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
        RowBox[{"pF2", "/", "denominator"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "2", " ",
      "not", " ", "fighting"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"pNF2norm", "[", 
     RowBox[{"pF2_", ",", "pNF2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"denominator", "=", 
        RowBox[{"pF2", "+", "pNF2"}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
        RowBox[{"pNF2", "/", "denominator"}]}], "]"}]}], "]"}]}]}]}]], "Input",\

 CellChangeTimes->{{3.958606244579077*^9, 3.9586062589428616`*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"9fe9c20e-41f3-6540-87fa-7defc490a67e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demands Game Quantum Amplitude Functions", "Subsection",
 CellChangeTimes->{{3.9586062772151566`*^9, 
  3.9586062862682896`*^9}},ExpressionUUID->"48c7cc0d-f5ff-f949-ae09-\
71bf423713e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Player", " ", 
    RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "demanding", 
    " ", "after", " ", "Player", " ", "2", " ", "demands"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aD1afterD2", "[", 
     RowBox[{"U1Cris_", ",", "U1Acq1_", ",", "lambda_", ",", "theta3a_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U1Cris"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1Cris"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1Acq1"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta3a", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\[IndentingNewLine]",
    "\n", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "demanding", " ", "after", " ", "Player", " ", "2", " ", "demands"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aND1afterD2", "[", 
     RowBox[{"U1Cris_", ",", "U1Acq1_", ",", "lambda_", ",", "theta3a_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U1Acq1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1Cris"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1Acq1"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta3a", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\[IndentingNewLine]",
    "\n", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "demanding", 
     " ", "after", " ", "Player", " ", "2", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "demand"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aD1afterND2", "[", 
     RowBox[{"U1Acq2_", ",", "U1SQ_", ",", "lambda_", ",", "theta3b_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U1Acq2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1Acq2"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1SQ"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta3b", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\[IndentingNewLine]",
    "\n", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"1", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "demanding", " ", "after", " ", "Player", " ", "2", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "demand"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aND1afterND2", "[", 
     RowBox[{"U1Acq2_", ",", "U1SQ_", ",", "lambda_", ",", "theta3b_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U1SQ"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1Acq2"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U1SQ"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta3b", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\[IndentingNewLine]",
    "\n", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "demanding", 
     " ", "after", " ", "Player", " ", "1", " ", "demands"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aD2afterD1", "[", 
     RowBox[{"U2Cris_", ",", "U2Acq2_", ",", "lambda_", ",", "theta4a_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U2Cris"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2Cris"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2Acq2"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta4a", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\[IndentingNewLine]",
    "\n", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "demanding", " ", "after", " ", "Player", " ", "1", " ", "demands"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aND2afterD1", "[", 
     RowBox[{"U2Cris_", ",", "U2Acq2_", ",", "lambda_", ",", "theta4a_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U2Acq2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2Cris"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2Acq2"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta4a", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\[IndentingNewLine]",
    "\n", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "demanding", 
     " ", "after", " ", "Player", " ", "1", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "demand"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aD2afterND1", "[", 
     RowBox[{"U2Acq1_", ",", "U2SQ_", ",", "lambda_", ",", "theta4b_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U2Acq1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2Acq1"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2SQ"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta4b", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}], "\[IndentingNewLine]",
    "\n", 
   RowBox[{"(*", 
    RowBox[{"Player", " ", 
     RowBox[{"2", "'"}], "s", " ", "amplitude", " ", "for", " ", "not", " ", 
     "demanding", " ", "after", " ", "Player", " ", "1", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "demand"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aND2afterND1", "[", 
     RowBox[{"U2Acq1_", ",", "U2SQ_", ",", "lambda_", ",", "theta4b_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator", ",", "amplitude"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"numerator", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"lambda", "*", "U2SQ"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"denominator", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2Acq1"}], "]"}], "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"lambda", "*", "U2SQ"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amplitude", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"numerator", "/", "denominator"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", 
           RowBox[{"Re", "[", "theta4b", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "amplitude"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9586062900391235`*^9, 3.9586063136159363`*^9}},
 CellLabel->
  "In[319]:=",ExpressionUUID->"1a0745d6-b9e9-9043-80e1-4db1f4d3516f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demands Game Probability Functions", "Subsection",
 CellChangeTimes->{{3.9586063272929783`*^9, 
  3.9586063354586277`*^9}},ExpressionUUID->"9ecba0e4-c5ad-254c-9ed3-\
9ec00a9a2dfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "1", " ", 
    "demanding"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aD1", "[", 
     RowBox[{"pD2norm_", ",", "aD1afterD2_", ",", "aD1afterND2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", "pD2norm", "]"}], "*", "aD1afterD2"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "pD2norm"}], "]"}], "*", "aD1afterND2"}], ")"}]}]}],
    "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "1", " ", "demanding"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pD1", "[", "aD1_", "]"}], ":=", 
    RowBox[{"aD1", "*", 
     RowBox[{"Conjugate", "[", "aD1", "]"}]}]}], "\[IndentingNewLine]", "\n", 
   
   RowBox[{"(*", 
    RowBox[{
    "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "1", " ", 
     "not", " ", "demanding"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aND1", "[", 
     RowBox[{"pD2norm_", ",", "aND1afterD2_", ",", "aND1afterND2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", "pD2norm", "]"}], "*", "aND1afterD2"}], ")"}], 
     "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "pD2norm"}], "]"}], "*", "aND1afterND2"}], 
      ")"}]}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "1", " ", "not", " ", 
     "demanding"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pND1", "[", "aND1_", "]"}], ":=", 
    RowBox[{"aND1", "*", 
     RowBox[{"Conjugate", "[", "aND1", "]"}]}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "1", " ",
      "demanding"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pD1norm", "[", 
     RowBox[{"pD1_", ",", "pND1_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"denominator", "=", 
        RowBox[{"pD1", "+", "pND1"}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
        RowBox[{"pD1", "/", "denominator"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "1", " ",
      "not", " ", "demanding"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pND1norm", "[", 
     RowBox[{"pD1_", ",", "pND1_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"denominator", "=", 
        RowBox[{"pD1", "+", "pND1"}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
        RowBox[{"pND1", "/", "denominator"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "2", " ", 
     "demanding"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aD2", "[", 
     RowBox[{"pD1norm_", ",", "aD2afterD1_", ",", "aD2afterND1_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", "pD1norm", "]"}], "*", "aD2afterD1"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "pD1norm"}], "]"}], "*", "aD2afterND1"}], ")"}]}]}],
    "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "2", " ", "demanding"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pD2", "[", "aD2_", "]"}], ":=", 
    RowBox[{"aD2", "*", 
     RowBox[{"Conjugate", "[", "aD2", "]"}]}]}], "\[IndentingNewLine]", "\n", 
   
   RowBox[{"(*", 
    RowBox[{
    "Combined", " ", "amplitude", " ", "for", " ", "Player", " ", "2", " ", 
     "not", " ", "demanding"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aND2", "[", 
     RowBox[{"pD1norm_", ",", "aND2afterD1_", ",", "aND2afterND1_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", "pD1norm", "]"}], "*", "aND2afterD1"}], ")"}], 
     "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "pD1norm"}], "]"}], "*", "aND2afterND1"}], 
      ")"}]}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "of", " ", "Player", " ", "2", " ", "not", " ", 
     "demanding"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pND2", "[", "aND2_", "]"}], ":=", 
    RowBox[{"aND2", "*", 
     RowBox[{"Conjugate", "[", "aND2", "]"}]}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "2", " ",
      "demanding"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pD2norm", "[", 
     RowBox[{"pD2_", ",", "pND2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"denominator", "=", 
        RowBox[{"pD2", "+", "pND2"}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
        RowBox[{"pD2", "/", "denominator"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Normalized", " ", "probability", " ", "of", " ", "Player", " ", "2", " ",
      "not", " ", "demanding"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pND2norm", "[", 
     RowBox[{"pD2_", ",", "pND2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"denominator", "=", 
        RowBox[{"pD2", "+", "pND2"}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"denominator", "==", "0."}], ",", "0.5", ",", 
        RowBox[{"pND2", "/", "denominator"}]}], "]"}]}], "]"}]}]}]}]], "Input",\

 CellChangeTimes->{{3.9586063392405586`*^9, 3.958606356884859*^9}},
 CellLabel->
  "In[327]:=",ExpressionUUID->"d4072e57-9b7b-3248-96e7-bf7547943ac5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finding Equilibrium Functions", "Subsection",
 CellChangeTimes->{{3.9586063628100777`*^9, 
  3.958606371912571*^9}},ExpressionUUID->"04bab1f3-aa1b-7542-9972-\
e8c3a8d1a295"],

Cell[CellGroupData[{

Cell["FindCrisisEquilibrium", "Subsubsection",
 CellChangeTimes->{
  3.958606407865492*^9},ExpressionUUID->"bb01dd4c-6a78-e54e-bd6b-\
bc7531024478"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindCrisisEquilibrium", "[", 
   RowBox[{
   "u1War_", ",", "u1Cap1_", ",", "u1Cap2_", ",", "u1Nego_", ",", "u2War_", 
    ",", "u2Cap2_", ",", "u2Cap1_", ",", "u2Nego_", ",", "lambda_", ",", 
    "deltaTheta1_", ",", "deltaTheta2_", ",", 
    RowBox[{"maxIter_", ":", "100"}], ",", 
    RowBox[{"tolerance_", ":", 
     RowBox[{"10", "^", 
      RowBox[{"-", "6"}]}]}], ",", 
    RowBox[{"verbose_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pF1normCurrent", "=", "0.5"}], ",", 
      RowBox[{"pF2normCurrent", "=", "0.5"}], ",", "pF1normNext", ",", 
      "pF2normNext", ",", "a1F2", ",", "a1NF2", ",", "a1F1", ",", "a1NF1", 
      ",", "p1F1", ",", "p1NF1", ",", "a2F1", ",", "a2NF1", ",", "a2F2", ",", 
      "a2NF2", ",", "p2F2", ",", "p2NF2", ",", "theta1a", ",", "theta1b", ",",
       "theta2a", ",", "theta2b", ",", "pWar", ",", "pCap2", ",", "pCap1", 
      ",", "pNego", ",", 
      RowBox[{"iter", "=", "0"}], ",", 
      RowBox[{"converged", "=", "False"}], ",", 
      RowBox[{"iterationHistory", "=", 
       RowBox[{"{", "}"}]}], ",", "totalProb"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{"Set", " ", "phase", " ", "differences"}], "*)"}], 
    RowBox[{
     RowBox[{"theta1a", "=", 
      RowBox[{"deltaTheta1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"theta1b", "=", 
      RowBox[{
       RowBox[{"-", "deltaTheta1"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"theta2a", "=", 
      RowBox[{"deltaTheta2", "/", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"theta2b", "=", 
      RowBox[{
       RowBox[{"-", "deltaTheta2"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Initial", " ", "probabilities"}], "*)"}], 
     RowBox[{"pWar", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"pF1normCurrent", "*", "pF2normCurrent"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pCap2", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"pF1normCurrent", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pF2normCurrent"}], ")"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pCap1", "=", 
      RowBox[{"Re", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pF1normCurrent"}], ")"}], "*", "pF2normCurrent"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pNego", "=", 
      RowBox[{"Re", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pF1normCurrent"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pF2normCurrent"}], ")"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Iteration", " ", "logging"}], "*)"}], 
     RowBox[{"If", "[", 
      RowBox[{"verbose", ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"iterationHistory", ",", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<Iteration\>\"", "->", "0"}], ",", 
           RowBox[{"\"\<pF1\>\"", "->", 
            RowBox[{"Re", "[", "pF1normCurrent", "]"}]}], ",", 
           RowBox[{"\"\<pF2\>\"", "->", 
            RowBox[{"Re", "[", "pF2normCurrent", "]"}]}], ",", 
           RowBox[{"\"\<theta1a\>\"", "->", "theta1a"}], ",", 
           RowBox[{"\"\<theta1b\>\"", "->", "theta1b"}], ",", 
           RowBox[{"\"\<deltaTheta1\>\"", "->", "deltaTheta1"}], ",", 
           RowBox[{"\"\<theta2a\>\"", "->", "theta2a"}], ",", 
           RowBox[{"\"\<theta2b\>\"", "->", "theta2b"}], ",", 
           RowBox[{"\"\<deltaTheta2\>\"", "->", "deltaTheta2"}], ",", 
           RowBox[{"\"\<pWar\>\"", "->", 
            RowBox[{"Re", "[", "pWar", "]"}]}], ",", 
           RowBox[{"\"\<pCap2\>\"", "->", 
            RowBox[{"Re", "[", "pCap2", "]"}]}], ",", 
           RowBox[{"\"\<pCap1\>\"", "->", 
            RowBox[{"Re", "[", "pCap1", "]"}]}], ",", 
           RowBox[{"\"\<pNego\>\"", "->", 
            RowBox[{"Re", "[", "pNego", "]"}]}], ",", 
           RowBox[{"\"\<TotalProb\>\"", "->", 
            RowBox[{"pWar", "+", "pCap2", "+", "pCap1", "+", "pNego"}]}]}], 
          "|>"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"iter", "<", "maxIter"}], "&&", 
        RowBox[{"!", "converged"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{
        "Calculate", " ", "amplitudes", " ", "for", " ", "player", " ", "1"}],
         "*)"}], 
       RowBox[{
        RowBox[{"a1F2", "=", 
         RowBox[{"aF1afterF2", "[", 
          RowBox[{"u1War", ",", "u1Cap1", ",", "lambda", ",", "theta1a"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a1NF2", "=", 
         RowBox[{"aNF1afterF2", "[", 
          RowBox[{"u1War", ",", "u1Cap1", ",", "lambda", ",", "theta1a"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a1F1", "=", 
         RowBox[{"aF1", "[", 
          RowBox[{"pF2normCurrent", ",", "a1F2", ",", 
           RowBox[{"aF1afterNF2", "[", 
            RowBox[{"u1Cap2", ",", "u1Nego", ",", "lambda", ",", "theta1b"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a1NF1", "=", 
         RowBox[{"aNF1", "[", 
          RowBox[{"pF2normCurrent", ",", "a1NF2", ",", 
           RowBox[{"aNF1afterNF2", "[", 
            RowBox[{"u1Cap2", ",", "u1Nego", ",", "lambda", ",", "theta1b"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p1F1", "=", 
         RowBox[{"pF1", "[", "a1F1", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p1NF1", "=", 
         RowBox[{"pNF1", "[", "a1NF1", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pF1normNext", "=", 
         RowBox[{"pF1norm", "[", 
          RowBox[{"p1F1", ",", "p1NF1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "amplitudes", " ", "for", " ", "player", " ", 
          "2"}], "*)"}], 
        RowBox[{"a2F1", "=", 
         RowBox[{"aF2afterF1", "[", 
          RowBox[{"u2War", ",", "u2Cap2", ",", "lambda", ",", "theta2a"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a2NF1", "=", 
         RowBox[{"aNF2afterF1", "[", 
          RowBox[{"u2War", ",", "u2Cap2", ",", "lambda", ",", "theta2a"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a2F2", "=", 
         RowBox[{"aF2", "[", 
          RowBox[{"pF1normCurrent", ",", "a2F1", ",", 
           RowBox[{"aF2afterNF1", "[", 
            RowBox[{"u2Cap1", ",", "u2Nego", ",", "lambda", ",", "theta2b"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a2NF2", "=", 
         RowBox[{"aNF2", "[", 
          RowBox[{"pF1normCurrent", ",", "a2NF1", ",", 
           RowBox[{"aNF2afterNF1", "[", 
            RowBox[{"u2Cap1", ",", "u2Nego", ",", "lambda", ",", "theta2b"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p2F2", "=", 
         RowBox[{"pF2", "[", "a2F2", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p2NF2", "=", 
         RowBox[{"pNF2", "[", "a2NF2", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pF2normNext", "=", 
         RowBox[{"pF2norm", "[", 
          RowBox[{"p2F2", ",", "p2NF2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Calculate", " ", "outcome", " ", "probabilities"}], "*)"}], 
        
        RowBox[{"pWar", "=", 
         RowBox[{"Re", "[", 
          RowBox[{"pF1normCurrent", "*", "pF2normCurrent"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pCap2", "=", 
         RowBox[{"Re", "[", 
          RowBox[{"pF1normCurrent", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "pF2normCurrent"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pCap1", "=", 
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "pF1normCurrent"}], ")"}], "*", 
           "pF2normCurrent"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pNego", "=", 
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "pF1normCurrent"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "pF2normCurrent"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Check", " ", "total", " ", "probability"}], "*)"}], 
        RowBox[{"totalProb", "=", 
         RowBox[{"pWar", "+", "pCap2", "+", "pCap1", "+", "pNego"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"totalProb", "-", "1.0"}], "]"}], ">", 
           RowBox[{"10", "^", 
            RowBox[{"-", "10"}]}]}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Warning: Total probability differs from 1.0: \>\"", ",", 
            "totalProb"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Check", " ", "convergence"}], "*)"}], 
        RowBox[{"converged", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"pF1normNext", "-", "pF1normCurrent"}], "]"}], "<", 
           "tolerance"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"pF2normNext", "-", "pF2normCurrent"}], "]"}], "<", 
           "tolerance"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Track", " ", "iteration", " ", "if", " ", "verbose"}], 
         "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{"verbose", ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"iterationHistory", ",", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<Iteration\>\"", "->", "iter"}], ",", 
              RowBox[{"\"\<pF1\>\"", "->", 
               RowBox[{"Re", "[", "pF1normCurrent", "]"}]}], ",", 
              RowBox[{"\"\<pF2\>\"", "->", 
               RowBox[{"Re", "[", "pF2normCurrent", "]"}]}], ",", 
              RowBox[{"\"\<theta1a\>\"", "->", "theta1a"}], ",", 
              RowBox[{"\"\<theta1b\>\"", "->", "theta1b"}], ",", 
              RowBox[{"\"\<deltaTheta1\>\"", "->", "deltaTheta1"}], ",", 
              RowBox[{"\"\<theta2a\>\"", "->", "theta2a"}], ",", 
              RowBox[{"\"\<theta2b\>\"", "->", "theta2b"}], ",", 
              RowBox[{"\"\<deltaTheta2\>\"", "->", "deltaTheta2"}], ",", 
              RowBox[{"\"\<DeltapF1\>\"", "->", 
               RowBox[{"Abs", "[", 
                RowBox[{"pF1normNext", "-", "pF1normCurrent"}], "]"}]}], ",", 
              
              RowBox[{"\"\<DeltapF2\>\"", "->", 
               RowBox[{"Abs", "[", 
                RowBox[{"pF2normNext", "-", "pF2normCurrent"}], "]"}]}], ",", 
              
              RowBox[{"\"\<pWar\>\"", "->", "pWar"}], ",", 
              RowBox[{"\"\<pCap2\>\"", "->", "pCap2"}], ",", 
              RowBox[{"\"\<pCap1\>\"", "->", "pCap1"}], ",", 
              RowBox[{"\"\<pNego\>\"", "->", "pNego"}], ",", 
              RowBox[{"\"\<TotalProb\>\"", "->", "totalProb"}]}], "|>"}]}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Update", " ", "for", " ", "next", " ", "iteration"}], 
         "*)"}], 
        RowBox[{"pF1normCurrent", "=", 
         RowBox[{"Re", "[", "pF1normNext", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pF2normCurrent", "=", 
         RowBox[{"Re", "[", "pF2normNext", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"iter", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Return", " ", "equilibrium", " ", "probabilities", " ", "and", " ", 
       "outcomes"}], "*)"}], 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Converged\>\"", "->", "converged"}], ",", 
       RowBox[{"\"\<Iterations\>\"", "->", "iter"}], ",", 
       RowBox[{"\"\<pF1\>\"", "->", 
        RowBox[{"Re", "[", "pF1normCurrent", "]"}]}], ",", 
       RowBox[{"\"\<pF2\>\"", "->", 
        RowBox[{"Re", "[", "pF2normCurrent", "]"}]}], ",", 
       RowBox[{"\"\<pWar\>\"", "->", "pWar"}], ",", 
       RowBox[{"\"\<pCap2\>\"", "->", "pCap2"}], ",", 
       RowBox[{"\"\<pCap1\>\"", "->", "pCap1"}], ",", 
       RowBox[{"\"\<pNego\>\"", "->", "pNego"}], ",", 
       RowBox[{"\"\<TotalProb\>\"", "->", "totalProb"}], ",", 
       RowBox[{"\"\<IterationHistory\>\"", "->", 
        RowBox[{"If", "[", 
         RowBox[{"verbose", ",", "iterationHistory", ",", "Null"}], "]"}]}]}],
       "|>"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9586063850824566`*^9, 3.958606417690548*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"88fb5d8a-c990-9240-8ec4-dc327bc82514"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FindFullEquilibrium", "Subsubsection",
 CellChangeTimes->{{3.9586064248794174`*^9, 
  3.9586064381610126`*^9}},ExpressionUUID->"3053eb4a-5ce5-b74d-8777-\
4b2d4dc3a661"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "CORRECTED", " ", "FindFullEquilibrium", " ", "Function", " ", "Key", " ", 
    
    RowBox[{"fixes", ":", 
     RowBox[{
     "1.", " ", "Always", " ", "creates", " ", "DemandsIterationHistory", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"not", " ", "just", " ", "when", " ", "verbose"}], "=", 
        "True"}], ")"}], " ", "2.", " ", "Handles", " ", "case", " ", "when", 
      " ", "quantum", " ", "amplitude", " ", "functions", " ", "are", " ", 
      "undefined", " ", "3.", " ", "Better", " ", "error", " ", "handling", 
      " ", "and", " ", "fallbacks"}]}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FindFullEquilibrium", "[", 
      RowBox[{
      "u1War_", ",", "u1Cap1_", ",", "u1Cap2_", ",", "u1Nego_", ",", "u1SQ_", 
       ",", "u1Acq1_", ",", "u1Acq2_", ",", "u2War_", ",", "u2Cap2_", ",", 
       "u2Cap1_", ",", "u2Nego_", ",", "u2SQ_", ",", "u2Acq1_", ",", 
       "u2Acq2_", ",", "lambda_", ",", "deltaTheta1_", ",", "deltaTheta2_", 
       ",", "deltaTheta3_", ",", "deltaTheta4_", ",", 
       RowBox[{"maxIter_", ":", "100"}], ",", 
       RowBox[{"tolerance_", ":", 
        RowBox[{"10", "^", 
         RowBox[{"-", "6"}]}]}], ",", 
       RowBox[{"verbose_", ":", "False"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"crisisEq", ",", "u1Cris", ",", "u2Cris", ",", 
         RowBox[{"pD1normCurrent", "=", "0.5"}], ",", 
         RowBox[{"pD2normCurrent", "=", "0.5"}], ",", "pD1normNext", ",", 
         "pD2normNext", ",", "crisisPWar", ",", "crisisPCap1", ",", 
         "crisisPCap2", ",", "crisisPNego", ",", "theta3a", ",", "theta3b", 
         ",", "theta4a", ",", "theta4b", ",", "pCrisis", ",", "pAcq2", ",", 
         "pAcq1", ",", "pSQ", ",", "totalProb", ",", 
         RowBox[{"iter", "=", "0"}], ",", 
         RowBox[{"converged", "=", "False"}], ",", 
         RowBox[{"iterationHistory", "=", 
          RowBox[{"{", "}"}]}], ",", "quantumFunctionsExist"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{
        "Check", " ", "if", " ", "quantum", " ", "amplitude", " ", 
         "functions", " ", "are", " ", "defined"}], "*)"}], 
       RowBox[{
        RowBox[{"quantumFunctionsExist", "=", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"NameQ", "[", "\"\<aD1afterD2\>\"", "]"}], ",", 
           RowBox[{"NameQ", "[", "\"\<aND1afterD2\>\"", "]"}], ",", 
           RowBox[{"NameQ", "[", "\"\<aD1\>\"", "]"}], ",", 
           RowBox[{"NameQ", "[", "\"\<aND1\>\"", "]"}], ",", 
           RowBox[{"NameQ", "[", "\"\<pD1\>\"", "]"}], ",", 
           RowBox[{"NameQ", "[", "\"\<pND1\>\"", "]"}], ",", 
           RowBox[{"NameQ", "[", "\"\<pD1norm\>\"", "]"}], ",", 
           RowBox[{"NameQ", "[", "\"\<aD2afterD1\>\"", "]"}], ",", 
           RowBox[{"NameQ", "[", "\"\<aND2afterD1\>\"", "]"}], ",", 
           RowBox[{"NameQ", "[", "\"\<aD2\>\"", "]"}], ",", 
           RowBox[{"NameQ", "[", "\"\<aND2\>\"", "]"}], ",", 
           RowBox[{"NameQ", "[", "\"\<pD2\>\"", "]"}], ",", 
           RowBox[{"NameQ", "[", "\"\<pND2\>\"", "]"}], ",", 
           RowBox[{"NameQ", "[", "\"\<pD2norm\>\"", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"!", "quantumFunctionsExist"}], "&&", "verbose"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Warning: Quantum amplitude functions not defined. Using \
classical approximation.\>\"", "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Set", " ", "phase", " ", "differences", " ", "for", " ", "demands", 
          " ", "game"}], "*)"}], 
        RowBox[{"theta3a", "=", 
         RowBox[{"deltaTheta3", "/", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"theta3b", "=", 
         RowBox[{
          RowBox[{"-", "deltaTheta3"}], "/", "2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"theta4a", "=", 
         RowBox[{"deltaTheta4", "/", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"theta4b", "=", 
         RowBox[{
          RowBox[{"-", "deltaTheta4"}], "/", "2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "First", " ", "find", " ", "crisis", " ", "game", " ", 
          "equilibrium"}], "*)"}], 
        RowBox[{"crisisEq", "=", 
         RowBox[{"FindCrisisEquilibrium", "[", 
          RowBox[{
          "u1War", ",", "u1Cap1", ",", "u1Cap2", ",", "u1Nego", ",", "u2War", 
           ",", "u2Cap2", ",", "u2Cap1", ",", "u2Nego", ",", "lambda", ",", 
           "deltaTheta1", ",", "deltaTheta2", ",", "maxIter", ",", 
           "tolerance", ",", "verbose"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Check", " ", "if", " ", "crisis", " ", "game", " ", "converged"}], 
         "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"crisisEq", "[", "\"\<Converged\>\"", "]"}]}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"verbose", ",", 
             RowBox[{
             "Print", "[", "\"\<Warning: Crisis game did not converge.\>\"", 
              "]"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", "crisis", " ", "probabilities"}], "*)"}], 
        RowBox[{"crisisPWar", "=", 
         RowBox[{"crisisEq", "[", "\"\<pWar\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"crisisPCap1", "=", 
         RowBox[{"crisisEq", "[", "\"\<pCap1\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"crisisPCap2", "=", 
         RowBox[{"crisisEq", "[", "\"\<pCap2\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"crisisPNego", "=", 
         RowBox[{"crisisEq", "[", "\"\<pNego\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"verbose", ",", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Crisis equilibrium found:\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<  P(War) = \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"crisisPWar", ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<  P(Cap1) = \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"crisisPCap1", ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<  P(Cap2) = \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"crisisPCap2", ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<  P(Nego) = \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"crisisPNego", ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "expected", " ", "crisis", " ", "utilities"}], 
         "*)"}], 
        RowBox[{"u1Cris", "=", 
         RowBox[{
          RowBox[{"crisisPWar", "*", "u1War"}], "+", 
          RowBox[{"crisisPCap2", "*", "u1Cap2"}], "+", 
          RowBox[{"crisisPCap1", "*", "u1Cap1"}], "+", 
          RowBox[{"crisisPNego", "*", "u1Nego"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u2Cris", "=", 
         RowBox[{
          RowBox[{"crisisPWar", "*", "u2War"}], "+", 
          RowBox[{"crisisPCap2", "*", "u2Cap2"}], "+", 
          RowBox[{"crisisPCap1", "*", "u2Cap1"}], "+", 
          RowBox[{"crisisPNego", "*", "u2Nego"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"verbose", ",", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Expected crisis utilities:\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<  U1(Crisis) = \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"u1Cris", ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<  U2(Crisis) = \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"u2Cris", ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Initialize", " ", "demand", " ", "game", " ", "probabilities"}], 
         "*)"}], 
        RowBox[{"pCrisis", "=", 
         RowBox[{"Re", "[", 
          RowBox[{"pD1normCurrent", "*", "pD2normCurrent"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pAcq2", "=", 
         RowBox[{"Re", "[", 
          RowBox[{"pD1normCurrent", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "pD2normCurrent"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pAcq1", "=", 
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "pD1normCurrent"}], ")"}], "*", 
           "pD2normCurrent"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pSQ", "=", 
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "pD1normCurrent"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "pD2normCurrent"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"totalProb", "=", 
         RowBox[{"pCrisis", "+", "pAcq2", "+", "pAcq1", "+", "pSQ"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"ALWAYS", " ", "record", " ", "initial", " ", "state", " ", 
          RowBox[{"(", 
           RowBox[{"not", " ", "just", " ", "when", " ", "verbose"}], ")"}]}],
          "*)"}], 
        RowBox[{"AppendTo", "[", 
         RowBox[{"iterationHistory", ",", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<Iteration\>\"", "->", "0"}], ",", 
            RowBox[{"\"\<pD1\>\"", "->", 
             RowBox[{"Re", "[", "pD1normCurrent", "]"}]}], ",", 
            RowBox[{"\"\<pD2\>\"", "->", 
             RowBox[{"Re", "[", "pD2normCurrent", "]"}]}], ",", 
            RowBox[{"\"\<theta3a\>\"", "->", "theta3a"}], ",", 
            RowBox[{"\"\<theta3b\>\"", "->", "theta3b"}], ",", 
            RowBox[{"\"\<deltaTheta3\>\"", "->", "deltaTheta3"}], ",", 
            RowBox[{"\"\<theta4a\>\"", "->", "theta4a"}], ",", 
            RowBox[{"\"\<theta4b\>\"", "->", "theta4b"}], ",", 
            RowBox[{"\"\<deltaTheta4\>\"", "->", "deltaTheta4"}], ",", 
            RowBox[{"\"\<pCrisis\>\"", "->", "pCrisis"}], ",", 
            RowBox[{"\"\<pAcq2\>\"", "->", "pAcq2"}], ",", 
            RowBox[{"\"\<pAcq1\>\"", "->", "pAcq1"}], ",", 
            RowBox[{"\"\<pSQ\>\"", "->", "pSQ"}], ",", 
            RowBox[{"\"\<TotalProb\>\"", "->", "totalProb"}]}], "|>"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Demands", " ", "game", " ", "equilibrium", " ", "iteration"}], 
         "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{"quantumFunctionsExist", ",", 
          RowBox[{"(*", 
           RowBox[{
           "Use", " ", "quantum", " ", "calculations", " ", "if", " ", 
            "functions", " ", "exist"}], "*)"}], 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"iter", "<", "maxIter"}], "&&", 
             RowBox[{"!", "converged"}]}], ",", 
            RowBox[{
             RowBox[{"iter", "++"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Quantum", " ", "amplitude", " ", "calculations"}], 
              "*)"}], 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "a1D2", ",", "a1ND2", ",", "a1D1", ",", "a1ND1", ",", "p1D1", 
                 ",", "p1ND1", ",", "a2D1", ",", "a2ND1", ",", "a2D2", ",", 
                 "a2ND2", ",", "p2D2", ",", "p2ND2"}], "}"}], ",", 
               RowBox[{"(*", 
                RowBox[{"Player", " ", "1", " ", "amplitudes"}], "*)"}], 
               RowBox[{
                RowBox[{"a1D2", "=", 
                 RowBox[{"aD1afterD2", "[", 
                  RowBox[{
                  "u1Cris", ",", "u1Acq1", ",", "lambda", ",", "theta3a"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"a1ND2", "=", 
                 RowBox[{"aND1afterD2", "[", 
                  RowBox[{
                  "u1Cris", ",", "u1Acq1", ",", "lambda", ",", "theta3a"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"a1D1", "=", 
                 RowBox[{"aD1", "[", 
                  RowBox[{"pD2normCurrent", ",", "a1D2", ",", 
                   RowBox[{"aD1afterND2", "[", 
                    RowBox[{
                    "u1Acq2", ",", "u1SQ", ",", "lambda", ",", "theta3b"}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"a1ND1", "=", 
                 RowBox[{"aND1", "[", 
                  RowBox[{"pD2normCurrent", ",", "a1ND2", ",", 
                   RowBox[{"aND1afterND2", "[", 
                    RowBox[{
                    "u1Acq2", ",", "u1SQ", ",", "lambda", ",", "theta3b"}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"p1D1", "=", 
                 RowBox[{"pD1", "[", "a1D1", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"p1ND1", "=", 
                 RowBox[{"pND1", "[", "a1ND1", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pD1normNext", "=", 
                 RowBox[{"pD1norm", "[", 
                  RowBox[{"p1D1", ",", "p1ND1"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Player", " ", "2", " ", "amplitudes"}], "*)"}], 
                RowBox[{"a2D1", "=", 
                 RowBox[{"aD2afterD1", "[", 
                  RowBox[{
                  "u2Cris", ",", "u2Acq2", ",", "lambda", ",", "theta4a"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"a2ND1", "=", 
                 RowBox[{"aND2afterD1", "[", 
                  RowBox[{
                  "u2Cris", ",", "u2Acq2", ",", "lambda", ",", "theta4a"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"a2D2", "=", 
                 RowBox[{"aD2", "[", 
                  RowBox[{"pD1normCurrent", ",", "a2D1", ",", 
                   RowBox[{"aD2afterND1", "[", 
                    RowBox[{
                    "u2Acq1", ",", "u2SQ", ",", "lambda", ",", "theta4b"}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"a2ND2", "=", 
                 RowBox[{"aND2", "[", 
                  RowBox[{"pD1normCurrent", ",", "a2ND1", ",", 
                   RowBox[{"aND2afterND1", "[", 
                    RowBox[{
                    "u2Acq1", ",", "u2SQ", ",", "lambda", ",", "theta4b"}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"p2D2", "=", 
                 RowBox[{"pD2", "[", "a2D2", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"p2ND2", "=", 
                 RowBox[{"pND2", "[", "a2ND2", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pD2normNext", "=", 
                 RowBox[{"pD2norm", "[", 
                  RowBox[{"p2D2", ",", "p2ND2"}], "]"}]}], ";"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Update", " ", "probabilities"}], "*)"}], 
             RowBox[{"pCrisis", "=", 
              RowBox[{"Re", "[", 
               RowBox[{"pD1normNext", "*", "pD2normNext"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pAcq2", "=", 
              RowBox[{"Re", "[", 
               RowBox[{"pD1normNext", "*", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "pD2normNext"}], ")"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pAcq1", "=", 
              RowBox[{"Re", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "pD1normNext"}], ")"}], "*", 
                "pD2normNext"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"pSQ", "=", 
              RowBox[{"Re", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "pD1normNext"}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "pD2normNext"}], ")"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"totalProb", "=", 
              RowBox[{"pCrisis", "+", "pAcq2", "+", "pAcq1", "+", "pSQ"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Check", " ", "convergence"}], "*)"}], 
             RowBox[{"converged", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"pD1normNext", "-", "pD1normCurrent"}], "]"}], "<", 
                "tolerance"}], "&&", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"pD2normNext", "-", "pD2normCurrent"}], "]"}], "<", 
                "tolerance"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"ALWAYS", " ", "track", " ", "iteration"}], "*)"}], 
             RowBox[{"AppendTo", "[", 
              RowBox[{"iterationHistory", ",", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"\"\<Iteration\>\"", "->", "iter"}], ",", 
                 RowBox[{"\"\<pD1\>\"", "->", 
                  RowBox[{"Re", "[", "pD1normNext", "]"}]}], ",", 
                 RowBox[{"\"\<pD2\>\"", "->", 
                  RowBox[{"Re", "[", "pD2normNext", "]"}]}], ",", 
                 RowBox[{"\"\<theta3a\>\"", "->", "theta3a"}], ",", 
                 RowBox[{"\"\<theta3b\>\"", "->", "theta3b"}], ",", 
                 RowBox[{"\"\<deltaTheta3\>\"", "->", "deltaTheta3"}], ",", 
                 RowBox[{"\"\<theta4a\>\"", "->", "theta4a"}], ",", 
                 RowBox[{"\"\<theta4b\>\"", "->", "theta4b"}], ",", 
                 RowBox[{"\"\<deltaTheta4\>\"", "->", "deltaTheta4"}], ",", 
                 RowBox[{"\"\<DeltapD1\>\"", "->", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"pD1normNext", "-", "pD1normCurrent"}], "]"}]}], 
                 ",", 
                 RowBox[{"\"\<DeltapD2\>\"", "->", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"pD2normNext", "-", "pD2normCurrent"}], "]"}]}], 
                 ",", 
                 RowBox[{"\"\<pCrisis\>\"", "->", "pCrisis"}], ",", 
                 RowBox[{"\"\<pAcq2\>\"", "->", "pAcq2"}], ",", 
                 RowBox[{"\"\<pAcq1\>\"", "->", "pAcq1"}], ",", 
                 RowBox[{"\"\<pSQ\>\"", "->", "pSQ"}], ",", 
                 RowBox[{"\"\<TotalProb\>\"", "->", "totalProb"}]}], "|>"}]}],
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Update", " ", "for", " ", "next", " ", "iteration"}], 
              "*)"}], 
             RowBox[{"pD1normCurrent", "=", 
              RowBox[{"Re", "[", "pD1normNext", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pD2normCurrent", "=", 
              RowBox[{"Re", "[", "pD2normNext", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"verbose", ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Iteration \>\"", ",", "iter", ",", "\"\<: pD1=\>\"", 
                  ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"pD1normCurrent", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  "\"\<, pD2=\>\"", ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"pD2normCurrent", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";"}]}],
               "]"}], ";"}]}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"Fallback", ":", 
            RowBox[{
            "Use", " ", "classical", " ", "quantal", " ", "response", " ", 
             "if", " ", "quantum", " ", "functions", " ", 
             RowBox[{"don", "'"}], "t", " ", "exist"}]}], "*)"}], 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"iter", "<", "maxIter"}], "&&", 
             RowBox[{"!", "converged"}]}], ",", 
            RowBox[{
             RowBox[{"iter", "++"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Classical", " ", "quantal", " ", "response", " ", 
               "calculations"}], "*)"}], 
             RowBox[{"pD1normNext", "=", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"lambda", "*", "u1Cris"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"lambda", "*", "u1Cris"}], "]"}], "+", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"lambda", "*", "u1Acq1"}], "]"}]}], ")"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pD2normNext", "=", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"lambda", "*", "u2Cris"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"lambda", "*", "u2Cris"}], "]"}], "+", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"lambda", "*", "u2Acq2"}], "]"}]}], ")"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Update", " ", "probabilities"}], "*)"}], 
             RowBox[{"pCrisis", "=", 
              RowBox[{"Re", "[", 
               RowBox[{"pD1normNext", "*", "pD2normNext"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pAcq2", "=", 
              RowBox[{"Re", "[", 
               RowBox[{"pD1normNext", "*", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "pD2normNext"}], ")"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pAcq1", "=", 
              RowBox[{"Re", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "pD1normNext"}], ")"}], "*", 
                "pD2normNext"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"pSQ", "=", 
              RowBox[{"Re", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "pD1normNext"}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "pD2normNext"}], ")"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"totalProb", "=", 
              RowBox[{"pCrisis", "+", "pAcq2", "+", "pAcq1", "+", "pSQ"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Check", " ", "convergence"}], "*)"}], 
             RowBox[{"converged", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"pD1normNext", "-", "pD1normCurrent"}], "]"}], "<", 
                "tolerance"}], "&&", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"pD2normNext", "-", "pD2normCurrent"}], "]"}], "<", 
                "tolerance"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"ALWAYS", " ", "track", " ", "iteration"}], "*)"}], 
             RowBox[{"AppendTo", "[", 
              RowBox[{"iterationHistory", ",", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"\"\<Iteration\>\"", "->", "iter"}], ",", 
                 RowBox[{"\"\<pD1\>\"", "->", 
                  RowBox[{"Re", "[", "pD1normNext", "]"}]}], ",", 
                 RowBox[{"\"\<pD2\>\"", "->", 
                  RowBox[{"Re", "[", "pD2normNext", "]"}]}], ",", 
                 RowBox[{"\"\<theta3a\>\"", "->", "theta3a"}], ",", 
                 RowBox[{"\"\<theta3b\>\"", "->", "theta3b"}], ",", 
                 RowBox[{"\"\<deltaTheta3\>\"", "->", "deltaTheta3"}], ",", 
                 RowBox[{"\"\<theta4a\>\"", "->", "theta4a"}], ",", 
                 RowBox[{"\"\<theta4b\>\"", "->", "theta4b"}], ",", 
                 RowBox[{"\"\<deltaTheta4\>\"", "->", "deltaTheta4"}], ",", 
                 RowBox[{"\"\<DeltapD1\>\"", "->", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"pD1normNext", "-", "pD1normCurrent"}], "]"}]}], 
                 ",", 
                 RowBox[{"\"\<DeltapD2\>\"", "->", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"pD2normNext", "-", "pD2normCurrent"}], "]"}]}], 
                 ",", 
                 RowBox[{"\"\<pCrisis\>\"", "->", "pCrisis"}], ",", 
                 RowBox[{"\"\<pAcq2\>\"", "->", "pAcq2"}], ",", 
                 RowBox[{"\"\<pAcq1\>\"", "->", "pAcq1"}], ",", 
                 RowBox[{"\"\<pSQ\>\"", "->", "pSQ"}], ",", 
                 RowBox[{"\"\<TotalProb\>\"", "->", "totalProb"}]}], "|>"}]}],
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Update", " ", "for", " ", "next", " ", "iteration"}], 
              "*)"}], 
             RowBox[{"pD1normCurrent", "=", 
              RowBox[{"Re", "[", "pD1normNext", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pD2normCurrent", "=", 
              RowBox[{"Re", "[", "pD2normNext", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"verbose", ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Iteration \>\"", ",", "iter", ",", 
                  "\"\< (classical): pD1=\>\"", ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"pD1normCurrent", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  "\"\<, pD2=\>\"", ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"pD2normCurrent", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";"}]}],
               "]"}], ";"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"verbose", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"converged", ",", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Demands game converged after \>\"", ",", "iter", ",", 
               "\"\< iterations.\>\""}], "]"}], ",", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Demands game did not converge after \>\"", ",", "maxIter", 
               ",", "\"\< iterations.\>\""}], "]"}]}], "]"}], ";"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Return", " ", "results"}], "-", 
          RowBox[{
          "ALWAYS", " ", "include", " ", "DemandsIterationHistory"}]}], 
         "*)"}], 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<CrisisEquilibrium\>\"", "->", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pWar\>\"", "->", "crisisPWar"}], ",", 
             RowBox[{"\"\<pCap1\>\"", "->", "crisisPCap1"}], ",", 
             RowBox[{"\"\<pCap2\>\"", "->", "crisisPCap2"}], ",", 
             RowBox[{"\"\<pNego\>\"", "->", "crisisPNego"}], ",", 
             RowBox[{"\"\<pF1\>\"", "->", 
              RowBox[{"crisisEq", "[", "\"\<pF1\>\"", "]"}]}], ",", 
             RowBox[{"\"\<pF2\>\"", "->", 
              RowBox[{"crisisEq", "[", "\"\<pF2\>\"", "]"}]}], ",", 
             RowBox[{"\"\<Converged\>\"", "->", 
              RowBox[{"crisisEq", "[", "\"\<Converged\>\"", "]"}]}], ",", 
             RowBox[{"\"\<Iterations\>\"", "->", 
              RowBox[{"crisisEq", "[", "\"\<Iterations\>\"", "]"}]}], ",", 
             RowBox[{"\"\<TotalProb\>\"", "->", 
              RowBox[{"crisisEq", "[", "\"\<TotalProb\>\"", "]"}]}]}], 
            "|>"}]}], ",", 
          RowBox[{"\"\<DemandsConverged\>\"", "->", "converged"}], ",", 
          RowBox[{"\"\<DemandsIterations\>\"", "->", "iter"}], ",", 
          RowBox[{"\"\<pD1\>\"", "->", 
           RowBox[{"Re", "[", "pD1normCurrent", "]"}]}], ",", 
          RowBox[{"\"\<pD2\>\"", "->", 
           RowBox[{"Re", "[", "pD2normCurrent", "]"}]}], ",", 
          RowBox[{"\"\<pCrisis\>\"", "->", "pCrisis"}], ",", 
          RowBox[{"\"\<pAcq2\>\"", "->", "pAcq2"}], ",", 
          RowBox[{"\"\<pAcq1\>\"", "->", "pAcq1"}], ",", 
          RowBox[{"\"\<pSQ\>\"", "->", "pSQ"}], ",", 
          RowBox[{"\"\<TotalProb\>\"", "->", "totalProb"}], ",", 
          RowBox[{"\"\<ExpectedUtility1\>\"", "->", 
           RowBox[{
            RowBox[{"pCrisis", "*", "u1Cris"}], "+", 
            RowBox[{"pAcq2", "*", "u1Acq2"}], "+", 
            RowBox[{"pAcq1", "*", "u1Acq1"}], "+", 
            RowBox[{"pSQ", "*", "u1SQ"}]}]}], ",", 
          RowBox[{"\"\<ExpectedUtility2\>\"", "->", 
           RowBox[{
            RowBox[{"pCrisis", "*", "u2Cris"}], "+", 
            RowBox[{"pAcq2", "*", "u2Acq2"}], "+", 
            RowBox[{"pAcq1", "*", "u2Acq1"}], "+", 
            RowBox[{"pSQ", "*", "u2SQ"}]}]}], ",", 
          RowBox[{
          "\"\<DemandsIterationHistory\>\"", "->", "iterationHistory"}]}], 
         "  ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"ALWAYS", " ", "included"}], ",", 
           RowBox[{"never", " ", "Null"}]}], "*)"}], "|>"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Diagnostic", " ", "function", " ", "to", " ", "check", " ", 
     RowBox[{"what", "'"}], "s", " ", "missing"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DiagnoseQuantumFunctions", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "missingFunctions", "}"}], ",", 
       RowBox[{
        RowBox[{"missingFunctions", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"NameQ", "[", "funcName", "]"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"missingFunctions", ",", "funcName"}], "]"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"funcName", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<aD1afterD2\>\"", ",", "\"\<aND1afterD2\>\"", ",", 
              "\"\<aD1afterND2\>\"", ",", "\"\<aND1afterND2\>\"", ",", 
              "\"\<aD1\>\"", ",", "\"\<aND1\>\"", ",", "\"\<pD1\>\"", ",", 
              "\"\<pND1\>\"", ",", "\"\<pD1norm\>\"", ",", 
              "\"\<aD2afterD1\>\"", ",", "\"\<aND2afterD1\>\"", ",", 
              "\"\<aD2afterND1\>\"", ",", "\"\<aND2afterND1\>\"", ",", 
              "\"\<aD2\>\"", ",", "\"\<aND2\>\"", ",", "\"\<pD2\>\"", ",", 
              "\"\<pND2\>\"", ",", "\"\<pD2norm\>\""}], "}"}]}], "}"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "missingFunctions", "]"}], ">", "0"}], ",", 
          
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Missing quantum functions: \>\"", ",", "missingFunctions"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<The function will use classical quantal response \
instead.\>\"", "]"}], ";"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<All quantum functions are defined.\>\"", "]"}], 
           ";"}]}], "]"}], ";", "\[IndentingNewLine]", "missingFunctions"}]}],
       "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.958606585005001*^9, 3.958606587971197*^9}, {
  3.9586122302499714`*^9, 3.9586122784475822`*^9}, {3.9586132192169952`*^9, 
  3.958613226944807*^9}, {3.9586136700919685`*^9, 3.9586136707137165`*^9}},
 CellLabel->
  "In[340]:=",ExpressionUUID->"c1d6ac1c-3bde-8240-b294-49c7b25fe983"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Aux Functions", "Subsection",
 CellChangeTimes->{{3.958606734948591*^9, 
  3.9586067370989265`*^9}},ExpressionUUID->"74d0f729-c7f3-f843-9c9d-\
644467e5452a"],

Cell[CellGroupData[{

Cell["loadData", "Subsubsection",
 CellChangeTimes->{{3.9586066844748344`*^9, 
  3.9586066855851707`*^9}},ExpressionUUID->"27cd460e-5baa-0341-a680-\
730de66d38a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"loadData", "[", "filename_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rawData", ",", "headers", ",", "dataRows", ",", "groundtruth", ",", 
      "utilityData", ",", "cleanedData", ",", "requiredColumns", ",", 
      "missingColumns"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Loading CSV file: \>\"", ",", "filename"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rawData", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"filename", ",", "\"\<CSV\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "rawData", "]"}], "=!=", "List"}], "||", 
        RowBox[{
         RowBox[{"Length", "[", "rawData", "]"}], "<", "2"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<Error: Could not load CSV file or file is empty\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"headers", "=", 
      RowBox[{"First", "[", "rawData", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dataRows", "=", 
      RowBox[{"Rest", "[", "rawData", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Loaded \>\"", ",", 
       RowBox[{"Length", "[", "dataRows", "]"}], ",", "\"\< rows with \>\"", 
       ",", 
       RowBox[{"Length", "[", "headers", "]"}], ",", "\"\< columns\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"cleanedData", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"row", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"cell", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"NumericQ", "[", "cell", "]"}], ",", "cell", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"StringQ", "[", "cell", "]"}], "&&", 
                   RowBox[{"StringMatchQ", "[", 
                    RowBox[{"cell", ",", "NumberString"}], "]"}]}], ",", 
                  RowBox[{"ToExpression", "[", "cell", "]"}], ",", "cell"}], 
                 "]"}]}], "]"}]}], "]"}], ",", "row"}], "]"}]}], "]"}], ",", 
        "dataRows"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"groundtruth", "=", 
      RowBox[{"cleanedData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"utilityData", "=", 
      RowBox[{"Association", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"headers", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "->", 
          RowBox[{"cleanedData", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "headers", "]"}]}], "}"}]}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"requiredColumns", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<wrTu1wr2\>\"", ",", "\"\<wrTu1cp1\>\"", ",", "\"\<wrTu1cp2\>\"", 
        ",", "\"\<wrTu1wr1\>\"", ",", "\"\<wrTu1neg\>\"", ",", 
        "\"\<wrTu1ac1\>\"", ",", "\"\<wrTu1ac2\>\"", ",", "\"\<wrTu1sq\>\"", 
        ",", "\"\<wrTu2wr2\>\"", ",", "\"\<wrTu2cp1\>\"", ",", 
        "\"\<wrTu2wr1\>\"", ",", "\"\<wrTu2cp2\>\"", ",", "\"\<wrTu2neg\>\"", 
        ",", "\"\<wrTu2ac1\>\"", ",", "\"\<wrTu2ac2\>\"", ",", 
        "\"\<wrTu2sq\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"missingColumns", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"requiredColumns", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"utilityData", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "missingColumns", "]"}], ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Warning: Missing required columns: \>\"", ",", 
         "missingColumns"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<groundtruth\>\"", "->", "groundtruth"}], ",", 
       RowBox[{"\"\<data\>\"", "->", "utilityData"}], ",", 
       RowBox[{"\"\<nrows\>\"", "->", 
        RowBox[{"Length", "[", "cleanedData", "]"}]}], ",", 
       RowBox[{"\"\<headers\>\"", "->", "headers"}], ",", 
       RowBox[{"\"\<filename\>\"", "->", "filename"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9586066451257324`*^9, 3.9586066636262074`*^9}},
 CellLabel->
  "In[342]:=",ExpressionUUID->"af3664f0-f061-7e43-a022-38a4d53807db"]
}, Open  ]],

Cell[CellGroupData[{

Cell["extractUtilities", "Subsubsection",
 CellChangeTimes->{
  3.958606752175997*^9},ExpressionUUID->"572af27b-023d-5c48-8e10-\
30f7c06d5062"],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractUtilities", "[", 
   RowBox[{"data_", ",", "rowIndex_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"row", ",", "utils"}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rowIndex", "<", "1"}], "||", 
        RowBox[{"rowIndex", ">", 
         RowBox[{"data", "[", "\"\<nrows\>\"", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Error: Row index \>\"", ",", "rowIndex", ",", 
          "\"\< out of range [1, \>\"", ",", 
          RowBox[{"data", "[", "\"\<nrows\>\"", "]"}], ",", "\"\<]\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"row", "=", 
      RowBox[{"data", "[", "\"\<data\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"utils", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Player", " ", "1", " ", "utilities"}], "*)"}], 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U1War2\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu1wr2\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu1wr2\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu1wr2\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U1Cap1\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu1cp1\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu1cp1\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu1cp1\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U1Cap2\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu1cp2\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu1cp2\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu1cp2\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U1War1\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu1wr1\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu1wr1\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu1wr1\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U1Nego\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu1neg\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu1neg\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu1neg\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U1Acq1\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu1ac1\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu1ac1\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu1ac1\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U1Acq2\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu1ac2\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu1ac2\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu1ac2\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U1SQ\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu1sq\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu1sq\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu1sq\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Player", " ", "2", " ", "utilities"}], "*)"}], 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U2War2\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu2wr2\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu2wr2\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu2wr2\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U2Cap1\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu2cp1\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu2cp1\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu2cp1\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U2War1\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu2wr1\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu2wr1\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu2wr1\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U2Cap2\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu2cp2\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu2cp2\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu2cp2\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U2Nego\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu2neg\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu2neg\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu2neg\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U2Acq1\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu2ac1\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu2ac1\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu2ac1\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U2Acq2\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu2ac2\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu2ac2\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu2ac2\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<U2SQ\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<wrTu2sq\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<wrTu2sq\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<wrTu2sq\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<Agent1\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"row", ",", "\"\<ISOShNm1\>\""}], "]"}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<ISOShNm1\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "\"\<Unknown\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<Agent2\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"row", ",", "\"\<ISOShNm2\>\""}], "]"}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<ISOShNm2\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "\"\<Unknown\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Additional", " ", "information"}], "*)"}], 
     RowBox[{
      RowBox[{"utils", "[", "\"\<groundtruth\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"data", "[", "\"\<groundtruth\>\"", "]"}], "[", 
       RowBox[{"[", "rowIndex", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<ccode1\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<ccode1\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<ccode1\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<ccode1\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<ccode2\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<ccode2\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<ccode2\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<ccode2\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"utils", "[", "\"\<year\>\"", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"row", ",", "\"\<year\>\""}], "]"}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{
           RowBox[{"row", "[", "\"\<year\>\"", "]"}], "[", 
           RowBox[{"[", "rowIndex", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"row", "[", "\"\<year\>\"", "]"}], "[", 
         RowBox[{"[", "rowIndex", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "utils"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.958606763744793*^9, 3.9586067653731785`*^9}, {
   3.958607502097191*^9, 3.958607540840637*^9}, 3.958608049733818*^9},
 CellLabel->
  "In[343]:=",ExpressionUUID->"b2853312-e248-0b4d-ad5b-b092892c28aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["calculateQuantumNormalFormOutcome", "Subsubsection",
 CellChangeTimes->{
  3.958606799578211*^9},ExpressionUUID->"df7bb380-6330-7849-8649-\
fdfd7fecde2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"calculateQuantumNormalFormOutcome", "[", 
   RowBox[{"data_", ",", "rowIndex_Integer", ",", 
    RowBox[{"deltaTheta1_", ":", "0"}], ",", 
    RowBox[{"deltaTheta2_", ":", "0"}], ",", 
    RowBox[{"deltaTheta3_", ":", "0"}], ",", 
    RowBox[{"deltaTheta4_", ":", "0"}], ",", 
    RowBox[{"l1_", ":", "1"}], ",", 
    RowBox[{"l2_", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "utils", ",", "result", ",", "outcomes", ",", "sqProb", ",", "acq1Prob", 
      ",", "acq2Prob", ",", "negoProb", ",", "cap1Prob", ",", "cap2Prob", ",",
       "war1Prob", ",", "prediction", ",", "roundedProbs", ",", 
      "outcomeProbs", ",", "maxVal", ",", "maxOutcomes", ",", "u1War", ",", 
      "u2War"}], "}"}], ",", 
    RowBox[{
     RowBox[{"utils", "=", 
      RowBox[{"extractUtilities", "[", 
       RowBox[{"data", ",", "rowIndex"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"utils", "===", "$Failed"}], ",", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Calculate", " ", "average", " ", "war", " ", "utilities"}], 
      "*)"}], 
     RowBox[{"u1War", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"utils", "[", "\"\<U1War1\>\"", "]"}], "+", 
         RowBox[{"utils", "[", "\"\<U1War2\>\"", "]"}]}], ")"}], "/", "2"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"u2War", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"utils", "[", "\"\<U2War1\>\"", "]"}], "+", 
         RowBox[{"utils", "[", "\"\<U2War2\>\"", "]"}]}], ")"}], "/", "2"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Run", " ", "the", " ", "full", " ", "equilibrium", " ", "calculation", 
       " ", "with", " ", "ALL", " ", "4", " ", "phase", " ", "parameters"}], 
      "*)"}], 
     RowBox[{"result", "=", 
      RowBox[{"Quiet", "[", 
       RowBox[{"FindFullEquilibrium", "[", 
        RowBox[{"u1War", ",", 
         RowBox[{"utils", "[", "\"\<U1Cap1\>\"", "]"}], ",", 
         RowBox[{"utils", "[", "\"\<U1Cap2\>\"", "]"}], ",", 
         RowBox[{"utils", "[", "\"\<U1Nego\>\"", "]"}], ",", 
         RowBox[{"utils", "[", "\"\<U1SQ\>\"", "]"}], ",", 
         RowBox[{"utils", "[", "\"\<U1Acq1\>\"", "]"}], ",", 
         RowBox[{"utils", "[", "\"\<U1Acq2\>\"", "]"}], ",", "u2War", ",", 
         RowBox[{"utils", "[", "\"\<U2Cap2\>\"", "]"}], ",", 
         RowBox[{"utils", "[", "\"\<U2Cap1\>\"", "]"}], ",", 
         RowBox[{"utils", "[", "\"\<U2Nego\>\"", "]"}], ",", 
         RowBox[{"utils", "[", "\"\<U2SQ\>\"", "]"}], ",", 
         RowBox[{"utils", "[", "\"\<U2Acq1\>\"", "]"}], ",", 
         RowBox[{"utils", "[", "\"\<U2Acq2\>\"", "]"}], ",", "l1", ",", 
         "deltaTheta1", ",", "deltaTheta2", ",", "deltaTheta3", ",", 
         "deltaTheta4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"result", "===", "$Failed"}], ",", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Extract", " ", "outcome", " ", "probabilities"}], "*)"}], 
     RowBox[{"sqProb", "=", 
      RowBox[{"result", "[", "\"\<pSQ\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"acq1Prob", "=", 
      RowBox[{"result", "[", "\"\<pAcq1\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"acq2Prob", "=", 
      RowBox[{"result", "[", "\"\<pAcq2\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"negoProb", "=", 
      RowBox[{
       RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}], "*", 
       RowBox[{
        RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}], "[", 
        "\"\<pNego\>\"", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cap1Prob", "=", 
      RowBox[{
       RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}], "*", 
       RowBox[{
        RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}], "[", 
        "\"\<pCap1\>\"", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cap2Prob", "=", 
      RowBox[{
       RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}], "*", 
       RowBox[{
        RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}], "[", 
        "\"\<pCap2\>\"", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"war1Prob", "=", 
      RowBox[{
       RowBox[{"result", "[", "\"\<pCrisis\>\"", "]"}], "*", 
       RowBox[{
        RowBox[{"result", "[", "\"\<CrisisEquilibrium\>\"", "]"}], "[", 
        "\"\<pWar\>\"", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Create", " ", "outcome", " ", "probabilities", " ", "association"}], 
      "*)"}], 
     RowBox[{"outcomeProbs", "=", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<SQ\>\"", "->", "sqProb"}], ",", 
        RowBox[{"\"\<ACQ1\>\"", "->", "acq1Prob"}], ",", 
        RowBox[{"\"\<ACQ2\>\"", "->", "acq2Prob"}], ",", 
        RowBox[{"\"\<NEGO\>\"", "->", "negoProb"}], ",", 
        RowBox[{"\"\<CAP1\>\"", "->", "cap1Prob"}], ",", 
        RowBox[{"\"\<CAP2\>\"", "->", "cap2Prob"}], ",", 
        RowBox[{"\"\<WAR1\>\"", "->", "war1Prob"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Round", " ", "probabilities", " ", "for", " ", "comparison"}], 
      "*)"}], 
     RowBox[{"roundedProbs", "=", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "->", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"outcomeProbs", "[", "#", "]"}], ",", "0.0001"}], "]"}]}],
          "&"}], "/@", 
        RowBox[{"Keys", "[", "outcomeProbs", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxVal", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Values", "[", "roundedProbs", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxOutcomes", "=", 
      RowBox[{"Keys", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"roundedProbs", ",", 
         RowBox[{
          RowBox[{"#", "==", "maxVal"}], "&"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prediction", "=", 
      RowBox[{"RandomChoice", "[", "maxOutcomes", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<SQ\>\"", "->", "sqProb"}], ",", 
       RowBox[{"\"\<ACQ1\>\"", "->", "acq1Prob"}], ",", 
       RowBox[{"\"\<ACQ2\>\"", "->", "acq2Prob"}], ",", 
       RowBox[{"\"\<NEGO\>\"", "->", "negoProb"}], ",", 
       RowBox[{"\"\<CAP1\>\"", "->", "cap1Prob"}], ",", 
       RowBox[{"\"\<CAP2\>\"", "->", "cap2Prob"}], ",", 
       RowBox[{"\"\<WAR1\>\"", "->", "war1Prob"}], ",", 
       RowBox[{"\"\<prediction\>\"", "->", "prediction"}], ",", 
       RowBox[{"\"\<groundtruth\>\"", "->", 
        RowBox[{"utils", "[", "\"\<groundtruth\>\"", "]"}]}], ",", 
       RowBox[{"\"\<utilities\>\"", "->", "utils"}], ",", 
       RowBox[{"\"\<deltaTheta1\>\"", "->", "deltaTheta1"}], ",", 
       RowBox[{"\"\<deltaTheta2\>\"", "->", "deltaTheta2"}], ",", 
       RowBox[{"\"\<deltaTheta3\>\"", "->", "deltaTheta3"}], ",", 
       RowBox[{"\"\<deltaTheta4\>\"", "->", "deltaTheta4"}], ",", 
       RowBox[{"\"\<l1\>\"", "->", "l1"}], ",", 
       RowBox[{"\"\<l2\>\"", "->", "l2"}], ",", 
       RowBox[{"\"\<total\>\"", "->", 
        RowBox[{
        "sqProb", "+", "acq1Prob", "+", "acq2Prob", "+", "negoProb", "+", 
         "cap1Prob", "+", "cap2Prob", "+", "war1Prob"}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9586068085963*^9, 3.958606810040619*^9}, {
   3.9586075875389614`*^9, 3.9586076481705475`*^9}, {3.9586077176526585`*^9, 
   3.958607718890682*^9}, 3.958608067749975*^9},
 CellLabel->
  "In[344]:=",ExpressionUUID->"5272f95b-1446-2c41-8078-61534893bdee"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimization Functions", "Subsection",
 CellChangeTimes->{{3.9586068509185314`*^9, 
  3.9586068573184357`*^9}},ExpressionUUID->"e0169ed6-e414-c34b-8f25-\
7354d9f57c83"],

Cell[CellGroupData[{

Cell["gridSearchQuantumNormalFormThetas", "Subsubsection",
 CellChangeTimes->{
  3.9586068880577927`*^9},ExpressionUUID->"ba973cc2-cccd-b74e-ac3c-\
ae8f86179338"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gridSearchQuantumNormalFormThetas", "[", 
   RowBox[{
   "data_", ",", "deltaTheta1Range_List", ",", "deltaTheta2Range_List", ",", 
    "deltaTheta3Range_List", ",", "deltaTheta4Range_List", ",", 
    RowBox[{"l1_", ":", "1"}], ",", 
    RowBox[{"l2_", ":", "1"}], ",", 
    RowBox[{"verbose_", ":", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "results", ",", "bestAccuracy", ",", "bestDeltaTheta1", ",", 
      "bestDeltaTheta2", ",", "bestDeltaTheta3", ",", "bestDeltaTheta4", ",", 
      "totalCombinations", ",", "currentCombination", ",", "startTime", ",", 
      "gridResults", ",", "deltaTheta1Values", ",", "deltaTheta2Values", ",", 
      "deltaTheta3Values", ",", "deltaTheta4Values"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"data", "===", "$Failed"}], "||", 
        RowBox[{"!", 
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"data", ",", "\"\<nrows\>\""}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Error: Invalid data provided\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"deltaTheta1Values", "=", "deltaTheta1Range"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"deltaTheta2Values", "=", "deltaTheta2Range"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"deltaTheta3Values", "=", "deltaTheta3Range"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"deltaTheta4Values", "=", "deltaTheta4Range"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"totalCombinations", "=", 
      RowBox[{
       RowBox[{"Length", "[", "deltaTheta1Values", "]"}], "*", 
       RowBox[{"Length", "[", "deltaTheta2Values", "]"}], "*", 
       RowBox[{"Length", "[", "deltaTheta3Values", "]"}], "*", 
       RowBox[{"Length", "[", "deltaTheta4Values", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"currentCombination", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"bestAccuracy", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"bestDeltaTheta1", "=", 
      RowBox[{"First", "[", "deltaTheta1Values", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bestDeltaTheta2", "=", 
      RowBox[{"First", "[", "deltaTheta2Values", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bestDeltaTheta3", "=", 
      RowBox[{"First", "[", "deltaTheta3Values", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bestDeltaTheta4", "=", 
      RowBox[{"First", "[", "deltaTheta4Values", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"verbose", ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Starting 4-parameter grid search over \>\"", ",", 
          "totalCombinations", ",", "\"\< parameter combinations...\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<\[CapitalDelta]\[CapitalTheta]1 range (fight/not fight Player \
1): \>\"", ",", "deltaTheta1Values"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<\[CapitalDelta]\[CapitalTheta]2 range (fight/not fight Player \
2): \>\"", ",", "deltaTheta2Values"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<\[CapitalDelta]\[CapitalTheta]3 range (demand/not demand Player \
1): \>\"", ",", "deltaTheta3Values"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<\[CapitalDelta]\[CapitalTheta]4 range (demand/not demand Player \
2): \>\"", ",", "deltaTheta4Values"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Lambda1 = \>\"", ",", "l1", ",", "\"\<, Lambda2 = \>\"", ",", 
          "l2"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Dataset size: \>\"", ",", 
          RowBox[{"data", "[", "\"\<nrows\>\"", "]"}], ",", "\"\< rows\>\""}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<\>\"", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"startTime", "=", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gridResults", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "currentResults", ",", "currentAccuracy", ",", "elapsedTime", ",", 
           "estimatedTotal", ",", "estimatedRemaining"}], "}"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"currentCombination", "++"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"verbose", "&&", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"currentCombination", ",", 
                RowBox[{"Max", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"Floor", "[", 
                   RowBox[{"totalCombinations", "/", "50"}], "]"}]}], "]"}]}],
                "]"}], "==", "0"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"elapsedTime", "=", 
              RowBox[{
               RowBox[{"AbsoluteTime", "[", "]"}], "-", "startTime"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"estimatedTotal", "=", 
              RowBox[{"elapsedTime", "*", 
               RowBox[{"totalCombinations", "/", "currentCombination"}]}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"estimatedRemaining", "=", 
              RowBox[{"estimatedTotal", "-", "elapsedTime"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Progress: \>\"", ",", "currentCombination", ",", 
               "\"\</\>\"", ",", "totalCombinations", ",", "\"\< (\>\"", ",", 
               
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{"100", "*", 
                  RowBox[{"currentCombination", "/", "totalCombinations"}]}], 
                 ",", "3"}], "]"}], ",", "\"\<%)\>\""}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Elapsed: \>\"", ",", 
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{"elapsedTime", "/", "60"}], ",", "2"}], "]"}], ",", 
               "\"\< min, Estimated remaining: \>\"", ",", 
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{"estimatedRemaining", "/", "60"}], ",", "2"}], "]"}],
                ",", "\"\< min\>\""}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Current best: \[CapitalDelta]\[CapitalTheta]1=\>\"", ",", 
               "bestDeltaTheta1", ",", 
               "\"\<, \[CapitalDelta]\[CapitalTheta]2=\>\"", ",", 
               "bestDeltaTheta2", ",", 
               "\"\<, \[CapitalDelta]\[CapitalTheta]3=\>\"", ",", 
               "bestDeltaTheta3", ",", 
               "\"\<, \[CapitalDelta]\[CapitalTheta]4=\>\"", ",", 
               "bestDeltaTheta4", ",", "\"\<, Accuracy=\>\"", ",", 
               RowBox[{"N", "[", 
                RowBox[{"bestAccuracy", ",", "4"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "\"\<\>\"", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"currentResults", "=", 
           RowBox[{"Quiet", "[", 
            RowBox[{"processQuantumNormalFormDataset", "[", 
             RowBox[{
             "data", ",", "dt1", ",", "dt2", ",", "dt3", ",", "dt4", ",", 
              "l1", ",", "l2", ",", " ", "False"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "currentResults", "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"currentAccuracy", "=", 
              RowBox[{
              "calculateQuantumNormalFormAccuracy", "[", "currentResults", 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
              RowBox[{"gridResults", ",", "\[IndentingNewLine]", 
               RowBox[{"Association", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<deltaTheta1\>\"", "->", "dt1"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<deltaTheta2\>\"", "->", "dt2"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<deltaTheta3\>\"", "->", "dt3"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<deltaTheta4\>\"", "->", "dt4"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<accuracy\>\"", "->", "currentAccuracy"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<l1\>\"", "->", "l1"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<l2\>\"", "->", "l2"}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"currentAccuracy", ">", "bestAccuracy"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bestAccuracy", "=", "currentAccuracy"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"bestDeltaTheta1", "=", "dt1"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"bestDeltaTheta2", "=", "dt2"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"bestDeltaTheta3", "=", "dt3"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"bestDeltaTheta4", "=", "dt4"}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"verbose", ",", "\[IndentingNewLine]", 
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<New best found: \[CapitalDelta]\[CapitalTheta]1=\>\"",
                     ",", "dt1", ",", 
                    "\"\<, \[CapitalDelta]\[CapitalTheta]2=\>\"", ",", "dt2", 
                    ",", "\"\<, \[CapitalDelta]\[CapitalTheta]3=\>\"", ",", 
                    "dt3", ",", "\"\<, \[CapitalDelta]\[CapitalTheta]4=\>\"", 
                    ",", "dt4", ",", "\"\<, Accuracy=\>\"", ",", 
                    RowBox[{"N", "[", 
                    RowBox[{"currentAccuracy", ",", "4"}], "]"}]}], "]"}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], ",", 
            RowBox[{"(*", 
             RowBox[{"ELSE", " ", "clause", " ", "for", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Length", "[", "currentResults", "]"}], ">", "0"}], 
               "]"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"verbose", ",", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Warning: Failed to calculate results for \[CapitalDelta]\
\[CapitalTheta]1=\>\"", ",", "dt1", ",", 
                 "\"\<, \[CapitalDelta]\[CapitalTheta]2=\>\"", ",", "dt2", 
                 ",", "\"\<, \[CapitalDelta]\[CapitalTheta]3=\>\"", ",", 
                 "dt3", ",", "\"\<, \[CapitalDelta]\[CapitalTheta]4=\>\"", 
                 ",", "dt4"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
              RowBox[{"gridResults", ",", "\[IndentingNewLine]", 
               RowBox[{"Association", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<deltaTheta1\>\"", "->", "dt1"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<deltaTheta2\>\"", "->", "dt2"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<deltaTheta3\>\"", "->", "dt3"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<deltaTheta4\>\"", "->", "dt4"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<accuracy\>\"", "->", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<l1\>\"", "->", "l1"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<l2\>\"", "->", "l2"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<failed\>\"", "->", "True"}]}], "]"}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"dt1", ",", "deltaTheta1Values"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dt2", ",", "deltaTheta2Values"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dt3", ",", "deltaTheta3Values"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dt4", ",", "deltaTheta4Values"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"verbose", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<4-parameter grid search completed!\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Total time: \>\"", ",", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"AbsoluteTime", "[", "]"}], "-", "startTime"}], ")"}], 
             "/", "60"}], ",", "2"}], "]"}], ",", "\"\< minutes\>\""}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<Best parameters found:\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<  \[CapitalDelta]\[CapitalTheta]1 (fight/not fight Player 1) = \
\>\"", ",", "bestDeltaTheta1"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<  \[CapitalDelta]\[CapitalTheta]2 (fight/not fight Player 2) = \
\>\"", ",", "bestDeltaTheta2"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<  \[CapitalDelta]\[CapitalTheta]3 (demand/not demand Player 1) \
= \>\"", ",", "bestDeltaTheta3"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<  \[CapitalDelta]\[CapitalTheta]4 (demand/not demand Player 2) \
= \>\"", ",", "bestDeltaTheta4"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<  Accuracy = \>\"", ",", 
          RowBox[{"N", "[", 
           RowBox[{"bestAccuracy", ",", "4"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<\>\"", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Association", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<bestDeltaTheta1\>\"", "->", "bestDeltaTheta1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<bestDeltaTheta2\>\"", "->", "bestDeltaTheta2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<bestDeltaTheta3\>\"", "->", "bestDeltaTheta3"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<bestDeltaTheta4\>\"", "->", "bestDeltaTheta4"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<bestAccuracy\>\"", "->", "bestAccuracy"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<allResults\>\"", "->", "gridResults"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<totalCombinations\>\"", "->", "totalCombinations"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<l1\>\"", "->", "l1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<l2\>\"", "->", "l2"}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}], " "}]], "Input",
 CellChangeTimes->{{3.9586070392914467`*^9, 3.958607137954014*^9}, {
  3.95860808683992*^9, 3.9586080872881145`*^9}, {3.958608193557766*^9, 
  3.958608209969736*^9}, {3.958608319849783*^9, 3.9586083262067127`*^9}, {
  3.9586384270298243`*^9, 3.958638734985705*^9}},
 CellLabel->
  "In[345]:=",ExpressionUUID->"fb3655d7-fb79-d64c-99cc-b9f7612a9240"]
}, Open  ]],

Cell[CellGroupData[{

Cell["processQuantumNormalFormDataset", "Subsubsection",
 CellChangeTimes->{
  3.9586083823226585`*^9},ExpressionUUID->"0690d6e0-3f1f-4d46-942c-\
30a3f2f340f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"processQuantumNormalFormDataset", "[", 
   RowBox[{"data_", ",", 
    RowBox[{"deltaTheta1_", ":", "0"}], ",", 
    RowBox[{"deltaTheta2_", ":", "0"}], ",", 
    RowBox[{"deltaTheta3_", ":", "0"}], ",", 
    RowBox[{"deltaTheta4_", ":", "0"}], ",", 
    RowBox[{"l1_", ":", "1"}], ",", 
    RowBox[{"l2_", ":", "1"}], ",", " ", 
    RowBox[{"verbose_", " ", ":", " ", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"results", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Processing \>\"", ",", 
       RowBox[{"data", "[", "\"\<nrows\>\"", "]"}], ",", 
       "\"\< rows with 4 parameters...\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[CapitalDelta]\[CapitalTheta]1=\>\"", ",", "deltaTheta1", ",", 
       "\"\<, \[CapitalDelta]\[CapitalTheta]2=\>\"", ",", "deltaTheta2", ",", 
       "\"\<, \[CapitalDelta]\[CapitalTheta]3=\>\"", ",", "deltaTheta3", ",", 
       "\"\<, \[CapitalDelta]\[CapitalTheta]4=\>\"", ",", "deltaTheta4"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"results", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"verbose", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"i", ",", "50"}], "]"}], "==", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Processing row \>\"", ",", "i", ",", "\"\</\>\"", ",", 
                 RowBox[{"data", "[", "\"\<nrows\>\"", "]"}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"calculateQuantumNormalFormOutcome", "[", 
            RowBox[{
            "data", ",", "i", ",", "deltaTheta1", ",", "deltaTheta2", ",", 
             "deltaTheta3", ",", "deltaTheta4", ",", "l1", ",", "l2"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"result", "=!=", "$Failed"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"results", ",", "result"}], "]"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Warning: Failed to process row \>\"", ",", "i"}], 
             "]"}]}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"data", "[", "\"\<nrows\>\"", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Successfully processed \>\"", ",", 
       RowBox[{"Length", "[", "results", "]"}], ",", "\"\< out of \>\"", ",", 
       
       RowBox[{"data", "[", "\"\<nrows\>\"", "]"}], ",", "\"\< rows\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", "results"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.958608378535801*^9, 3.958608378535801*^9}, {
  3.9586387600624228`*^9, 3.958638826339589*^9}},
 CellLabel->
  "In[346]:=",ExpressionUUID->"e1c7d384-37f4-0e46-878e-946cd37f913e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["calculateQuantumNormalFormAccuracy", "Subsubsection",
 CellChangeTimes->{
  3.9586083995082855`*^9},ExpressionUUID->"618621d8-7638-6d41-b1c0-\
321775f560db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"calculateQuantumNormalFormAccuracy", "[", "results_", "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"predTruth", ",", "correct"}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "results", "]"}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<Warning: No results to calculate accuracy from\>\"", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "0", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"predTruth", "=", 
      RowBox[{"extractPredictionsAndGroundtruth", "[", "results", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"predTruth", "[", "\"\<predictions\>\"", "]"}], "]"}], "==", 
        "0"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Warning: No valid predictions found\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "0", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"correct", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Equal", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"predTruth", "[", "\"\<predictions\>\"", "]"}], ",", 
          RowBox[{"predTruth", "[", "\"\<groundtruth\>\"", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{"correct", ",", "True"}], "]"}], "/", 
       RowBox[{"Length", "[", "correct", "]"}]}], "]"}]}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.9586083966935463`*^9, 3.9586083966935463`*^9}},
 CellLabel->
  "In[347]:=",ExpressionUUID->"3a84d0a6-5a7f-2c40-99e3-6bfd4f112416"]
}, Open  ]],

Cell[CellGroupData[{

Cell["extractPredictionsAndGroundtruth", "Subsubsection",
 CellChangeTimes->{
  3.95860841846813*^9},ExpressionUUID->"11d6fde7-0049-9f41-a5ca-7ea6eb258d77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractPredictionsAndGroundtruth", "[", "results_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"predictions", ",", "groundTruth", ",", "outcomes"}], "}"}], ",", 
    RowBox[{
     RowBox[{"outcomes", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<ACQ1\>\"", ",", "\"\<ACQ2\>\"", ",", "\"\<CAP1\>\"", ",", 
        "\"\<CAP2\>\"", ",", "\"\<NEGO\>\"", ",", "\"\<SQ\>\"", ",", 
        "\"\<WAR1\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"predictions", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "outcomeProbs", ",", "maxVal", ",", "maxOutcomes", ",", 
            "maxOutcome", ",", "roundedProbs"}], "}"}], ",", 
          RowBox[{
           RowBox[{"outcomeProbs", "=", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{"\"\<ACQ1\>\"", "->", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<ACQ1\>\""}], 
                   "]"}], "&&", 
                  RowBox[{"NumericQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<ACQ1\>\"", 
                    "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"results", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<ACQ1\>\"", "]"}],
                  ",", "0"}], "]"}]}], ",", 
              RowBox[{"\"\<ACQ2\>\"", "->", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<ACQ2\>\""}], 
                   "]"}], "&&", 
                  RowBox[{"NumericQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<ACQ2\>\"", 
                    "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"results", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<ACQ2\>\"", "]"}],
                  ",", "0"}], "]"}]}], ",", 
              RowBox[{"\"\<CAP1\>\"", "->", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<CAP1\>\""}], 
                   "]"}], "&&", 
                  RowBox[{"NumericQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<CAP1\>\"", 
                    "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"results", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<CAP1\>\"", "]"}],
                  ",", "0"}], "]"}]}], ",", 
              RowBox[{"\"\<CAP2\>\"", "->", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<CAP2\>\""}], 
                   "]"}], "&&", 
                  RowBox[{"NumericQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<CAP2\>\"", 
                    "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"results", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<CAP2\>\"", "]"}],
                  ",", "0"}], "]"}]}], ",", 
              RowBox[{"\"\<NEGO\>\"", "->", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<NEGO\>\""}], 
                   "]"}], "&&", 
                  RowBox[{"NumericQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<NEGO\>\"", 
                    "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"results", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<NEGO\>\"", "]"}],
                  ",", "0"}], "]"}]}], ",", 
              RowBox[{"\"\<SQ\>\"", "->", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<SQ\>\""}], 
                   "]"}], "&&", 
                  RowBox[{"NumericQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<SQ\>\"", "]"}], 
                   "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"results", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<SQ\>\"", "]"}], 
                 ",", "0"}], "]"}]}], ",", 
              RowBox[{"\"\<WAR1\>\"", "->", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<WAR1\>\""}], 
                   "]"}], "&&", 
                  RowBox[{"NumericQ", "[", 
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<WAR1\>\"", 
                    "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"results", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<WAR1\>\"", "]"}],
                  ",", "0"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"roundedProbs", "=", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "->", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"outcomeProbs", "[", "#", "]"}], ",", "0.0001"}], 
                 "]"}]}], "&"}], "/@", 
              RowBox[{"Keys", "[", "outcomeProbs", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"maxVal", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Values", "[", "roundedProbs", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"maxOutcomes", "=", 
            RowBox[{"Keys", "[", 
             RowBox[{"Select", "[", 
              RowBox[{"roundedProbs", ",", 
               RowBox[{
                RowBox[{"#", "==", "maxVal"}], "&"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"maxOutcome", "=", 
            RowBox[{"RandomChoice", "[", "maxOutcomes", "]"}]}], ";", 
           "\[IndentingNewLine]", "maxOutcome"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "results", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"groundTruth", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{
            RowBox[{"results", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<groundtruth\>\""}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{"results", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<groundtruth\>\"", "]"}],
           ",", "\"\<UNKNOWN\>\""}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "results", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<predictions\>\"", "->", "predictions"}], ",", 
       RowBox[{"\"\<groundtruth\>\"", "->", "groundTruth"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9586084154230995`*^9, 3.958608415424095*^9}},
 CellLabel->
  "In[348]:=",ExpressionUUID->"bd3e50aa-26b3-a24e-bcc3-e5deacc8c69d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["createThetaRange", "Subsubsection",
 CellChangeTimes->{
  3.9586084416903496`*^9},ExpressionUUID->"94dfacf6-9cbb-7447-83cf-\
3b0b8ce2d4dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"createThetaRange", "[", 
   RowBox[{"min_", ",", "max_", ",", "steps_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"steps", "==", "1"}], ",", 
    RowBox[{"{", "min", "}"}], ",", 
    RowBox[{"Range", "[", 
     RowBox[{"min", ",", "max", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"max", "-", "min"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"steps", "-", "1"}], ")"}]}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9586084392956257`*^9, 3.9586084392956257`*^9}},
 CellLabel->
  "In[349]:=",ExpressionUUID->"e19799dc-2fb7-434a-ae7e-2598e6c1796b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["summarizeDataset", "Subsubsection",
 CellChangeTimes->{
  3.958608455925495*^9},ExpressionUUID->"21762f89-aecf-394f-adb7-\
514e293afaa0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"summarizeDataset", "[", "data_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"groundTruthCounts", ",", "outcomes"}], "}"}], ",", 
    RowBox[{
     RowBox[{"outcomes", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<SQ\>\"", ",", "\"\<ACQ1\>\"", ",", "\"\<ACQ2\>\"", ",", 
        "\"\<NEGO\>\"", ",", "\"\<CAP1\>\"", ",", "\"\<CAP2\>\"", ",", 
        "\"\<WAR1\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"groundTruthCounts", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"data", "[", "\"\<groundtruth\>\"", "]"}], ",", "outcome"}],
          "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"outcome", ",", "outcomes"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<Dataset Summary\>\"", ",", "16", ",", "Bold"}], "]"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Total cases: \>\"", ",", 
       RowBox[{"data", "[", "\"\<nrows\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Outcome distribution:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"outcomes", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"groundTruthCounts", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"100", "*", 
                RowBox[{
                 RowBox[{"groundTruthCounts", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "/", 
                 RowBox[{"data", "[", "\"\<nrows\>\"", "]"}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}]}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{
          "\"\<Outcome\>\"", ",", "\"\<Count\>\"", ",", 
           "\"\<Percentage\>\""}], "}"}]}], "]"}], ",", 
       RowBox[{"Frame", "->", "All"}], ",", 
       RowBox[{"Alignment", "->", "Center"}], ",", 
       RowBox[{"Background", "->", 
        RowBox[{"{", 
         RowBox[{"None", ",", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", "None"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9586084532164135`*^9, 3.9586084532164135`*^9}},
 CellLabel->
  "In[350]:=",ExpressionUUID->"44251dde-ecf6-bf42-ab5b-81787cad5f2b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["gridSearchQuantumNormalFormThetasConstrained", "Subsubsection",
 CellChangeTimes->{
  3.958608500463932*^9},ExpressionUUID->"ed044993-c50c-bf4d-b591-\
3208551139f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gridSearchQuantumNormalFormThetasConstrained", "[", 
   RowBox[{
   "data_", ",", "deltaTheta1Range_List", ",", "deltaTheta2Range_List", ",", 
    RowBox[{"l1_", ":", "1"}], ",", 
    RowBox[{"l2_", ":", "1"}], ",", 
    RowBox[{"verbose_", ":", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "gridResults", "}"}], ",", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Running CONSTRAINED grid search with \
\[CapitalDelta]\[CapitalTheta]1=\[CapitalDelta]\[CapitalTheta]3 and \
\[CapitalDelta]\[CapitalTheta]2=\[CapitalDelta]\[CapitalTheta]4...\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"gridResults", "=", 
      RowBox[{"gridSearchQuantumNormalFormThetas", "[", 
       RowBox[{
       "data", ",", "deltaTheta1Range", ",", "deltaTheta2Range", ",", 
        "deltaTheta1Range", ",", "deltaTheta2Range", ",", "l1", ",", "l2", 
        ",", "verbose"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Constrained search completed. The optimal parameters are:\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[CapitalDelta]\[CapitalTheta]1 = \[CapitalDelta]\[CapitalTheta]3 \
= \>\"", ",", 
       RowBox[{"gridResults", "[", "\"\<bestDeltaTheta1\>\"", "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[CapitalDelta]\[CapitalTheta]2 = \[CapitalDelta]\[CapitalTheta]4 \
= \>\"", ",", 
       RowBox[{"gridResults", "[", "\"\<bestDeltaTheta2\>\"", "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "gridResults"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9586084979348145`*^9, 3.9586084979348145`*^9}},
 CellLabel->
  "In[351]:=",ExpressionUUID->"dbca5c5f-e1df-0d4e-95a2-33d54c1520d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["quickTest", "Subsubsection",
 CellChangeTimes->{
  3.958608624892418*^9},ExpressionUUID->"133e2004-e5f2-884b-a4c2-\
ef41826eb36c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"quickTest", "[", 
   RowBox[{"datasetPath_String", ",", 
    RowBox[{"rowIndex_Integer", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data", ",", "result", ",", "utils"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Running quick test with 4 parameters on row \>\"", ",", "rowIndex",
        ",", "\"\<...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"loadData", "[", "datasetPath", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"data", "===", "$Failed"}], ",", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Validate", " ", "row", " ", "index"}], "*)"}], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rowIndex", "<", "1"}], "||", 
        RowBox[{"rowIndex", ">", 
         RowBox[{"data", "[", "\"\<nrows\>\"", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Error: Row index \>\"", ",", "rowIndex", ",", 
          "\"\< out of range [1, \>\"", ",", 
          RowBox[{"data", "[", "\"\<nrows\>\"", "]"}], ",", "\"\<]\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Test", " ", "with", " ", "specific", " ", "row", " ", "using", " ", 
       "all", " ", "4", " ", "parameters"}], "*)"}], 
     RowBox[{"result", "=", 
      RowBox[{"calculateQuantumNormalFormOutcome", "[", 
       RowBox[{"data", ",", "rowIndex", ",", "Pi", ",", 
        RowBox[{"Pi", "/", "2"}], ",", 
        RowBox[{"3", "*", 
         RowBox[{"Pi", "/", "2"}]}], ",", 
        RowBox[{"Pi", "/", "4"}], ",", "1", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"result", "===", "$Failed"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Failed to process row \>\"", ",", "rowIndex"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Extract", " ", "utilities", " ", "for", " ", "this", " ", "row"}], 
      "*)"}], 
     RowBox[{"utils", "=", 
      RowBox[{"result", "[", "\"\<utilities\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Successfully processed row \>\"", ",", "rowIndex"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Agents: \>\"", ",", 
       RowBox[{"utils", "[", "\"\<Agent1\>\"", "]"}], ",", "\"\< vs \>\"", 
       ",", 
       RowBox[{"utils", "[", "\"\<Agent2\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Year: \>\"", ",", 
       RowBox[{"utils", "[", "\"\<year\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Results:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  Predicted outcome: \>\"", ",", 
       RowBox[{"result", "[", "\"\<prediction\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  Actual outcome: \>\"", ",", 
       RowBox[{"result", "[", "\"\<groundtruth\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  Match: \>\"", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result", "[", "\"\<prediction\>\"", "]"}], "==", 
          RowBox[{"result", "[", "\"\<groundtruth\>\"", "]"}]}], ",", 
         "\"\<YES\>\"", ",", "\"\<NO\>\""}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Outcome probabilities:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  P(SQ) = \>\"", ",", 
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"result", "[", "\"\<SQ\>\"", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  P(ACQ1) = \>\"", ",", 
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"result", "[", "\"\<ACQ1\>\"", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  P(ACQ2) = \>\"", ",", 
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"result", "[", "\"\<ACQ2\>\"", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  P(NEGO) = \>\"", ",", 
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"result", "[", "\"\<NEGO\>\"", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  P(CAP1) = \>\"", ",", 
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"result", "[", "\"\<CAP1\>\"", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  P(CAP2) = \>\"", ",", 
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"result", "[", "\"\<CAP2\>\"", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  P(WAR1) = \>\"", ",", 
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"result", "[", "\"\<WAR1\>\"", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  Total = \>\"", ",", 
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"result", "[", "\"\<total\>\"", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Phase parameters used:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<  \[CapitalDelta]\[CapitalTheta]1 (fight P1) = \>\"", ",", 
       RowBox[{"result", "[", "\"\<deltaTheta1\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<  \[CapitalDelta]\[CapitalTheta]2 (fight P2) = \>\"", ",", 
       RowBox[{"result", "[", "\"\<deltaTheta2\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  \[CapitalDelta]\[CapitalTheta]3 (demand P1) = \>\"", ",", 
       RowBox[{"result", "[", "\"\<deltaTheta3\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  \[CapitalDelta]\[CapitalTheta]4 (demand P2) = \>\"", ",", 
       RowBox[{"result", "[", "\"\<deltaTheta4\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "result"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9586086194003277`*^9, 3.9586086194003277`*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"8de339b1-0c90-9246-8201-95472365e6d0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualisation Functions", "Subsection",
 CellChangeTimes->{{3.958608641551115*^9, 
  3.958608646422472*^9}},ExpressionUUID->"dee07e75-80f6-4147-ac43-\
80c2aae3f51c"],

Cell[CellGroupData[{

Cell["visualizeGridSearchResults4D", "Subsubsection",
 CellChangeTimes->{{3.958608749640518*^9, 3.958608749917549*^9}, 
   3.958615693700857*^9},ExpressionUUID->"a1f5834b-067d-e34c-90c2-\
01e68b7c462a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"===", 
    RowBox[{"==", 
     RowBox[{
      RowBox[{"VISUALIZATION", " ", "FUNCTIONS", " ", "FOR", " ", "4"}], "-", 
      
      RowBox[{"PARAMETER", " ", "MODEL"}]}]}], "===", "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Function", " ", "to", " ", "visualize", " ", "4", "D", " ", "grid", " ", 
     "search", " ", "results"}], "-", 
    RowBox[{"shows", " ", "2", "D", " ", "slices"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"visualizeGridSearchResults4D", "[", 
     RowBox[{"gridSearchResults_", ",", 
      RowBox[{"fixedParams_", ":", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "validResults", ",", "param1Idx", ",", "param2Idx", ",", "param3Fixed",
         ",", "param4Fixed", ",", "theta1Values", ",", "theta2Values", ",", 
        "accuracyMatrix", ",", "minAcc", ",", "maxAcc", ",", "tickLabels1", 
        ",", "tickLabels2", ",", "plot", ",", "paramNames"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AssociationQ", "[", "gridSearchResults", "]"}]}], "||", 
          RowBox[{"!", 
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{"gridSearchResults", ",", "\"\<allResults\>\""}], 
            "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Error: Input must be a grid search results Association with \
'allResults' key\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"validResults", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"gridSearchResults", "[", "\"\<allResults\>\"", "]"}], ",", 
          
          RowBox[{
           RowBox[{"!", 
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{"#", ",", "\"\<failed\>\""}], "]"}]}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "validResults", "]"}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<No valid results to visualize\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"paramNames", "=", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\[CapitalDelta]\[CapitalTheta]1 (fight P1)\>\"", ",", 
          "\"\<\[CapitalDelta]\[CapitalTheta]2 (fight P2)\>\"", ",", 
          "\"\<\[CapitalDelta]\[CapitalTheta]3 (demand P1)\>\"", ",", 
          "\"\<\[CapitalDelta]\[CapitalTheta]4 (demand P2)\>\""}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"param1Idx", "=", 
        RowBox[{"fixedParams", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"param2Idx", "=", 
        RowBox[{"fixedParams", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Get", " ", "unique", " ", "values", " ", "for", " ", "the", " ", 
         "two", " ", "parameters", " ", 
         RowBox[{"we", "'"}], "re", " ", "plotting"}], "*)"}], 
       RowBox[{"theta1Values", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Switch", "[", 
           RowBox[{"param1Idx", ",", "1", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<deltaTheta1\>\"", "]"}], "&"}], "/@", 
             "validResults"}], ",", "2", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<deltaTheta2\>\"", "]"}], "&"}], "/@", 
             "validResults"}], ",", "3", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<deltaTheta3\>\"", "]"}], "&"}], "/@", 
             "validResults"}], ",", "4", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<deltaTheta4\>\"", "]"}], "&"}], "/@", 
             "validResults"}]}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"theta2Values", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Switch", "[", 
           RowBox[{"param2Idx", ",", "1", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<deltaTheta1\>\"", "]"}], "&"}], "/@", 
             "validResults"}], ",", "2", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<deltaTheta2\>\"", "]"}], "&"}], "/@", 
             "validResults"}], ",", "3", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<deltaTheta3\>\"", "]"}], "&"}], "/@", 
             "validResults"}], ",", "4", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<deltaTheta4\>\"", "]"}], "&"}], "/@", 
             "validResults"}]}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Get", " ", "fixed", " ", "values", " ", "for", " ", "the", " ", 
         "other", " ", "two", " ", "parameters"}], "*)"}], 
       RowBox[{"param3Fixed", "=", 
        RowBox[{"Switch", "[", 
         RowBox[{
          RowBox[{"6", "-", "param1Idx", "-", "param2Idx"}], ",", "1", ",", 
          RowBox[{"First", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", "\"\<deltaTheta1\>\"", "]"}], "&"}], "/@", 
              "validResults"}], "]"}], "]"}], "]"}], ",", "2", ",", 
          RowBox[{"First", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", "\"\<deltaTheta2\>\"", "]"}], "&"}], "/@", 
              "validResults"}], "]"}], "]"}], "]"}], ",", "3", ",", 
          RowBox[{"First", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", "\"\<deltaTheta3\>\"", "]"}], "&"}], "/@", 
              "validResults"}], "]"}], "]"}], "]"}], ",", "4", ",", 
          RowBox[{"First", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", "\"\<deltaTheta4\>\"", "]"}], "&"}], "/@", 
              "validResults"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"param4Fixed", "=", 
        RowBox[{"Switch", "[", 
         RowBox[{
          RowBox[{"10", "-", "param1Idx", "-", "param2Idx", "-", 
           RowBox[{"(", 
            RowBox[{"6", "-", "param1Idx", "-", "param2Idx"}], ")"}]}], ",", 
          "1", ",", 
          RowBox[{"First", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", "\"\<deltaTheta1\>\"", "]"}], "&"}], "/@", 
              "validResults"}], "]"}], "]"}], "]"}], ",", "2", ",", 
          RowBox[{"First", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", "\"\<deltaTheta2\>\"", "]"}], "&"}], "/@", 
              "validResults"}], "]"}], "]"}], "]"}], ",", "3", ",", 
          RowBox[{"First", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", "\"\<deltaTheta3\>\"", "]"}], "&"}], "/@", 
              "validResults"}], "]"}], "]"}], "]"}], ",", "4", ",", 
          RowBox[{"First", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", "\"\<deltaTheta4\>\"", "]"}], "&"}], "/@", 
              "validResults"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Create", " ", "accuracy", " ", "matrix", " ", "for", " ", 
         "heatmap"}], "*)"}], 
       RowBox[{"accuracyMatrix", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "matchingResult", "}"}], ",", 
            RowBox[{
             RowBox[{"matchingResult", "=", 
              RowBox[{"SelectFirst", "[", 
               RowBox[{"validResults", ",", 
                RowBox[{
                 RowBox[{"Switch", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"param1Idx", ",", "param2Idx"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<deltaTheta1\>\"", "]"}], "==", 
                    "theta1"}], "&&", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<deltaTheta2\>\"", "]"}], "==", 
                    "theta2"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<deltaTheta1\>\"", "]"}], "==", 
                    "theta1"}], "&&", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<deltaTheta3\>\"", "]"}], "==", 
                    "theta2"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<deltaTheta1\>\"", "]"}], "==", 
                    "theta1"}], "&&", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<deltaTheta4\>\"", "]"}], "==", 
                    "theta2"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<deltaTheta2\>\"", "]"}], "==", 
                    "theta1"}], "&&", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<deltaTheta3\>\"", "]"}], "==", 
                    "theta2"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "4"}], "}"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<deltaTheta2\>\"", "]"}], "==", 
                    "theta1"}], "&&", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<deltaTheta4\>\"", "]"}], "==", 
                    "theta2"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<deltaTheta3\>\"", "]"}], "==", 
                    "theta1"}], "&&", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<deltaTheta4\>\"", "]"}], "==", 
                    "theta2"}]}], ",", "_", ",", "False"}], "]"}], "&"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"matchingResult", "===", 
                RowBox[{"Missing", "[", "\"\<NotFound\>\"", "]"}]}], ",", "0",
                ",", 
               RowBox[{"matchingResult", "[", "\"\<accuracy\>\"", "]"}]}], 
              "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"theta1", ",", "theta1Values"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"theta2", ",", "theta2Values"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"minAcc", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"Flatten", "[", "accuracyMatrix", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"maxAcc", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Flatten", "[", "accuracyMatrix", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tickLabels1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"theta1Values", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "3"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "theta1Values", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tickLabels2", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"theta2Values", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "3"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "theta2Values", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<4D Grid Search Results Visualization (2D Slice)\>\"", ",", "16",
           ",", "Bold"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<Showing: \>\"", ",", 
            RowBox[{"paramNames", "[", 
             RowBox[{"[", "param1Idx", "]"}], "]"}], ",", "\"\< vs \>\"", ",", 
            RowBox[{"paramNames", "[", 
             RowBox[{"[", "param2Idx", "]"}], "]"}]}], "]"}], ",", "14"}], 
         "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<Fixed parameters: \>\"", ",", 
            RowBox[{"paramNames", "[", 
             RowBox[{"[", 
              RowBox[{"6", "-", "param1Idx", "-", "param2Idx"}], "]"}], "]"}],
             ",", "\"\< = \>\"", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"N", "[", "param3Fixed", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
            "\"\<, \>\"", ",", 
            RowBox[{"paramNames", "[", 
             RowBox[{"[", 
              RowBox[{"10", "-", "param1Idx", "-", "param2Idx", "-", 
               RowBox[{"(", 
                RowBox[{"6", "-", "param1Idx", "-", "param2Idx"}], ")"}]}], 
              "]"}], "]"}], ",", "\"\< = \>\"", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"N", "[", "param4Fixed", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "3"}], "}"}]}], "]"}], "]"}]}], "]"}], ",", 
          "12", ",", "Gray"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<Best Accuracy in this slice: \>\"", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"N", "[", "maxAcc", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"5", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
            "\"\< (\>\"", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"100", "*", 
                RowBox[{"N", "[", "maxAcc", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"5", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
            "\"\<%)\>\""}], "]"}], ",", "14", ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.1", ",", "0.5", ",", "0.1"}], "]"}]}], "]"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"plot", "=", 
        RowBox[{"ArrayPlot", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "accuracyMatrix", "]"}], ",", 
          RowBox[{"ColorFunction", "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Blend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"RGBColor", "[", 
                  RowBox[{"0.2", ",", "0.2", ",", "0.4"}], "]"}], ",", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{"0.3", ",", "0.6", ",", "0.8"}], "]"}], ",", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{"0.9", ",", "0.9", ",", "0.3"}], "]"}], ",", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{"0.9", ",", "0.6", ",", "0.1"}], "]"}], ",", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{"0.8", ",", "0.2", ",", "0.2"}], "]"}]}], "}"}], 
               ",", "#"}], "]"}], "&"}], ")"}]}], ",", 
          RowBox[{"ColorFunctionScaling", "->", "True"}], ",", 
          RowBox[{"PlotLabel", "->", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<Parameter Optimization: \>\"", ",", 
               RowBox[{"paramNames", "[", 
                RowBox[{"[", "param1Idx", "]"}], "]"}], ",", "\"\< vs \>\"", 
               ",", 
               RowBox[{"paramNames", "[", 
                RowBox[{"[", "param2Idx", "]"}], "]"}]}], "]"}], ",", "16", 
             ",", "Bold"}], "]"}]}], ",", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"paramNames", "[", 
                RowBox[{"[", "param1Idx", "]"}], "]"}], ",", "14", ",", 
               "Bold"}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"paramNames", "[", 
                RowBox[{"[", "param2Idx", "]"}], "]"}], ",", "14", ",", 
               "Bold"}], "]"}]}], "}"}]}], ",", 
          RowBox[{"FrameTicks", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"tickLabels2", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"tickLabels1", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"500", ",", "400"}], "}"}]}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"FrameStyle", "->", "Black"}], ",", 
          RowBox[{"PlotRangePadding", "->", "None"}], ",", 
          RowBox[{"PlotLegends", "->", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"BarLegend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Blend", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.2", ",", "0.2", ",", "0.4"}], "]"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.3", ",", "0.6", ",", "0.8"}], "]"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.9", ",", "0.9", ",", "0.3"}], "]"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.9", ",", "0.6", ",", "0.1"}], "]"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.8", ",", "0.2", ",", "0.2"}], "]"}]}], "}"}], 
                    ",", "#"}], "]"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"minAcc", ",", "maxAcc"}], "}"}]}], "}"}], ",", 
               RowBox[{"LegendLabel", "->", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Accuracy\>\"", ",", "12", ",", "Bold"}], 
                 "]"}]}], ",", 
               RowBox[{"LegendMarkerSize", "->", "200"}]}], "]"}], ",", 
             "Right"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "plot"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Confusion", " ", "Matrix", " ", "for", " ", "4"}], "-", 
     RowBox[{"parameter", " ", "model"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"plotQuantumNormalFormConfusionMatrix", "[", 
     RowBox[{"results_", ",", 
      RowBox[{"deltaTheta1_", ":", "0"}], ",", 
      RowBox[{"deltaTheta2_", ":", "0"}], ",", 
      RowBox[{"deltaTheta3_", ":", "0"}], ",", 
      RowBox[{"deltaTheta4_", ":", "0"}], ",", 
      RowBox[{"l1_", ":", "1"}], ",", 
      RowBox[{"l2_", ":", "1"}], ",", 
      RowBox[{
      "title_", ":", "\"\<Quantum Normal Form Confusion Matrix\>\""}]}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "predictions", ",", "groundTruths", ",", "outcomes", ",", 
        "confusionData", ",", "accuracy", ",", "predTruth"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "results", "]"}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Warning: No results provided for confusion matrix\>\"", "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"predTruth", "=", 
        RowBox[{"extractPredictionsAndGroundtruth", "[", "results", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"predictions", "=", 
        RowBox[{"predTruth", "[", "\"\<predictions\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"groundTruths", "=", 
        RowBox[{"predTruth", "[", "\"\<groundtruth\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "predictions", "]"}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Warning: No valid predictions found\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"accuracy", "=", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{"Equal", ",", 
              RowBox[{"{", 
               RowBox[{"predictions", ",", "groundTruths"}], "}"}]}], "]"}], 
            ",", "True"}], "]"}], "/", 
          RowBox[{"Length", "[", "results", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outcomes", "=", 
        RowBox[{"{", 
         RowBox[{
         "\"\<ACQ1\>\"", ",", "\"\<ACQ2\>\"", ",", "\"\<CAP1\>\"", ",", 
          "\"\<CAP2\>\"", ",", "\"\<NEGO\>\"", ",", "\"\<SQ\>\"", ",", 
          "\"\<WAR1\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"confusionData", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{"List", ",", 
              RowBox[{"{", 
               RowBox[{"groundTruths", ",", "predictions"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"actualOutcome", ",", "predictedOutcome"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"actualOutcome", ",", "outcomes"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"predictedOutcome", ",", "outcomes"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{"title", ",", "16", ",", "Bold"}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"\"\<\[CapitalDelta]\[CapitalTheta]1 = \>\"", "<>", 
           RowBox[{"ToString", "[", "deltaTheta1", "]"}], "<>", 
           "\"\< \[CapitalDelta]\[CapitalTheta]2 = \>\"", "<>", 
           RowBox[{"ToString", "[", "deltaTheta2", "]"}], "<>", 
           "\"\< \[CapitalDelta]\[CapitalTheta]3 = \>\"", "<>", 
           RowBox[{"ToString", "[", "deltaTheta3", "]"}], "<>", 
           "\"\< \[CapitalDelta]\[CapitalTheta]4 = \>\"", "<>", 
           RowBox[{"ToString", "[", "deltaTheta4", "]"}], "<>", 
           "\"\< \[Lambda]1 = \>\"", "<>", 
           RowBox[{"ToString", "[", "l1", "]"}], "<>", 
           "\"\< \[Lambda]2 = \>\"", "<>", 
           RowBox[{"ToString", "[", "l2", "]"}], "<>", 
           "\"\< | Accuracy = \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"N", "[", "accuracy", "]"}], "]"}]}], ",", "14"}], "]"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"Prepend", ",", 
             RowBox[{"{", 
              RowBox[{"confusionData", ",", "outcomes"}], "}"}]}], "]"}], ",", 
           RowBox[{"Prepend", "[", 
            RowBox[{"outcomes", ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Actual \\\\ Predicted\>\"", ",", "Bold"}], "]"}]}],
             "]"}]}], "]"}], ",", 
         RowBox[{"Frame", "->", "All"}], ",", 
         RowBox[{"Alignment", "->", "Center"}], ",", 
         RowBox[{"Background", "->", 
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"{", 
             RowBox[{"LightBlue", ",", "None"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ItemStyle", "->", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"{", 
             RowBox[{"Bold", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Spacings", "->", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1"}], "}"}]}], ",", 
         RowBox[{"FrameStyle", "->", "Thick"}], ",", 
         RowBox[{"Dividers", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", "->", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", "->", "Thick"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Get", " ", "top", " ", "parameter", " ", "combinations", " ", "for", " ",
      "4", "D", " ", "model"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"getTopParameterCombinations", "[", 
     RowBox[{"gridSearchResults_", ",", 
      RowBox[{"n_", ":", "5"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"validResults", ",", "sortedResults"}], "}"}], ",", 
      RowBox[{
       RowBox[{"validResults", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"gridSearchResults", "[", "\"\<allResults\>\"", "]"}], ",", 
          
          RowBox[{
           RowBox[{"!", 
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{"#", ",", "\"\<failed\>\""}], "]"}]}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"sortedResults", "=", 
        RowBox[{"Reverse", "[", 
         RowBox[{"SortBy", "[", 
          RowBox[{"validResults", ",", 
           RowBox[{
            RowBox[{"#", "[", "\"\<accuracy\>\"", "]"}], "&"}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Take", "[", 
        RowBox[{"sortedResults", ",", 
         RowBox[{"Min", "[", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "sortedResults", "]"}]}], "]"}]}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Analyze", " ", "current", " ", "results", " ", "with", " ", "4", " ", 
     "parameters"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"analyzeCurrentResults", "[", "quantumResults_List", "]"}], ":=", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "accuracy", ",", "sampleResult", ",", "deltaTheta1Val", ",", 
        "deltaTheta2Val", ",", "deltaTheta3Val", ",", "deltaTheta4Val", ",", 
        "predTruth"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "quantumResults", "]"}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<No results to analyze\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sampleResult", "=", 
        RowBox[{"First", "[", "quantumResults", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaTheta1Val", "=", 
        RowBox[{"sampleResult", "[", "\"\<deltaTheta1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaTheta2Val", "=", 
        RowBox[{"sampleResult", "[", "\"\<deltaTheta2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaTheta3Val", "=", 
        RowBox[{"sampleResult", "[", "\"\<deltaTheta3\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaTheta4Val", "=", 
        RowBox[{"sampleResult", "[", "\"\<deltaTheta4\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"accuracy", "=", 
        RowBox[{
        "calculateQuantumNormalFormAccuracy", "[", "quantumResults", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"predTruth", "=", 
        RowBox[{
        "extractPredictionsAndGroundtruth", "[", "quantumResults", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<=== Quantum Normal Form Model Analysis (4-Parameter) ===\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Parameters: \[CapitalDelta]\[CapitalTheta]1 = \>\"", ",", 
         RowBox[{"N", "[", 
          RowBox[{"deltaTheta1Val", ",", "4"}], "]"}], ",", "\"\< (\>\"", ",",
          "deltaTheta1Val", ",", "\"\<)\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<           \[CapitalDelta]\[CapitalTheta]2 = \>\"", ",", 
         RowBox[{"N", "[", 
          RowBox[{"deltaTheta2Val", ",", "4"}], "]"}], ",", "\"\< (\>\"", ",",
          "deltaTheta2Val", ",", "\"\<)\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<           \[CapitalDelta]\[CapitalTheta]3 = \>\"", ",", 
         RowBox[{"N", "[", 
          RowBox[{"deltaTheta3Val", ",", "4"}], "]"}], ",", "\"\< (\>\"", ",",
          "deltaTheta3Val", ",", "\"\<)\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<           \[CapitalDelta]\[CapitalTheta]4 = \>\"", ",", 
         RowBox[{"N", "[", 
          RowBox[{"deltaTheta4Val", ",", "4"}], "]"}], ",", "\"\< (\>\"", ",",
          "deltaTheta4Val", ",", "\"\<)\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Total cases: \>\"", ",", 
         RowBox[{"Length", "[", "quantumResults", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Accuracy: \>\"", ",", 
         RowBox[{"N", "[", 
          RowBox[{"accuracy", ",", "4"}], "]"}], ",", "\"\< (\>\"", ",", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"100", "*", "accuracy"}], ",", "2"}], "]"}], ",", 
         "\"\<%)\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"outcomes", ",", "counts"}], "}"}], ",", 
         RowBox[{
          RowBox[{"outcomes", "=", 
           RowBox[{"{", 
            RowBox[{
            "\"\<SQ\>\"", ",", "\"\<ACQ1\>\"", ",", "\"\<ACQ2\>\"", ",", 
             "\"\<NEGO\>\"", ",", "\"\<CAP1\>\"", ",", "\"\<CAP2\>\"", ",", 
             "\"\<WAR1\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"counts", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{
               RowBox[{"predTruth", "[", "\"\<predictions\>\"", "]"}], ",", 
               "outcome"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"outcome", ",", "outcomes"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "\"\<Prediction distribution:\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"counts", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ">", "0"}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<  \>\"", ",", 
                RowBox[{"outcomes", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<: \>\"", ",", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\"\< (\>\"", ",", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"100", "*", 
                   RowBox[{
                    RowBox[{"counts", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "/", 
                    RowBox[{"Length", "[", 
                    RowBox[{"predTruth", "[", "\"\<predictions\>\"", "]"}], 
                    "]"}]}]}], ",", "1"}], "]"}], ",", "\"\<%)\>\""}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "outcomes", "]"}]}], "}"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"plotQuantumNormalFormConfusionMatrix", "[", 
        RowBox[{
        "quantumResults", ",", "deltaTheta1Val", ",", "deltaTheta2Val", ",", 
         "deltaTheta3Val", ",", "deltaTheta4Val", ",", "1", ",", "1", ",", 
         "\"\<Current Quantum Normal Form Model Results\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"\"\<accuracy\>\"", "->", "accuracy"}], ",", 
         RowBox[{"\"\<deltaTheta1\>\"", "->", "deltaTheta1Val"}], ",", 
         RowBox[{"\"\<deltaTheta2\>\"", "->", "deltaTheta2Val"}], ",", 
         RowBox[{"\"\<deltaTheta3\>\"", "->", "deltaTheta3Val"}], ",", 
         RowBox[{"\"\<deltaTheta4\>\"", "->", "deltaTheta4Val"}], ",", 
         RowBox[{"\"\<totalCases\>\"", "->", 
          RowBox[{"Length", "[", "quantumResults", "]"}]}], ",", 
         RowBox[{"\"\<predictions\>\"", "->", 
          RowBox[{"predTruth", "[", "\"\<predictions\>\"", "]"}]}], ",", 
         RowBox[{"\"\<groundTruth\>\"", "->", 
          RowBox[{"predTruth", "[", "\"\<groundtruth\>\"", "]"}]}]}], 
        "]"}]}]}], "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Focused", " ", "search", " ", "around", " ", "current", " ", 
     "parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focusedSearchAroundCurrent", "[", 
     RowBox[{
     "data_", ",", "currentDeltaTheta1_", ",", "currentDeltaTheta2_", ",", 
      "currentDeltaTheta3_", ",", "currentDeltaTheta4_", ",", 
      RowBox[{"rangeSize_", ":", "1.0"}], ",", 
      RowBox[{"gridSize_", ":", "3"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "deltaTheta1Range", ",", "deltaTheta2Range", ",", "deltaTheta3Range", 
        ",", "deltaTheta4Range", ",", "results"}], "}"}], ",", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Running focused search around \[CapitalDelta]\[CapitalTheta]1=\>\
\"", ",", "currentDeltaTheta1", ",", 
         "\"\<, \[CapitalDelta]\[CapitalTheta]2=\>\"", ",", 
         "currentDeltaTheta2", ",", 
         "\"\<, \[CapitalDelta]\[CapitalTheta]3=\>\"", ",", 
         "currentDeltaTheta3", ",", 
         "\"\<, \[CapitalDelta]\[CapitalTheta]4=\>\"", ",", 
         "currentDeltaTheta4"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"deltaTheta1Range", "=", 
        RowBox[{"createThetaRange", "[", 
         RowBox[{
          RowBox[{"currentDeltaTheta1", "-", "rangeSize"}], ",", 
          RowBox[{"currentDeltaTheta1", "+", "rangeSize"}], ",", "gridSize"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"deltaTheta2Range", "=", 
        RowBox[{"createThetaRange", "[", 
         RowBox[{
          RowBox[{"currentDeltaTheta2", "-", "rangeSize"}], ",", 
          RowBox[{"currentDeltaTheta2", "+", "rangeSize"}], ",", "gridSize"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"deltaTheta3Range", "=", 
        RowBox[{"createThetaRange", "[", 
         RowBox[{
          RowBox[{"currentDeltaTheta3", "-", "rangeSize"}], ",", 
          RowBox[{"currentDeltaTheta3", "+", "rangeSize"}], ",", "gridSize"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"deltaTheta4Range", "=", 
        RowBox[{"createThetaRange", "[", 
         RowBox[{
          RowBox[{"currentDeltaTheta4", "-", "rangeSize"}], ",", 
          RowBox[{"currentDeltaTheta4", "+", "rangeSize"}], ",", "gridSize"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\[CapitalDelta]\[CapitalTheta]1 range: \>\"", ",", 
         "deltaTheta1Range"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\[CapitalDelta]\[CapitalTheta]2 range: \>\"", ",", 
         "deltaTheta2Range"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\[CapitalDelta]\[CapitalTheta]3 range: \>\"", ",", 
         "deltaTheta3Range"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\[CapitalDelta]\[CapitalTheta]4 range: \>\"", ",", 
         "deltaTheta4Range"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"results", "=", 
        RowBox[{"gridSearchQuantumNormalFormThetas", "[", 
         RowBox[{
         "data", ",", "deltaTheta1Range", ",", "deltaTheta2Range", ",", 
          "deltaTheta3Range", ",", "deltaTheta4Range", ",", "1", ",", "1", 
          ",", "True"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Focused search completed. Visualizing results...\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"visualizeGridSearchResults4D", "[", 
        RowBox[{"results", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Show", " ", "\[CapitalDelta]\[CapitalTheta]1", " ", "vs", " ", 
         "\[CapitalDelta]\[CapitalTheta]2", " ", "slice"}], "*)"}], 
       "results"}]}], "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Phase", " ", "effect", " ", "analysis", " ", "for", " ", "4", " ", 
     "parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"analyzePhaseEffects", "[", 
     RowBox[{
     "data_", ",", "baseDeltaTheta1_", ",", "baseDeltaTheta2_", ",", 
      "baseDeltaTheta3_", ",", "baseDeltaTheta4_", ",", 
      RowBox[{"phaseStep_", ":", 
       RowBox[{"Pi", "/", "4"}]}], ",", 
      RowBox[{"l1_", ":", "1"}], ",", 
      RowBox[{"l2_", ":", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phaseEffects", ",", "paramNames", ",", "i"}], "}"}], ",", 
      RowBox[{
       RowBox[{
       "Print", "[", "\"\<Analyzing phase parameter effects...\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"paramNames", "=", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\[CapitalDelta]\[CapitalTheta]1\>\"", ",", 
          "\"\<\[CapitalDelta]\[CapitalTheta]2\>\"", ",", 
          "\"\<\[CapitalDelta]\[CapitalTheta]3\>\"", ",", 
          "\"\<\[CapitalDelta]\[CapitalTheta]4\>\""}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"phaseEffects", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<=", "4"}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "positiveThetas", ",", "negativeThetas", ",", "positiveResults", 
             ",", "negativeResults", ",", "positiveAcc", ",", "negativeAcc", 
             ",", "effect"}], "}"}], ",", 
           RowBox[{
            RowBox[{"positiveThetas", "=", 
             RowBox[{"{", 
              RowBox[{
              "baseDeltaTheta1", ",", "baseDeltaTheta2", ",", 
               "baseDeltaTheta3", ",", "baseDeltaTheta4"}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"negativeThetas", "=", 
             RowBox[{"{", 
              RowBox[{
              "baseDeltaTheta1", ",", "baseDeltaTheta2", ",", 
               "baseDeltaTheta3", ",", "baseDeltaTheta4"}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"positiveThetas", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+=", "phaseStep"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"negativeThetas", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-=", "phaseStep"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Testing \>\"", ",", 
              RowBox[{"paramNames", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "\"\< effect: +\>\"", ",",
               "phaseStep", ",", "\"\< vs -\>\"", ",", "phaseStep"}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"positiveResults", "=", 
             RowBox[{"processQuantumNormalFormDataset", "[", 
              RowBox[{"data", ",", 
               RowBox[{"positiveThetas", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"positiveThetas", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"positiveThetas", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"positiveThetas", "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", "l1", ",", "l2"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"negativeResults", "=", 
             RowBox[{"processQuantumNormalFormDataset", "[", 
              RowBox[{"data", ",", 
               RowBox[{"negativeThetas", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"negativeThetas", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"negativeThetas", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"negativeThetas", "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", "l1", ",", "l2"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"positiveAcc", "=", 
             RowBox[{
             "calculateQuantumNormalFormAccuracy", "[", "positiveResults", 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"negativeAcc", "=", 
             RowBox[{
             "calculateQuantumNormalFormAccuracy", "[", "negativeResults", 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"effect", "=", 
             RowBox[{"positiveAcc", "-", "negativeAcc"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"phaseEffects", ",", 
              RowBox[{"Association", "[", 
               RowBox[{
                RowBox[{"\"\<parameter\>\"", "->", 
                 RowBox[{"paramNames", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                RowBox[{"\"\<positiveAccuracy\>\"", "->", "positiveAcc"}], 
                ",", 
                RowBox[{"\"\<negativeAccuracy\>\"", "->", "negativeAcc"}], 
                ",", 
                RowBox[{"\"\<effect\>\"", "->", "effect"}]}], "]"}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{
              RowBox[{"paramNames", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "\"\< effect: \>\"", ",", 
              
              RowBox[{"N", "[", 
               RowBox[{"effect", ",", "4"}], "]"}], ",", "\"\< (\>\"", ",", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"100", "*", "effect"}], ",", "2"}], "]"}], ",", 
              "\"\< percentage points)\>\""}], "]"}]}]}], "]"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Phase Parameter Effects Summary:\>\"", ",", "Bold"}], 
         "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"phaseEffects", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<parameter\>\"", 
                "]"}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"phaseEffects", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  "\"\<positiveAccuracy\>\"", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"phaseEffects", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  "\"\<negativeAccuracy\>\"", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"phaseEffects", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<effect\>\"", 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "phaseEffects", "]"}]}], "}"}]}], "]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Parameter\>\"", ",", "\"\<Positive Accuracy\>\"", ",", 
             "\"\<Negative Accuracy\>\"", ",", "\"\<Effect\>\""}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"Frame", "->", "All"}], ",", 
         RowBox[{"Alignment", "->", "Center"}], ",", 
         RowBox[{"Background", "->", 
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"{", 
             RowBox[{"LightGray", ",", "None", ",", "None", ",", "None"}], 
             "}"}]}], "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "phaseEffects"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PlotCrisisConvergence", "[", "input_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "playerPlot", ",", "outcomePlot", ",", "convergencePlot", ",", 
         "historyTable", ",", "validHistory", ",", "extractValue", ",", 
         "history"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{
        "Helper", " ", "function", " ", "to", " ", "safely", " ", "extract", 
         " ", "values"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"extractValue", "[", 
          RowBox[{"item_", ",", "key_", ",", 
           RowBox[{"default_", ":", "0"}]}], "]"}], ":=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"AssociationQ", "[", "item", "]"}], ",", 
           RowBox[{"Lookup", "[", 
            RowBox[{"item", ",", "key", ",", "default"}], "]"}], ",", 
           RowBox[{
            RowBox[{"ListQ", "[", "item", "]"}], "&&", 
            RowBox[{
             RowBox[{"Length", "[", "item", "]"}], ">=", "1"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NumericQ", "[", 
              RowBox[{"item", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"item", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "default"}], "]"}], ",", 
           RowBox[{"NumericQ", "[", "item", "]"}], ",", "item", ",", "True", 
           ",", "default"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Extract", " ", "the", " ", "history", " ", "from", " ", "the", " ", 
          "input"}], "*)"}], 
        RowBox[{"history", "=", 
         RowBox[{"Which", "[", 
          RowBox[{"(*", 
           RowBox[{
           "If", " ", "input", " ", "is", " ", "an", " ", "Association", " ", 
            "with", " ", "\"\<IterationHistory\>\"", " ", "key", " ", 
            RowBox[{"(", 
             RowBox[{"your", " ", "format"}], ")"}]}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"AssociationQ", "[", "input", "]"}], "&&", 
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{"input", ",", "\"\<IterationHistory\>\""}], "]"}]}], ",", 
           RowBox[{"input", "[", "\"\<IterationHistory\>\"", "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{
            "If", " ", "input", " ", "is", " ", "already", " ", "a", " ", 
             "list", " ", 
             RowBox[{"(", 
              RowBox[{"legacy", " ", "format"}], ")"}]}], "*)"}], 
           RowBox[{"ListQ", "[", "input", "]"}], ",", "input", ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Default", ":", 
              RowBox[{"assume", " ", 
               RowBox[{"it", "'"}], "s", " ", "a", " ", "single", " ", 
               "item"}]}], ",", 
             RowBox[{"wrap", " ", "in", " ", "list"}]}], "*)"}], "True", ",", 
           
           RowBox[{"{", "input", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Debug", " ", "information"}], "*)"}], "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Check", " ", "if", " ", "history", " ", "is", " ", "empty", " ", 
          "or", " ", "invalid"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "history", "]"}], "==", "0"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Warning: Empty history provided\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Text", "[", 
                  RowBox[{"\"\<No data available\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
                RowBox[{"PlotLabel", "->", "\"\<No data available\>\""}], ",", 
                RowBox[{"PlotRange", "->", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}],
               ",", 
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Text", "[", 
                  RowBox[{"\"\<No data available\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
                RowBox[{"PlotLabel", "->", "\"\<No data available\>\""}], ",", 
                RowBox[{"PlotRange", "->", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}],
               ",", 
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Text", "[", 
                  RowBox[{"\"\<No data available\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
                RowBox[{"PlotLabel", "->", "\"\<No data available\>\""}], ",", 
                RowBox[{"PlotRange", "->", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}],
               ",", 
              RowBox[{"Grid", "[", 
               RowBox[{"{", 
                RowBox[{"{", "\"\<No iteration data available\>\"", "}"}], 
                "}"}], "]"}]}], "}"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Handle", " ", "different", " ", "input", " ", "formats"}], 
          "-", 
          RowBox[{
          "history", " ", "should", " ", "now", " ", "be", " ", "the", " ", 
           "iteration", " ", "list"}]}], "*)"}], 
        RowBox[{"validHistory", "=", 
         RowBox[{"Which", "[", 
          RowBox[{"(*", 
           RowBox[{"If", " ", 
            RowBox[{"it", "'"}], "s", " ", "a", " ", "list", " ", "of", " ", 
            "associations", " ", 
            RowBox[{"(", 
             RowBox[{"expected", " ", "format"}], ")"}]}], "*)"}], 
          RowBox[{
           RowBox[{"AllTrue", "[", 
            RowBox[{"history", ",", "AssociationQ"}], "]"}], ",", "history", 
           ",", 
           RowBox[{"(*", 
            RowBox[{"If", " ", 
             RowBox[{"it", "'"}], "s", " ", "a", " ", "list", " ", "of", " ", 
             "lists", " ", 
             RowBox[{"(", 
              RowBox[{"convert", " ", "to", " ", "associations"}], ")"}]}], 
            "*)"}], 
           RowBox[{"AllTrue", "[", 
            RowBox[{"history", ",", "ListQ"}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"\"\<Iteration\>\"", "->", 
                RowBox[{"i", "-", "1"}]}], ",", 
               RowBox[{"\"\<pF1\>\"", "->", 
                RowBox[{"extractValue", "[", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "1", ",", "0.5"}], 
                 "]"}]}], ",", 
               RowBox[{"\"\<pF2\>\"", "->", 
                RowBox[{"extractValue", "[", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "2", ",", "0.5"}], 
                 "]"}]}], ",", 
               RowBox[{"\"\<pWar\>\"", "->", 
                RowBox[{"extractValue", "[", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "3", ",", "0.25"}], 
                 "]"}]}], ",", 
               RowBox[{"\"\<pCap1\>\"", "->", 
                RowBox[{"extractValue", "[", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "4", ",", "0.25"}], 
                 "]"}]}], ",", 
               RowBox[{"\"\<pCap2\>\"", "->", 
                RowBox[{"extractValue", "[", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "5", ",", "0.25"}], 
                 "]"}]}], ",", 
               RowBox[{"\"\<pNego\>\"", "->", 
                RowBox[{"extractValue", "[", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "6", ",", "0.25"}], 
                 "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "history", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{"If", " ", 
             RowBox[{"it", "'"}], "s", " ", "a", " ", "list", " ", "of", " ", 
             "numbers", " ", 
             RowBox[{"(", 
              RowBox[{
              "assume", " ", "they", " ", "are", " ", "pF1", " ", "values"}], 
              ")"}]}], "*)"}], 
           RowBox[{"AllTrue", "[", 
            RowBox[{"history", ",", "NumericQ"}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"\"\<Iteration\>\"", "->", 
                RowBox[{"i", "-", "1"}]}], ",", 
               RowBox[{"\"\<pF1\>\"", "->", 
                RowBox[{"history", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pF2\>\"", "->", "0.5"}], ",", 
               RowBox[{"\"\<pWar\>\"", "->", "0.25"}], ",", 
               RowBox[{"\"\<pCap1\>\"", "->", "0.25"}], ",", 
               RowBox[{"\"\<pCap2\>\"", "->", "0.25"}], ",", 
               RowBox[{"\"\<pNego\>\"", "->", "0.25"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "history", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{"Default", ":", 
             RowBox[{
             "try", " ", "to", " ", "extract", " ", "what", " ", "we", " ", 
              "can"}]}], "*)"}], "True", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"\"\<Iteration\>\"", "->", 
                RowBox[{"i", "-", "1"}]}], ",", 
               RowBox[{"\"\<pF1\>\"", "->", 
                RowBox[{"extractValue", "[", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pF1\>\"", ",", 
                  "0.5"}], "]"}]}], ",", 
               RowBox[{"\"\<pF2\>\"", "->", 
                RowBox[{"extractValue", "[", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pF2\>\"", ",", 
                  "0.5"}], "]"}]}], ",", 
               RowBox[{"\"\<pWar\>\"", "->", 
                RowBox[{"extractValue", "[", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pWar\>\"", ",", 
                  "0.25"}], "]"}]}], ",", 
               RowBox[{"\"\<pCap1\>\"", "->", 
                RowBox[{"extractValue", "[", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pCap1\>\"", ",", 
                  "0.25"}], "]"}]}], ",", 
               RowBox[{"\"\<pCap2\>\"", "->", 
                RowBox[{"extractValue", "[", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pCap2\>\"", ",", 
                  "0.25"}], "]"}]}], ",", 
               RowBox[{"\"\<pNego\>\"", "->", 
                RowBox[{"extractValue", "[", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pNego\>\"", ",", 
                  "0.25"}], "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "history", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Processed history length: \>\"", ",", 
          RowBox[{"Length", "[", "validHistory", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "validHistory", "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Sample processed element: \>\"", ",", 
             RowBox[{"validHistory", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Player", " ", "fight", " ", "probabilities"}], "*)"}], 
        RowBox[{"playerPlot", "=", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pF1\>\"", 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pF2\>\"", 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"PlotLegends", "->", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Player 1 P(F1)\>\"", ",", "\"\<Player 2 P(F2)\>\""}], 
             "}"}]}], ",", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<Iteration\>\"", ",", "\"\<Probability\>\""}], 
             "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "->", "\"\<Convergence of Fight Probabilities\>\""}], 
           ",", 
           RowBox[{"Joined", "->", "True"}], ",", 
           RowBox[{"Mesh", "->", "All"}], ",", 
           RowBox[{"PlotMarkers", "->", "Automatic"}], ",", 
           RowBox[{"GridLines", "->", "Automatic"}], ",", 
           RowBox[{"PlotRange", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "->", "500"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Outcome", " ", "probabilities"}], "*)"}], 
        RowBox[{"outcomePlot", "=", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pWar\>\"", 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pCap2\>\"", 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pCap1\>\"", 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pNego\>\"", 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"PlotLegends", "->", 
            RowBox[{"{", 
             RowBox[{
             "\"\<P(War)\>\"", ",", "\"\<P(Cap2)\>\"", ",", "\"\<P(Cap1)\>\"",
               ",", "\"\<P(Nego)\>\""}], "}"}]}], ",", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<Iteration\>\"", ",", "\"\<Probability\>\""}], 
             "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "->", 
            "\"\<Convergence of Crisis Outcome Probabilities\>\""}], ",", 
           RowBox[{"Joined", "->", "True"}], ",", 
           RowBox[{"Mesh", "->", "All"}], ",", 
           RowBox[{"PlotMarkers", "->", "Automatic"}], ",", 
           RowBox[{"GridLines", "->", "Automatic"}], ",", 
           RowBox[{"PlotRange", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{"Red", ",", "Orange", ",", "Green", ",", "Blue"}], 
             "}"}]}], ",", 
           RowBox[{"ImageSize", "->", "500"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Convergence", " ", "rate"}], "-", 
          RowBox[{
          "only", " ", "if", " ", "we", " ", "have", " ", "delta", " ", 
           "information"}]}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "validHistory", "]"}], ">", "1"}], "&&", 
           RowBox[{"AnyTrue", "[", 
            RowBox[{"validHistory", ",", 
             RowBox[{
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{"#", ",", "\"\<DeltapF1\>\""}], "]"}], "&"}]}], 
            "]"}]}], ",", 
          RowBox[{"convergencePlot", "=", 
           RowBox[{"ListLogPlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                    "]"}], ",", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<DeltapF1\>\"", 
                    ",", "0.0001"}], "]"}], ",", "0.0001"}], "]"}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", 
                   RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
                "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                    "]"}], ",", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<DeltapF2\>\"", 
                    ",", "0.0001"}], "]"}], ",", "0.0001"}], "]"}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", 
                   RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
                "]"}]}], "}"}], ",", 
             RowBox[{"PlotLegends", "->", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Player 1 \[CapitalDelta]P(F1)\>\"", ",", 
                "\"\<Player 2 \[CapitalDelta]P(F2)\>\""}], "}"}]}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Iteration\>\"", ",", "\"\<Log(\[CapitalDelta]p)\>\""}], 
               "}"}]}], ",", 
             RowBox[{
             "PlotLabel", "->", "\"\<Convergence Rate (Log Scale)\>\""}], ",", 
             RowBox[{"Joined", "->", "True"}], ",", 
             RowBox[{"GridLines", "->", "Automatic"}], ",", 
             RowBox[{"PlotStyle", "->", 
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", 
             RowBox[{"ImageSize", "->", "500"}]}], "]"}]}], ",", 
          RowBox[{"convergencePlot", "=", 
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Text", "[", 
               RowBox[{"\"\<No convergence data available\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
             RowBox[{"PlotLabel", "->", "\"\<Convergence Rate\>\""}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Iteration", " ", "table", " ", "with", " ", "convergence", " ", 
          "information"}], "*)"}], 
        RowBox[{"historyTable", "=", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Iteration\>\"", ",", "\"\<P(F1)\>\"", ",", "\"\<P(F2)\>\"",
                ",", "\"\<\[CapitalDelta]P(F1)\>\"", ",", 
               "\"\<\[CapitalDelta]P(F2)\>\"", ",", "\"\<P(War)\>\"", ",", 
               "\"\<P(Cap1)\>\"", ",", "\"\<P(Cap2)\>\"", ",", 
               "\"\<P(Nego)\>\""}], "}"}], "}"}], "~", "Join", "~", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"validHistory", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                 "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pF1\>\"", "]"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pF2\>\"", "]"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<DeltapF1\>\""}],
                    "]"}], ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<DeltapF1\>\"", 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  "\"\<-\>\""}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<DeltapF2\>\""}],
                    "]"}], ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<DeltapF2\>\"", 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  "\"\<-\>\""}], "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pWar\>\"", 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pCap1\>\"", 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pCap2\>\"", 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pNego\>\"", 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"Length", "[", "validHistory", "]"}], ",", "15"}], 
                 "]"}]}], "}"}]}], "]"}]}], ",", 
           RowBox[{"Frame", "->", "All"}], ",", 
           RowBox[{"Alignment", "->", "Center"}], ",", 
           RowBox[{"Background", "->", 
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"{", 
               RowBox[{"LightGray", ",", "None"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ItemStyle", "->", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", 
              RowBox[{"{", 
               RowBox[{"Bold", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Spacings", "->", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Add", " ", "summary", " ", "information", " ", "at", " ", "the", 
          " ", "end"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AssociationQ", "[", "input", "]"}], "&&", 
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{"input", ",", "\"\<Converged\>\""}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<=== CONVERGENCE SUMMARY ===\>\"", "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Converged: \>\"", ",", 
             RowBox[{"input", "[", "\"\<Converged\>\"", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Total Iterations: \>\"", ",", 
             RowBox[{"input", "[", "\"\<Iterations\>\"", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Final P(F1): \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"input", "[", "\"\<pF1\>\"", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Final P(F2): \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"input", "[", "\"\<pF2\>\"", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Final P(War): \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"input", "[", "\"\<pWar\>\"", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Final P(Cap1): \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"input", "[", "\"\<pCap1\>\"", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Final P(Cap2): \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"input", "[", "\"\<pCap2\>\"", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Final P(Nego): \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"input", "[", "\"\<pNego\>\"", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<==========================\>\"", "]"}], 
           ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Return", " ", "all", " ", "visualizations"}], "*)"}], 
        RowBox[{"{", 
         RowBox[{
         "playerPlot", ",", "outcomePlot", ",", "convergencePlot", ",", 
          "historyTable"}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PlotDemandsConvergence", "[", "input_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "playerPlot", ",", "outcomePlot", ",", "convergencePlot", ",", 
         "historyTable", ",", "validHistory", ",", "extractValue", ",", 
         "history", ",", "evaluateExpression"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{
        "Helper", " ", "function", " ", "to", " ", "safely", " ", "extract", 
         " ", "and", " ", "evaluate", " ", "values"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"extractValue", "[", 
          RowBox[{"item_", ",", "key_", ",", 
           RowBox[{"default_", ":", "0"}]}], "]"}], ":=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"AssociationQ", "[", "item", "]"}], ",", 
           RowBox[{"Lookup", "[", 
            RowBox[{"item", ",", "key", ",", "default"}], "]"}], ",", 
           RowBox[{
            RowBox[{"ListQ", "[", "item", "]"}], "&&", 
            RowBox[{
             RowBox[{"Length", "[", "item", "]"}], ">=", "1"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NumericQ", "[", 
              RowBox[{"item", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"item", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "default"}], "]"}], ",", 
           RowBox[{"NumericQ", "[", "item", "]"}], ",", "item", ",", "True", 
           ",", "default"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Helper", " ", "function", " ", "to", " ", "evaluate", " ", 
          "complex", " ", "expressions"}], "*)"}], 
        RowBox[{
         RowBox[{"evaluateExpression", "[", "expr_", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "result", "}"}], ",", 
           RowBox[{
            RowBox[{"result", "=", 
             RowBox[{"Quiet", "[", 
              RowBox[{"N", "[", "expr", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"NumericQ", "[", "result", "]"}], ",", "result", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "result", "]"}], "===", "Complex"}], 
                ",", 
                RowBox[{"Re", "[", "result", "]"}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"If", " ", "still", " ", "not", " ", "numeric"}], 
                  ",", 
                  RowBox[{
                  "try", " ", "to", " ", "extract", " ", "a", " ", 
                   "reasonable", " ", "default"}]}], "*)"}], 
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{"StringMatchQ", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", "result", "]"}], ",", 
                    "\"\<*0.5*\>\""}], "]"}], ",", "0.5", ",", 
                  RowBox[{"StringMatchQ", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", "result", "]"}], ",", 
                    "\"\<*0.25*\>\""}], "]"}], ",", "0.25", ",", "True", ",", 
                  "0.0"}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Extract", " ", "the", " ", "history", " ", "from", " ", "the", " ",
            "input"}], "-", 
          RowBox[{"handle", " ", "the", " ", "specific", " ", "structure"}]}],
          "*)"}], 
        RowBox[{"history", "=", 
         RowBox[{"Which", "[", 
          RowBox[{"(*", 
           RowBox[{
           "If", " ", "input", " ", "is", " ", "an", " ", "Association", " ", 
            "with", " ", "\"\<DemandsIterationHistory\>\"", " ", "key", " ", 
            RowBox[{"(", 
             RowBox[{"your", " ", "format"}], ")"}]}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"AssociationQ", "[", "input", "]"}], "&&", 
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{"input", ",", "\"\<DemandsIterationHistory\>\""}], 
             "]"}]}], ",", 
           RowBox[{"input", "[", "\"\<DemandsIterationHistory\>\"", "]"}], 
           ",", 
           RowBox[{"(*", 
            RowBox[{
            "If", " ", "input", " ", "is", " ", "an", " ", "Association", " ",
              "with", " ", "\"\<IterationHistory\>\"", " ", "key", " ", 
             RowBox[{"(", 
              RowBox[{"legacy", " ", "format"}], ")"}]}], "*)"}], 
           RowBox[{
            RowBox[{"AssociationQ", "[", "input", "]"}], "&&", 
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{"input", ",", "\"\<IterationHistory\>\""}], "]"}]}], ",", 
           RowBox[{"input", "[", "\"\<IterationHistory\>\"", "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{
            "If", " ", "input", " ", "is", " ", "already", " ", "a", " ", 
             "list", " ", 
             RowBox[{"(", 
              RowBox[{"legacy", " ", "format"}], ")"}]}], "*)"}], 
           RowBox[{"ListQ", "[", "input", "]"}], ",", "input", ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Default", ":", 
              RowBox[{"assume", " ", 
               RowBox[{"it", "'"}], "s", " ", "a", " ", "single", " ", 
               "item"}]}], ",", 
             RowBox[{"wrap", " ", "in", " ", "list"}]}], "*)"}], "True", ",", 
           
           RowBox[{"{", "input", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Debug", " ", "information"}], "*)"}], 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Input type: \>\"", ",", 
          RowBox[{"Head", "[", "input", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AssociationQ", "[", "input", "]"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Input keys: \>\"", ",", 
             RowBox[{"Keys", "[", "input", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"input", ",", "\"\<DemandsConverged\>\""}], "]"}], ",", 
             
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Demands Converged: \>\"", ",", 
                RowBox[{"input", "[", "\"\<DemandsConverged\>\"", "]"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Demands Iterations: \>\"", ",", 
                RowBox[{"Lookup", "[", 
                 RowBox[{
                 "input", ",", "\"\<DemandsIterations\>\"", ",", 
                  "\"\<N/A\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Final pD1 (raw): \>\"", ",", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"input", ",", "\"\<pD1\>\"", ",", "\"\<N/A\>\""}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Final pD1 (evaluated): \>\"", ",", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"Lookup", "[", 
                  RowBox[{"input", ",", "\"\<pD1\>\"", ",", "0.5"}], "]"}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Final pD2 (evaluated): \>\"", ",", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"Lookup", "[", 
                  RowBox[{"input", ",", "\"\<pD2\>\"", ",", "0.5"}], "]"}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Final pCrisis (evaluated): \>\"", ",", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"Lookup", "[", 
                  RowBox[{"input", ",", "\"\<pCrisis\>\"", ",", "0.25"}], 
                  "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Final pSQ (evaluated): \>\"", ",", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"Lookup", "[", 
                  RowBox[{"input", ",", "\"\<pSQ\>\"", ",", "0.25"}], "]"}], 
                 "]"}]}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<History length: \>\"", ",", 
          RowBox[{"Length", "[", "history", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "history", "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<First element type: \>\"", ",", 
             RowBox[{"Head", "[", 
              RowBox[{"history", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"AssociationQ", "[", 
              RowBox[{"history", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Keys in first element: \>\"", ",", 
                RowBox[{"Keys", "[", 
                 RowBox[{"history", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";"}]}], 
            "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Check", " ", "if", " ", "history", " ", "is", " ", "empty", " ", 
          "or", " ", "invalid"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "history", "]"}], "==", "0"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Warning: Empty history provided\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Text", "[", 
                  RowBox[{"\"\<No data available\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
                RowBox[{"PlotLabel", "->", "\"\<No data available\>\""}], ",", 
                RowBox[{"PlotRange", "->", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}],
               ",", 
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Text", "[", 
                  RowBox[{"\"\<No data available\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
                RowBox[{"PlotLabel", "->", "\"\<No data available\>\""}], ",", 
                RowBox[{"PlotRange", "->", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}],
               ",", 
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Text", "[", 
                  RowBox[{"\"\<No data available\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
                RowBox[{"PlotLabel", "->", "\"\<No data available\>\""}], ",", 
                RowBox[{"PlotRange", "->", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}],
               ",", 
              RowBox[{"Grid", "[", 
               RowBox[{"{", 
                RowBox[{"{", "\"\<No iteration data available\>\"", "}"}], 
                "}"}], "]"}]}], "}"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Handle", " ", "different", " ", "input", " ", "formats"}], 
          "-", 
          RowBox[{
          "history", " ", "should", " ", "now", " ", "be", " ", "the", " ", 
           "iteration", " ", "list"}]}], "*)"}], 
        RowBox[{"validHistory", "=", 
         RowBox[{"Which", "[", 
          RowBox[{"(*", 
           RowBox[{"If", " ", 
            RowBox[{"it", "'"}], "s", " ", "a", " ", "list", " ", "of", " ", 
            "associations", " ", 
            RowBox[{"(", 
             RowBox[{"expected", " ", "format"}], ")"}]}], "*)"}], 
          RowBox[{
           RowBox[{"AllTrue", "[", 
            RowBox[{"history", ",", "AssociationQ"}], "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{
            "Process", " ", "each", " ", "association", " ", "to", " ", 
             "evaluate", " ", "complex", " ", "expressions"}], "*)"}], 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"\"\<Iteration\>\"", "->", 
                RowBox[{"extractValue", "[", 
                 RowBox[{
                  RowBox[{"history", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Iteration\>\"", 
                  ",", 
                  RowBox[{"i", "-", "1"}]}], "]"}]}], ",", 
               RowBox[{"\"\<pD1\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pD1\>\"", ",", 
                   "0.5"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pD2\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pD2\>\"", ",", 
                   "0.5"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pCrisis\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pCrisis\>\"", 
                   ",", "0.25"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pAcq1\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pAcq1\>\"", ",",
                    "0.25"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pAcq2\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pAcq2\>\"", ",",
                    "0.25"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pSQ\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pSQ\>\"", ",", 
                   "0.25"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<DeltapD1\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<DeltapD1\>\""}],
                    "]"}], ",", 
                  RowBox[{"evaluateExpression", "[", 
                   RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<DeltapD1\>\"", 
                    "]"}], "]"}], ",", "Undefined"}], "]"}]}], ",", 
               RowBox[{"\"\<DeltapD2\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<DeltapD2\>\""}],
                    "]"}], ",", 
                  RowBox[{"evaluateExpression", "[", 
                   RowBox[{
                    RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<DeltapD2\>\"", 
                    "]"}], "]"}], ",", "Undefined"}], "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "history", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{"If", " ", 
             RowBox[{"it", "'"}], "s", " ", "a", " ", "list", " ", "of", " ", 
             "lists", " ", 
             RowBox[{"(", 
              RowBox[{"convert", " ", "to", " ", "associations"}], ")"}]}], 
            "*)"}], 
           RowBox[{"AllTrue", "[", 
            RowBox[{"history", ",", "ListQ"}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"\"\<Iteration\>\"", "->", 
                RowBox[{"i", "-", "1"}]}], ",", 
               RowBox[{"\"\<pD1\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "1", ",", "0.5"}], 
                  "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pD2\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "2", ",", "0.5"}], 
                  "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pCrisis\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "3", ",", "0.25"}], 
                  "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pAcq1\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "4", ",", "0.25"}], 
                  "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pAcq2\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "5", ",", "0.25"}], 
                  "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pSQ\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "6", ",", "0.25"}], 
                  "]"}], "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "history", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{"If", " ", 
             RowBox[{"it", "'"}], "s", " ", "a", " ", "list", " ", "of", " ", 
             "numbers", " ", 
             RowBox[{"(", 
              RowBox[{
              "assume", " ", "they", " ", "are", " ", "pD1", " ", "values"}], 
              ")"}]}], "*)"}], 
           RowBox[{"AllTrue", "[", 
            RowBox[{"history", ",", "NumericQ"}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"\"\<Iteration\>\"", "->", 
                RowBox[{"i", "-", "1"}]}], ",", 
               RowBox[{"\"\<pD1\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"history", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pD2\>\"", "->", "0.5"}], ",", 
               RowBox[{"\"\<pCrisis\>\"", "->", "0.25"}], ",", 
               RowBox[{"\"\<pAcq1\>\"", "->", "0.25"}], ",", 
               RowBox[{"\"\<pAcq2\>\"", "->", "0.25"}], ",", 
               RowBox[{"\"\<pSQ\>\"", "->", "0.25"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "history", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{"Default", ":", 
             RowBox[{
             "try", " ", "to", " ", "extract", " ", "what", " ", "we", " ", 
              "can"}]}], "*)"}], "True", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"\"\<Iteration\>\"", "->", 
                RowBox[{"i", "-", "1"}]}], ",", 
               RowBox[{"\"\<pD1\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pD1\>\"", ",", 
                   "0.5"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pD2\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pD2\>\"", ",", 
                   "0.5"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pCrisis\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pCrisis\>\"", 
                   ",", "0.25"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pAcq1\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pAcq1\>\"", ",",
                    "0.25"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pAcq2\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pAcq2\>\"", ",",
                    "0.25"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<pSQ\>\"", "->", 
                RowBox[{"evaluateExpression", "[", 
                 RowBox[{"extractValue", "[", 
                  RowBox[{
                   RowBox[{"history", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<pSQ\>\"", ",", 
                   "0.25"}], "]"}], "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "history", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Processed history length: \>\"", ",", 
          RowBox[{"Length", "[", "validHistory", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "validHistory", "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Sample processed element: \>\"", ",", 
             RowBox[{"validHistory", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Player", " ", "demand", " ", "probabilities"}], "*)"}], 
        RowBox[{"playerPlot", "=", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pD1\>\"", 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pD2\>\"", 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"PlotLegends", "->", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Player 1 P(D1)\>\"", ",", "\"\<Player 2 P(D2)\>\""}], 
             "}"}]}], ",", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<Iteration\>\"", ",", "\"\<Probability\>\""}], 
             "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "->", "\"\<Convergence of Demand Probabilities\>\""}],
            ",", 
           RowBox[{"Joined", "->", "True"}], ",", 
           RowBox[{"Mesh", "->", "All"}], ",", 
           RowBox[{"PlotMarkers", "->", "Automatic"}], ",", 
           RowBox[{"GridLines", "->", "Automatic"}], ",", 
           RowBox[{"PlotRange", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{"Green", ",", "Orange"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "->", "500"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Outcome", " ", "probabilities"}], "*)"}], 
        RowBox[{"outcomePlot", "=", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pCrisis\>\"", 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pAcq2\>\"", 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pAcq1\>\"", 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"validHistory", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pSQ\>\"", 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"PlotLegends", "->", 
            RowBox[{"{", 
             RowBox[{
             "\"\<P(Crisis)\>\"", ",", "\"\<P(Acq2)\>\"", ",", 
              "\"\<P(Acq1)\>\"", ",", "\"\<P(SQ)\>\""}], "}"}]}], ",", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<Iteration\>\"", ",", "\"\<Probability\>\""}], 
             "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "->", 
            "\"\<Convergence of Demands Outcome Probabilities\>\""}], ",", 
           RowBox[{"Joined", "->", "True"}], ",", 
           RowBox[{"Mesh", "->", "All"}], ",", 
           RowBox[{"PlotMarkers", "->", "Automatic"}], ",", 
           RowBox[{"GridLines", "->", "Automatic"}], ",", 
           RowBox[{"PlotRange", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{"Red", ",", "Orange", ",", "Green", ",", "Blue"}], 
             "}"}]}], ",", 
           RowBox[{"ImageSize", "->", "500"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Convergence", " ", "rate"}], "-", 
          RowBox[{
          "only", " ", "if", " ", "we", " ", "have", " ", "delta", " ", 
           "information"}]}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "validHistory", "]"}], ">", "1"}], "&&", 
           RowBox[{"AnyTrue", "[", 
            RowBox[{"validHistory", ",", 
             RowBox[{
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{"#", ",", "\"\<DeltapD1\>\""}], "]"}], "&"}]}], 
            "]"}]}], ",", 
          RowBox[{"convergencePlot", "=", 
           RowBox[{"ListLogPlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                    "]"}], ",", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<DeltapD1\>\"", 
                    ",", "0.0001"}], "]"}], ",", "0.0001"}], "]"}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", 
                   RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
                "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                    "]"}], ",", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<DeltapD2\>\"", 
                    ",", "0.0001"}], "]"}], ",", "0.0001"}], "]"}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", 
                   RowBox[{"Length", "[", "validHistory", "]"}]}], "}"}]}], 
                "]"}]}], "}"}], ",", 
             RowBox[{"PlotLegends", "->", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Player 1 \[CapitalDelta]P(D1)\>\"", ",", 
                "\"\<Player 2 \[CapitalDelta]P(D2)\>\""}], "}"}]}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Iteration\>\"", ",", "\"\<Log(\[CapitalDelta]p)\>\""}], 
               "}"}]}], ",", 
             RowBox[{
             "PlotLabel", "->", 
              "\"\<Demands Convergence Rate (Log Scale)\>\""}], ",", 
             RowBox[{"Joined", "->", "True"}], ",", 
             RowBox[{"GridLines", "->", "Automatic"}], ",", 
             RowBox[{"PlotStyle", "->", 
              RowBox[{"{", 
               RowBox[{"Green", ",", "Orange"}], "}"}]}], ",", 
             RowBox[{"ImageSize", "->", "500"}]}], "]"}]}], ",", 
          RowBox[{"convergencePlot", "=", 
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Text", "[", 
               RowBox[{"\"\<No convergence data available\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
             RowBox[{"PlotLabel", "->", "\"\<Demands Convergence Rate\>\""}], 
             ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Iteration", " ", "table", " ", "with", " ", "convergence", " ", 
          "information"}], "*)"}], 
        RowBox[{"historyTable", "=", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Iteration\>\"", ",", "\"\<P(D1)\>\"", ",", "\"\<P(D2)\>\"",
                ",", "\"\<\[CapitalDelta]P(D1)\>\"", ",", 
               "\"\<\[CapitalDelta]P(D2)\>\"", ",", "\"\<P(Crisis)\>\"", ",", 
               "\"\<P(Acq1)\>\"", ",", "\"\<P(Acq2)\>\"", ",", 
               "\"\<P(SQ)\>\""}], "}"}], "}"}], "~", "Join", "~", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"validHistory", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<Iteration\>\"", 
                 "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pD1\>\"", "]"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pD2\>\"", "]"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<DeltapD1\>\""}],
                    "]"}], ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<DeltapD1\>\"", 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  "\"\<-\>\""}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<DeltapD2\>\""}],
                    "]"}], ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<DeltapD2\>\"", 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                  "\"\<-\>\""}], "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pCrisis\>\"", 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pAcq1\>\"", 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pAcq2\>\"", 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"validHistory", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<pSQ\>\"", "]"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"Length", "[", "validHistory", "]"}], ",", "15"}], 
                 "]"}]}], "}"}]}], "]"}]}], ",", 
           RowBox[{"Frame", "->", "All"}], ",", 
           RowBox[{"Alignment", "->", "Center"}], ",", 
           RowBox[{"Background", "->", 
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"{", 
               RowBox[{"LightGray", ",", "None"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ItemStyle", "->", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", 
              RowBox[{"{", 
               RowBox[{"Bold", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Spacings", "->", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Add", " ", "summary", " ", "information", " ", "at", " ", "the", 
          " ", "end"}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AssociationQ", "[", "input", "]"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", "\"\<=== DEMANDS CONVERGENCE SUMMARY ===\>\"", "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"input", ",", "\"\<DemandsConverged\>\""}], "]"}], ",", 
             
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Demands Converged: \>\"", ",", 
                RowBox[{"input", "[", "\"\<DemandsConverged\>\"", "]"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Total Iterations: \>\"", ",", 
                RowBox[{"Lookup", "[", 
                 RowBox[{
                 "input", ",", "\"\<DemandsIterations\>\"", ",", 
                  "\"\<N/A\>\""}], "]"}]}], "]"}], ";"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Converged: \>\"", ",", 
                RowBox[{"Lookup", "[", 
                 RowBox[{
                 "input", ",", "\"\<Converged\>\"", ",", "\"\<N/A\>\""}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Total Iterations: \>\"", ",", 
                RowBox[{"Lookup", "[", 
                 RowBox[{
                 "input", ",", "\"\<Iterations\>\"", ",", "\"\<N/A\>\""}], 
                 "]"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Final P(D1): \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"evaluateExpression", "[", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"input", ",", "\"\<pD1\>\"", ",", "0"}], "]"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Final P(D2): \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"evaluateExpression", "[", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"input", ",", "\"\<pD2\>\"", ",", "0"}], "]"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Final P(Crisis): \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"evaluateExpression", "[", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"input", ",", "\"\<pCrisis\>\"", ",", "0"}], "]"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Final P(Acq1): \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"evaluateExpression", "[", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"input", ",", "\"\<pAcq1\>\"", ",", "0"}], "]"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Final P(Acq2): \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"evaluateExpression", "[", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"input", ",", "\"\<pAcq2\>\"", ",", "0"}], "]"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Final P(SQ): \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"evaluateExpression", "[", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"input", ",", "\"\<pSQ\>\"", ",", "0"}], "]"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Total Probability: \>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"evaluateExpression", "[", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"input", ",", "\"\<TotalProb\>\"", ",", "1"}], "]"}],
                 "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"input", ",", "\"\<ExpectedUtility1\>\""}], "]"}], ",", 
             
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Expected Utility 1: \>\"", ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{"evaluateExpression", "[", 
                   RowBox[{"Lookup", "[", 
                    RowBox[{
                    "input", ",", "\"\<ExpectedUtility1\>\"", ",", "0"}], 
                    "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"input", ",", "\"\<ExpectedUtility2\>\""}], "]"}], ",", 
             
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Expected Utility 2: \>\"", ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{"evaluateExpression", "[", 
                   RowBox[{"Lookup", "[", 
                    RowBox[{
                    "input", ",", "\"\<ExpectedUtility2\>\"", ",", "0"}], 
                    "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", "\"\<=================================\>\"", "]"}], 
           ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Return", " ", "all", " ", "visualizations"}], "*)"}], 
        RowBox[{"{", 
         RowBox[{
         "playerPlot", ",", "outcomePlot", ",", "convergencePlot", ",", 
          "historyTable"}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getFirstNEntries", "[", 
     RowBox[{"resultAllData_", ",", "N_Integer"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "extractedEntries", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Input", " ", "validation"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"ListQ", "[", "resultAllData", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Error: resultAllData must be a list\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"N", "<=", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Error: N must be a positive integer\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "resultAllData", "]"}], "==", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Warning: resultAllData is empty\>\"", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Extract", " ", "only", " ", "the", " ", "specified", " ", 
         "components", " ", "from", " ", "each", " ", "entry"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"extractedEntries", "=", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"entry", ",", "utils"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"entry", "=", 
              RowBox[{"resultAllData", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"utils", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{"entry", ",", "\"\<utilities\>\""}], "]"}], ",", 
                RowBox[{"entry", "[", "\"\<utilities\>\"", "]"}], ",", 
                RowBox[{"Association", "[", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Association", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\"\<SQ\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"entry", ",", "\"\<SQ\>\""}], "]"}], ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{"entry", "[", "\"\<SQ\>\"", "]"}], ",", 
                    "0.0001"}], "]"}], ",", "0"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<ACQ1\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"entry", ",", "\"\<ACQ1\>\""}], "]"}], ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{"entry", "[", "\"\<ACQ1\>\"", "]"}], ",", 
                    "0.0001"}], "]"}], ",", "0"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<ACQ2\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"entry", ",", "\"\<ACQ2\>\""}], "]"}], ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{"entry", "[", "\"\<ACQ2\>\"", "]"}], ",", 
                    "0.0001"}], "]"}], ",", "0"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<NEGO\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"entry", ",", "\"\<NEGO\>\""}], "]"}], ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{"entry", "[", "\"\<NEGO\>\"", "]"}], ",", 
                    "0.0001"}], "]"}], ",", "0"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<CAP1\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"entry", ",", "\"\<CAP1\>\""}], "]"}], ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{"entry", "[", "\"\<CAP1\>\"", "]"}], ",", 
                    "0.0001"}], "]"}], ",", "0"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<CAP2\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"entry", ",", "\"\<CAP2\>\""}], "]"}], ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{"entry", "[", "\"\<CAP2\>\"", "]"}], ",", 
                    "0.0001"}], "]"}], ",", "0"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<WAR1\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"entry", ",", "\"\<WAR1\>\""}], "]"}], ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{"entry", "[", "\"\<WAR1\>\"", "]"}], ",", 
                    "0.0001"}], "]"}], ",", "0"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<WAR2\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"entry", ",", "\"\<WAR2\>\""}], "]"}], ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{"entry", "[", "\"\<WAR2\>\"", "]"}], ",", 
                    "0.0001"}], "]"}], ",", "0"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<prediction\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"entry", ",", "\"\<prediction\>\""}], "]"}], ",", 
                  RowBox[{"entry", "[", "\"\<prediction\>\"", "]"}], ",", 
                  "\"\<UNKNOWN\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<groundtruth\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"entry", ",", "\"\<groundtruth\>\""}], "]"}], ",", 
                  
                  RowBox[{"entry", "[", "\"\<groundtruth\>\"", "]"}], ",", 
                  "\"\<UNKNOWN\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<Agent1\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"utils", ",", "\"\<Agent1\>\""}], "]"}], ",", 
                  RowBox[{"utils", "[", "\"\<Agent1\>\"", "]"}], ",", 
                  "\"\<UNKNOWN\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<Agent2\>\"", "->", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"utils", ",", "\"\<Agent2\>\""}], "]"}], ",", 
                  RowBox[{"utils", "[", "\"\<Agent2\>\"", "]"}], ",", 
                  "\"\<UNKNOWN\>\""}], "]"}]}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Min", "[", 
             RowBox[{"N", ",", 
              RowBox[{"Length", "[", "resultAllData", "]"}]}], "]"}]}], 
           "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Return", " ", "extracted", " ", "entries", " ", "with", " ", 
         "informative", " ", "message"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"N", ">=", 
          RowBox[{"Length", "[", "resultAllData", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Note: Requested \>\"", ",", "N", ",", 
            "\"\< entries but only \>\"", ",", 
            RowBox[{"Length", "[", "resultAllData", "]"}], ",", 
            "\"\< available. Returning all entries with extracted components.\
\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "extractedEntries", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Returning first \>\"", ",", "N", ",", 
            "\"\< entries out of \>\"", ",", 
            RowBox[{"Length", "[", "resultAllData", "]"}], ",", 
            "\"\< total entries with extracted components.\>\""}], "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "extractedEntries", "]"}]}]}], "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.958608814298029*^9, 3.958608814298029*^9}, {
   3.958608860738695*^9, 3.95860886187409*^9}, {3.9586098524393177`*^9, 
   3.9586098736481895`*^9}, {3.9586099095927944`*^9, 
   3.9586099100425377`*^9}, {3.958609940998293*^9, 3.958609964748398*^9}, {
   3.958610311915825*^9, 3.9586103236039753`*^9}, 3.9586103818731785`*^9, 
   3.9586106008140793`*^9, {3.958610749971945*^9, 3.958610771865528*^9}, 
   3.9586110995419445`*^9, {3.9586111552648525`*^9, 3.9586111824618626`*^9}, 
   3.9586112182256966`*^9, {3.9586114060504208`*^9, 3.9586114409790134`*^9}, {
   3.9586117816635017`*^9, 3.9586117823242054`*^9}, {3.958613894988079*^9, 
   3.9586138957421227`*^9}, {3.958614105200079*^9, 3.9586141446431065`*^9}, {
   3.9586143230394173`*^9, 3.9586143237507286`*^9}, {3.9586157563111916`*^9, 
   3.9586157568079376`*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"6aaf89cb-3213-9b43-8d50-f829eb0079b3"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Experiments", "Section",
 CellChangeTimes->{{3.958608760118393*^9, 
  3.958608763013691*^9}},ExpressionUUID->"39735c4d-5e12-1e42-8678-\
65451bedadf4"],

Cell[CellGroupData[{

Cell["Balanced Dataset", "Subsection",
 CellChangeTimes->{{3.9586087734829464`*^9, 
  3.958608777188633*^9}},ExpressionUUID->"b6a58fec-6180-0d4c-ad5d-\
50bd7b316a96"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "datasetPath", "=", 
   "\"\</Users/162191/Documents/GitHub/quantum_international_interaction_game/\
dataset/balanced_data.csv\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"loadData", "[", "datasetPath", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958609574761196*^9, 3.9586095747621956`*^9}, {
  3.958609625607504*^9, 3.9586096342597656`*^9}, {3.9586380951766663`*^9, 
  3.9586380971069927`*^9}},
 CellLabel->
  "In[362]:=",ExpressionUUID->"d02dd267-9c95-8c42-9839-ef268b90c4f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lambda", "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dt1", "=", "Pi"}], ";"}], "                    ", 
  RowBox[{"(*", 
   RowBox[{"deltaTheta1", ":", 
    RowBox[{
     RowBox[{"fight", "/", "not"}], " ", "fight", " ", "Player", " ", "1"}]}],
    "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dt2", "=", 
    RowBox[{"3", "*", 
     RowBox[{"Pi", "/", "2"}]}]}], ";"}], "       ", 
  RowBox[{"(*", 
   RowBox[{"deltaTheta2", ":", 
    RowBox[{
     RowBox[{"fight", "/", "not"}], " ", "fight", " ", "Player", " ", "2"}]}],
    "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dt3", "=", "Pi"}], ";"}], "                    ", 
  RowBox[{"(*", 
   RowBox[{"deltaTheta3", ":", 
    RowBox[{
     RowBox[{"demand", "/", "not"}], " ", "demand", " ", "Player", " ", 
     "1"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dt4", "=", 
    RowBox[{"Pi", "/", "2"}]}], ";"}], "             ", 
  RowBox[{"(*", 
   RowBox[{"deltaTheta4", ":", 
    RowBox[{
     RowBox[{"demand", "/", "not"}], " ", "demand", " ", "Player", " ", 
     "2"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"maxIter", "=", "200"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"threshold", "=", "0.000001"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"verboseMode", "=", "True"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9586096452857113`*^9, 3.9586096579401493`*^9}},
 CellLabel->
  "In[364]:=",ExpressionUUID->"b73b6a61-b8fe-3643-9bbb-e054344aa42f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testRowIndex", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "change", " ", "here", " ", "for", " ", "different", " ", "dyads"}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"utils", "=", 
   RowBox[{"extractUtilities", "[", 
    RowBox[{"data", ",", "testRowIndex"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958609702868492*^9, 3.9586097195515137`*^9}, {
  3.958638110577856*^9, 3.95863812094915*^9}},
 CellLabel->
  "In[372]:=",ExpressionUUID->"cd77be64-24fb-9d4a-9ca1-4fc63c12608f"],

Cell[CellGroupData[{

Cell["Crisis Game", "Subsubsection",
 CellChangeTimes->{{3.9586114816770134`*^9, 
  3.958611483980747*^9}},ExpressionUUID->"1465bb6c-c996-2145-a599-\
a6e7c605a62b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"crisisEq", "=", 
   RowBox[{"FindCrisisEquilibrium", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"utils", "[", "\"\<U1War2\>\"", "]"}], " ", "+", " ", 
        RowBox[{"utils", "[", "\"\<U1War1\>\"", "]"}]}], " ", ")"}], "/", 
      "2"}], ",", 
     RowBox[{"utils", "[", "\"\<U1Cap1\>\"", "]"}], ",", 
     RowBox[{"utils", "[", "\"\<U1Cap2\>\"", "]"}], ",", 
     RowBox[{"utils", "[", "\"\<U1Nego\>\"", "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"utils", "[", "\"\<U2War2\>\"", "]"}], " ", "+", " ", 
        RowBox[{"utils", "[", "\"\<U2War1\>\"", "]"}]}], " ", ")"}], "/", 
      "2"}], ",", 
     RowBox[{"utils", "[", "\"\<U2Cap2\>\"", "]"}], ",", 
     RowBox[{"utils", "[", "\"\<U2Cap1\>\"", "]"}], ",", 
     RowBox[{"utils", "[", "\"\<U2Nego\>\"", "]"}], ",", "lambda", ",", "dt1",
      ",", "dt2", ",", "maxIter", ",", "threshold", ",", "verboseMode"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.958609749776287*^9, 3.9586097780956388`*^9}, {
  3.958610024628366*^9, 3.9586100735506325`*^9}, {3.958611457708742*^9, 
  3.958611458485991*^9}, {3.958613303381851*^9, 3.95861331345187*^9}, {
  3.958613369175415*^9, 3.958613377955498*^9}, {3.958613411668964*^9, 
  3.958613465524757*^9}},
 CellLabel->
  "In[374]:=",ExpressionUUID->"54220245-f749-5644-afcf-8e7e342d8aed"],

Cell[BoxData[
 RowBox[{"PlotCrisisConvergence", "[", "crisisEq", "]"}]], "Input",
 CellChangeTimes->{3.958609919416729*^9, 3.9586100777941437`*^9},
 CellLabel->
  "In[375]:=",ExpressionUUID->"bc996225-41a1-1244-b408-9c29124444e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demands Game", "Subsubsection",
 CellChangeTimes->{{3.9586114938965187`*^9, 
  3.958611495612566*^9}},ExpressionUUID->"daf80094-341c-ae45-a1f6-\
d5d90666bfd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fullResult", "=", 
   RowBox[{"FindFullEquilibrium", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"utils", "[", "\"\<U1War2\>\"", "]"}], " ", "+", " ", 
        RowBox[{"utils", "[", "\"\<U1War1\>\"", "]"}]}], " ", ")"}], "/", 
      "2"}], ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"utils", "[", "\"\<U1Cap1\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"utils", "[", "\"\<U1Cap2\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"utils", "[", "\"\<U1Nego\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"utils", "[", "\"\<U1SQ\>\"", "]"}], ",", "\[IndentingNewLine]", 
     "\t\t\t\t\t\t\t", 
     RowBox[{"utils", "[", "\"\<U1Acq1\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"utils", "[", "\"\<U1Acq2\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"utils", "[", "\"\<U2War2\>\"", "]"}], " ", "+", " ", 
        RowBox[{"utils", "[", "\"\<U2War1\>\"", "]"}]}], " ", ")"}], "/", 
      "2"}], ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"utils", "[", "\"\<U2Cap2\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"utils", "[", "\"\<U2Cap1\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"utils", "[", "\"\<U2Nego\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"utils", "[", "\"\<U2SQ\>\"", "]"}], ",", "\[IndentingNewLine]", 
     "\t\t\t\t\t\t\t", 
     RowBox[{"utils", "[", "\"\<U2Acq1\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
     RowBox[{"utils", "[", "\"\<U2Acq2\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "lambda", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "dt1", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "dt2", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "dt3", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "dt4", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "maxIter", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "threshold", ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t\t", "verboseMode"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.958611803023815*^9, 3.958611848121147*^9}, {
  3.9586135177406826`*^9, 3.958613533214855*^9}},
 CellLabel->
  "In[376]:=",ExpressionUUID->"1dabb96a-5127-a843-a86a-949842869eec"],

Cell[BoxData[
 RowBox[{"fullGameConvergenceViz", " ", "=", " ", 
  RowBox[{"PlotDemandsConvergence", "[", 
   RowBox[{"fullResult", "[", "\"\<DemandsIterationHistory\>\"", "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.958612290437441*^9, 3.9586122911382732`*^9}, 
   3.9586141899549026`*^9},
 CellLabel->
  "In[377]:=",ExpressionUUID->"5dabb94d-0c5f-044c-a5d4-7a1745c6207d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Searching for Optimal Params:", "Subsection",
 CellChangeTimes->{{3.958614421128338*^9, 
  3.95861442254698*^9}},ExpressionUUID->"42b04b36-4350-8746-a857-\
693c9a0af76d"],

Cell[CellGroupData[{

Cell["Setting 1: Lamda1 = 1 | Lambda2 = 1", "Subsubsection",
 CellChangeTimes->{
  3.9586144397708797`*^9},ExpressionUUID->"376411b0-78ca-b94b-b8a5-\
a9a555b6c2a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "datasetPath", " ", "=", " ", 
   "\"\<D:\\\\home\\\\Documents\\\\Github\\\\quantum_international_\
interaction_game\\\\dataset\\\\balanced_data.csv\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"loadData", "[", "datasetPath", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958614453713846*^9, 3.9586144607844353`*^9}, 
   3.958638010813995*^9, {3.958638081913891*^9, 3.958638086530744*^9}, 
   3.9586488334143906`*^9},ExpressionUUID->"82bfedef-5fa7-3543-810c-\
a94300bad2f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gridsize", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l2", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta1Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"deltaTheta2Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta3Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta4Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958614491016784*^9, 3.958614499716463*^9}, {
  3.958614585115848*^9, 3.958614594221907*^9}, {3.958614923798317*^9, 
  3.958614923886057*^9}, {3.9586158393496237`*^9, 3.958615839890238*^9}, {
  3.958638019136815*^9, 3.958638019327195*^9}, {3.958638951665818*^9, 
  3.958638951858102*^9}, {3.958639576142395*^9, 3.958639576568178*^9}, {
  3.958641039767672*^9, 3.958641040356444*^9}, {3.958645254224838*^9, 
  3.958645254754867*^9}, {3.9586484812507496`*^9, 
  3.9586484813750343`*^9}},ExpressionUUID->"88bbce98-dc5f-7f49-8ae5-\
c1de3b69b2d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gridResults", "=", 
   RowBox[{"gridSearchQuantumNormalFormThetas", "[", 
    RowBox[{
    "data", ",", "deltaTheta1Range", ",", "deltaTheta2Range", ",", 
     "deltaTheta3Range", ",", "deltaTheta4Range", ",", "l1", ",", "l2", ",", 
     "True"}], " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.958614535515381*^9, 3.958614624417551*^9}, {
  3.958614981181734*^9, 3.9586149887734375`*^9}, {3.9586158353908443`*^9, 
  3.958615836148878*^9}, {3.958615915449358*^9, 3.958615920349287*^9}, {
  3.958638298271064*^9, 3.9586382986580687`*^9}},
 CellLabel->
  "In[467]:=",ExpressionUUID->"6f8b8586-343d-e547-8f81-4037b6d7eca8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<\\n=== GRID SEARCH RESULTS ===\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Best parameters found:\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta1 (fight P1) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta1\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta2 (fight P2) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta2\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta3 (demand P1) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta3\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta4 (demand P2) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta4\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  Best accuracy = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestAccuracy\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.958615005841976*^9, 3.958615005842972*^9}},
 CellLabel->
  "In[468]:=",ExpressionUUID->"2a0f2e26-65d2-ab40-a965-971ae4a212f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bestDeltaTheta1", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta1\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta2", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta2\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta3", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta3\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta4", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta4\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.958615028483246*^9, 3.958615028483246*^9}},
 CellLabel->
  "In[475]:=",ExpressionUUID->"7d1aa087-28ee-9a4e-bd28-75b84a9b93d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bestResults", "=", 
   RowBox[{"processQuantumNormalFormDataset", "[", 
    RowBox[{
    "data", ",", "bestDeltaTheta1", ",", "bestDeltaTheta2", ",", 
     "bestDeltaTheta3", ",", "bestDeltaTheta4", ",", "l1", ",", "l2", ",", 
     "True"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9586150352325115`*^9, 3.9586150352325115`*^9}, {
  3.9586157828562355`*^9, 3.958615790120867*^9}},
 CellLabel->
  "In[479]:=",ExpressionUUID->"8c524562-18d5-d64c-9e6d-beee9df999d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"finalAccuracy", "=", 
   RowBox[{"calculateQuantumNormalFormAccuracy", "[", "bestResults", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Final accuracy with best parameters: \>\"", ",", 
    RowBox[{"N", "[", 
     RowBox[{"finalAccuracy", ",", "4"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9586150442445164`*^9, 3.958615044245516*^9}},
 CellLabel->
  "In[480]:=",ExpressionUUID->"2dac4564-d614-f44c-99ee-040b2a700e54"],

Cell[BoxData[
 RowBox[{"sampleResults", "=", 
  RowBox[{"getFirstNEntries", "[", 
   RowBox[{"bestResults", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.958615054265728*^9, 3.958615056063387*^9}, {
  3.958615805592369*^9, 3.958615816882309*^9}},
 CellLabel->
  "In[482]:=",ExpressionUUID->"2a97bf59-da27-264f-9587-33d4cd95fe14"],

Cell[BoxData[
 RowBox[{"visualizeGridSearchResults4D", "[", 
  RowBox[{"gridResults", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.958615093751814*^9, 3.958615093752817*^9}, 
   3.9586153963949833`*^9},
 CellLabel->
  "In[483]:=",ExpressionUUID->"71831cb7-7817-4042-b542-e238644303f6"],

Cell[BoxData[
 RowBox[{"plotQuantumNormalFormConfusionMatrix", "[", 
  RowBox[{
  "bestResults", ",", "bestDeltaTheta1", ",", "bestDeltaTheta2", ",", 
   "bestDeltaTheta3", ",", "bestDeltaTheta4", ",", "l1", ",", "l2", ",", 
   "\"\<Quantum Normal Form Model - Best Parameters\>\""}], "]"}]], "Input",
 CellLabel->
  "In[484]:=",ExpressionUUID->"474c4889-2f92-ce42-a55b-73d0f58abeaa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setting 2: Lambda1 = 0.5 | Lambda2 = 0.5", "Subsubsection",
 CellChangeTimes->{
  3.9586144397708797`*^9, {3.958615988953598*^9, 3.9586159890525723`*^9}, 
   3.9586160191263294`*^9},ExpressionUUID->"b1f658b5-6d4c-d44e-8ea6-\
d93584dc3dc1"],

Cell[BoxData[{
 RowBox[{"datasetPath", " ", "=", " ", 
  "\"\<D:\\\\home\\\\Documents\\\\Github\\\\quantum_international_interaction_\
game\\\\dataset\\\\balanced_data.csv\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"loadData", "[", "datasetPath", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958614453713846*^9, 3.9586144607844353`*^9}, {
  3.95864207374979*^9, 3.958642077023427*^9}, {3.9586488995385113`*^9, 
  3.958648901048687*^9}},ExpressionUUID->"2cde230b-c76b-794c-8da3-\
cbff4b937b3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gridsize", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", " ", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l2", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta1Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"deltaTheta2Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta3Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta4Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958614491016784*^9, 3.958614499716463*^9}, {
  3.958614585115848*^9, 3.958614594221907*^9}, {3.958614923798317*^9, 
  3.958614923886057*^9}, {3.9586158393496237`*^9, 3.958615839890238*^9}, {
  3.958616021481926*^9, 3.958616025856117*^9}, {3.958645274787022*^9, 
  3.958645275178596*^9}, {3.9586489133038254`*^9, 
  3.9586489138134594`*^9}},ExpressionUUID->"eabcf78a-f91e-734c-8ef5-\
db46e15d58d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gridResults", "=", 
   RowBox[{"gridSearchQuantumNormalFormThetas", "[", 
    RowBox[{
    "data", ",", "deltaTheta1Range", ",", "deltaTheta2Range", ",", 
     "deltaTheta3Range", ",", "deltaTheta4Range", ",", "l1", ",", "l2", ",", 
     "True"}], " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.958614535515381*^9, 3.958614624417551*^9}, {
  3.958614981181734*^9, 3.9586149887734375`*^9}, {3.9586158353908443`*^9, 
  3.958615836148878*^9}, {3.958615915449358*^9, 3.958615920349287*^9}, {
  3.958642089754672*^9, 3.9586420901922913`*^9}},
 CellLabel->
  "In[494]:=",ExpressionUUID->"08c129a8-ae4b-a545-af28-2b5ce16c4116"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<\\n=== GRID SEARCH RESULTS ===\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Best parameters found:\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta1 (fight P1) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta1\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta2 (fight P2) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta2\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta3 (demand P1) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta3\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta4 (demand P2) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta4\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  Best accuracy = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestAccuracy\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.958615005841976*^9, 3.958615005842972*^9}},
 CellLabel->
  "In[495]:=",ExpressionUUID->"ce360a32-254b-864a-8448-5ff354aa0512"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bestDeltaTheta1", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta1\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta2", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta2\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta3", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta3\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta4", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta4\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.958615028483246*^9, 3.958615028483246*^9}},
 CellLabel->
  "In[502]:=",ExpressionUUID->"528d10ed-f6a5-3b43-b818-52a8bf22f9c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bestResults", "=", 
   RowBox[{"processQuantumNormalFormDataset", "[", 
    RowBox[{
    "data", ",", "bestDeltaTheta1", ",", "bestDeltaTheta2", ",", 
     "bestDeltaTheta3", ",", "bestDeltaTheta4", ",", "l1", ",", "l2", ",", 
     "True"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9586150352325115`*^9, 3.9586150352325115`*^9}, {
  3.9586157828562355`*^9, 3.958615790120867*^9}},
 CellLabel->
  "In[506]:=",ExpressionUUID->"3f2e6b68-b07e-9a4f-94d5-aceb5ff0a87f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"finalAccuracy", "=", 
   RowBox[{"calculateQuantumNormalFormAccuracy", "[", "bestResults", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Final accuracy with best parameters: \>\"", ",", 
    RowBox[{"N", "[", 
     RowBox[{"finalAccuracy", ",", "4"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9586150442445164`*^9, 3.958615044245516*^9}},
 CellLabel->
  "In[507]:=",ExpressionUUID->"14e30ed1-f61c-2940-b1bf-08fd61856b8a"],

Cell[BoxData[
 RowBox[{"sampleResults", "=", 
  RowBox[{"getFirstNEntries", "[", 
   RowBox[{"bestResults", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.958615054265728*^9, 3.958615056063387*^9}, {
  3.958615805592369*^9, 3.958615816882309*^9}},
 CellLabel->
  "In[509]:=",ExpressionUUID->"ad7c3fbf-041b-1447-839c-8ba60e26b881"],

Cell[BoxData[
 RowBox[{"visualizeGridSearchResults4D", "[", 
  RowBox[{"gridResults", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.958615093751814*^9, 3.958615093752817*^9}, 
   3.9586153963949833`*^9},
 CellLabel->
  "In[510]:=",ExpressionUUID->"0abf4763-5f7e-1a47-ac04-dc8c16ef6e8b"],

Cell[BoxData[
 RowBox[{"plotQuantumNormalFormConfusionMatrix", "[", 
  RowBox[{
  "bestResults", ",", "bestDeltaTheta1", ",", "bestDeltaTheta2", ",", 
   "bestDeltaTheta3", ",", "bestDeltaTheta4", ",", "l1", ",", "l2", ",", 
   "\"\<Quantum Normal Form Model - Best Parameters\>\""}], "]"}]], "Input",
 CellLabel->
  "In[511]:=",ExpressionUUID->"8e326ece-db91-b94c-a213-006beb91e32b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setting 3: Lambda1 = 2 | Lambda2 = 2", "Subsubsection",
 CellChangeTimes->{
  3.9586144397708797`*^9, {3.9586160400977764`*^9, 
   3.9586160598516273`*^9}},ExpressionUUID->"1b31b80a-1ef1-5a48-b997-\
90c6a153f029"],

Cell[BoxData[{
 RowBox[{"datasetPath", " ", "=", " ", 
  "\"\<D:\\\\home\\\\Documents\\\\Github\\\\quantum_international_interaction_\
game\\\\dataset\\\\balanced_data.csv\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"loadData", "[", "datasetPath", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958614453713846*^9, 3.9586144607844353`*^9}, {
  3.958642099307534*^9, 3.958642120082101*^9}, {3.9586488932403145`*^9, 
  3.9586488942397537`*^9}},ExpressionUUID->"0025422a-28e2-9448-b512-\
d68583a4c0a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gridsize", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", " ", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l2", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta1Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"deltaTheta2Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta3Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta4Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958614491016784*^9, 3.958614499716463*^9}, {
  3.958614585115848*^9, 3.958614594221907*^9}, {3.958614923798317*^9, 
  3.958614923886057*^9}, {3.9586158393496237`*^9, 3.958615839890238*^9}, {
  3.958616064699989*^9, 3.9586160655589504`*^9}, {3.958645289291131*^9, 
  3.958645289787533*^9}, {3.9586489186685505`*^9, 
  3.9586489191986427`*^9}},ExpressionUUID->"ceca52e6-5922-b14b-81de-\
a6afce39d13c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gridResults", "=", 
   RowBox[{"gridSearchQuantumNormalFormThetas", "[", 
    RowBox[{
    "data", ",", "deltaTheta1Range", ",", "deltaTheta2Range", ",", 
     "deltaTheta3Range", ",", "deltaTheta4Range", ",", "l1", ",", "l2", ",", 
     "True"}], " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.958614535515381*^9, 3.958614624417551*^9}, {
  3.958614981181734*^9, 3.9586149887734375`*^9}, {3.9586158353908443`*^9, 
  3.958615836148878*^9}, {3.958615915449358*^9, 3.958615920349287*^9}, {
  3.958642102057125*^9, 3.95864210319385*^9}},
 CellLabel->
  "In[521]:=",ExpressionUUID->"ccffdc14-b08e-0246-b181-2d9fa2b1278b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<\\n=== GRID SEARCH RESULTS ===\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Best parameters found:\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta1 (fight P1) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta1\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta2 (fight P2) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta2\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta3 (demand P1) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta3\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta4 (demand P2) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta4\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  Best accuracy = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestAccuracy\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.958615005841976*^9, 3.958615005842972*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"24bda89c-ebcb-9448-a2a4-5180e358690e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bestDeltaTheta1", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta1\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta2", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta2\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta3", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta3\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta4", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta4\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.958615028483246*^9, 3.958615028483246*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"7159a4ea-7109-f847-87d5-94d8feff5f08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bestResults", "=", 
   RowBox[{"processQuantumNormalFormDataset", "[", 
    RowBox[{
    "data", ",", "bestDeltaTheta1", ",", "bestDeltaTheta2", ",", 
     "bestDeltaTheta3", ",", "bestDeltaTheta4", ",", "l1", ",", "l2", ",", 
     "True"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9586150352325115`*^9, 3.9586150352325115`*^9}, {
  3.9586157828562355`*^9, 
  3.958615790120867*^9}},ExpressionUUID->"2889ead3-c539-b348-b94d-\
7df07b1b0794"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"finalAccuracy", "=", 
   RowBox[{"calculateQuantumNormalFormAccuracy", "[", "bestResults", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Final accuracy with best parameters: \>\"", ",", 
    RowBox[{"N", "[", 
     RowBox[{"finalAccuracy", ",", "4"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9586150442445164`*^9, 3.958615044245516*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"2b7694c9-9c24-7e42-b0db-6d1fcb881220"],

Cell[BoxData[
 RowBox[{"sampleResults", "=", 
  RowBox[{"getFirstNEntries", "[", 
   RowBox[{"bestResults", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.958615054265728*^9, 3.958615056063387*^9}, {
  3.958615805592369*^9, 3.958615816882309*^9}, {3.9586489252903175`*^9, 
  3.9586489259830685`*^9}},ExpressionUUID->"6c8409ac-da7c-1744-83cd-\
50b04191e87f"],

Cell[BoxData[
 RowBox[{"visualizeGridSearchResults4D", "[", 
  RowBox[{"gridResults", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.958615093751814*^9, 3.958615093752817*^9}, 
   3.9586153963949833`*^9},
 CellLabel->
  "In[127]:=",ExpressionUUID->"0aef66a4-d018-4248-9994-7cb05b7016ea"],

Cell[BoxData[
 RowBox[{"plotQuantumNormalFormConfusionMatrix", "[", 
  RowBox[{
  "bestResults", ",", "bestDeltaTheta1", ",", "bestDeltaTheta2", ",", 
   "bestDeltaTheta3", ",", "bestDeltaTheta4", ",", "l1", ",", "l2", ",", 
   "\"\<Quantum Normal Form Model - Best Parameters\>\""}], "]"}]], "Input",Ex\
pressionUUID->"f2d4c217-b074-6a43-8541-3b29c3fc22a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setting 4: Lambda1 = 0.1 | Lambda2 = 0.1", "Subsubsection",
 CellChangeTimes->{3.9586144397708797`*^9, 
  3.9586161157664375`*^9},ExpressionUUID->"9991da59-bb7c-b140-80b1-\
d83dfc65d46e"],

Cell[BoxData[{
 RowBox[{"datasetPath", " ", "=", " ", 
  "\"\<D:\\\\home\\\\Documents\\\\Github\\\\quantum_international_interaction_\
game\\\\dataset\\\\balanced_data.csv\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"loadData", "[", "datasetPath", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958614453713846*^9, 3.9586144607844353`*^9}, {
  3.95864211319908*^9, 3.958642114952529*^9}, {3.958648885186138*^9, 
  3.9586488872704353`*^9}},ExpressionUUID->"0fc872bb-563d-5b46-ae1f-\
862439906748"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gridsize", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", " ", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l2", "=", " ", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta1Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"deltaTheta2Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta3Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta4Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958614491016784*^9, 3.958614499716463*^9}, {
  3.958614585115848*^9, 3.958614594221907*^9}, {3.958614923798317*^9, 
  3.958614923886057*^9}, {3.9586158393496237`*^9, 3.958615839890238*^9}, {
  3.958616195571657*^9, 3.9586162037538967`*^9}, {3.958645293363539*^9, 
  3.958645293782364*^9}, {3.958648931947382*^9, 
  3.958648932435911*^9}},ExpressionUUID->"abf6c5a1-2931-c248-99b1-\
634ac1759589"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gridResults", "=", 
   RowBox[{"gridSearchQuantumNormalFormThetas", "[", 
    RowBox[{
    "data", ",", "deltaTheta1Range", ",", "deltaTheta2Range", ",", 
     "deltaTheta3Range", ",", "deltaTheta4Range", ",", "l1", ",", "l2", ",", 
     "True"}], " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.958614535515381*^9, 3.958614624417551*^9}, {
  3.958614981181734*^9, 3.9586149887734375`*^9}, {3.9586158353908443`*^9, 
  3.958615836148878*^9}, {3.958615915449358*^9, 3.958615920349287*^9}, {
  3.958642126736053*^9, 
  3.958642127128232*^9}},ExpressionUUID->"a035cc39-b97b-214c-a3f3-\
9a87d7301fbd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<\\n=== GRID SEARCH RESULTS ===\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Best parameters found:\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta1 (fight P1) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta1\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta2 (fight P2) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta2\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta3 (demand P1) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta3\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta4 (demand P2) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta4\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  Best accuracy = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestAccuracy\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.958615005841976*^9, 3.958615005842972*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"ba2dcfad-e971-e84f-93e7-f754a67d7c91"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bestDeltaTheta1", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta1\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta2", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta2\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta3", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta3\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta4", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta4\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.958615028483246*^9, 3.958615028483246*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"8b45a592-c040-3641-bfc1-7d6ae5e7974b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bestResults", "=", 
   RowBox[{"processQuantumNormalFormDataset", "[", 
    RowBox[{
    "data", ",", "bestDeltaTheta1", ",", "bestDeltaTheta2", ",", 
     "bestDeltaTheta3", ",", "bestDeltaTheta4", ",", "l1", ",", "l2", ",", 
     "True"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9586150352325115`*^9, 3.9586150352325115`*^9}, {
  3.9586157828562355`*^9, 
  3.958615790120867*^9}},ExpressionUUID->"59da36b0-165e-f245-adc7-\
8558e7654ef7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"finalAccuracy", "=", 
   RowBox[{"calculateQuantumNormalFormAccuracy", "[", "bestResults", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Final accuracy with best parameters: \>\"", ",", 
    RowBox[{"N", "[", 
     RowBox[{"finalAccuracy", ",", "4"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9586150442445164`*^9, 3.958615044245516*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"244e6256-dbe8-884a-abe8-86f2a7846531"],

Cell[BoxData[
 RowBox[{"sampleResults", "=", 
  RowBox[{"getFirstNEntries", "[", 
   RowBox[{"bestResults", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.958615054265728*^9, 3.958615056063387*^9}, {
  3.958615805592369*^9, 3.958615816882309*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"03af0e5a-4a69-2b4c-a45b-e57d8cdbe35a"],

Cell[BoxData[
 RowBox[{"visualizeGridSearchResults4D", "[", 
  RowBox[{"gridResults", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.958615093751814*^9, 3.958615093752817*^9}, 
   3.9586153963949833`*^9},
 CellLabel->
  "In[127]:=",ExpressionUUID->"7ba30871-3bdd-cb4e-969f-b3ca7a0b4531"],

Cell[BoxData[
 RowBox[{"plotQuantumNormalFormConfusionMatrix", "[", 
  RowBox[{
  "bestResults", ",", "bestDeltaTheta1", ",", "bestDeltaTheta2", ",", 
   "bestDeltaTheta3", ",", "bestDeltaTheta4", ",", "l1", ",", "l2", ",", 
   "\"\<Quantum Normal Form Model - Best Parameters\>\""}], "]"}]], "Input",Ex\
pressionUUID->"f0a8af94-4b66-0e4c-a561-5e79a4ff2faf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setting 5: Lambda1 = 10 | Lambda2 = 10", "Subsubsection",
 CellChangeTimes->{3.9586144397708797`*^9, 
  3.958616145113756*^9},ExpressionUUID->"fd3f6246-3260-634d-a79f-\
4c566a40b0ac"],

Cell[BoxData[{
 RowBox[{"datasetPath", " ", "=", " ", 
  "\"\<D:\\\\home\\\\Documents\\\\Github\\\\quantum_international_interaction_\
game\\\\dataset\\\\balanced_data.csv\>\""}], "\[IndentingNewLine]", 
 RowBox[{"data", "=", 
  RowBox[{"loadData", "[", "datasetPath", "]"}]}]}], "Input",
 CellChangeTimes->{{3.958614453713846*^9, 3.9586144607844353`*^9}, {
  3.958642133673647*^9, 3.958642135759419*^9}, {3.958648861391119*^9, 
  3.9586488783827457`*^9}},ExpressionUUID->"e2983bcf-acaa-834c-afd4-\
52c8dbf68b52"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gridsize", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", " ", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l2", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta1Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"deltaTheta2Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta3Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta4Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958614491016784*^9, 3.958614499716463*^9}, {
  3.958614585115848*^9, 3.958614594221907*^9}, {3.958614923798317*^9, 
  3.958614923886057*^9}, {3.9586158393496237`*^9, 3.958615839890238*^9}, {
  3.958616190053003*^9, 3.958616190616262*^9}, {3.958645297921369*^9, 
  3.958645298517469*^9}, {3.9586489363836308`*^9, 
  3.958648936912733*^9}},ExpressionUUID->"15683a6b-0432-be43-982a-\
21bdac03368a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gridResults", "=", 
   RowBox[{"gridSearchQuantumNormalFormThetas", "[", 
    RowBox[{
    "data", ",", "deltaTheta1Range", ",", "deltaTheta2Range", ",", 
     "deltaTheta3Range", ",", "deltaTheta4Range", ",", "l1", ",", "l2", ",", 
     "True"}], " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.958614535515381*^9, 3.958614624417551*^9}, {
  3.958614981181734*^9, 3.9586149887734375`*^9}, {3.9586158353908443`*^9, 
  3.958615836148878*^9}, {3.958615915449358*^9, 3.958615920349287*^9}, {
  3.958642139977942*^9, 
  3.9586421403929453`*^9}},ExpressionUUID->"f650cf22-70c8-4745-a489-\
719fc90f8fe2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<\\n=== GRID SEARCH RESULTS ===\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Best parameters found:\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta1 (fight P1) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta1\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta2 (fight P2) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta2\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta3 (demand P1) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta3\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta4 (demand P2) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta4\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  Best accuracy = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestAccuracy\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.958615005841976*^9, 3.958615005842972*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"672275b4-912a-0d48-ba3e-e4b7f33c76c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bestDeltaTheta1", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta1\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta2", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta2\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta3", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta3\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta4", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta4\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.958615028483246*^9, 3.958615028483246*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"9f69cf97-e2b8-4741-82b8-14ddd7aa1ba5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bestResults", "=", 
   RowBox[{"processQuantumNormalFormDataset", "[", 
    RowBox[{
    "data", ",", "bestDeltaTheta1", ",", "bestDeltaTheta2", ",", 
     "bestDeltaTheta3", ",", "bestDeltaTheta4", ",", "l1", ",", "l2", ",", 
     "True"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9586150352325115`*^9, 3.9586150352325115`*^9}, {
  3.9586157828562355`*^9, 
  3.958615790120867*^9}},ExpressionUUID->"13f64b29-dea9-8e4b-aa94-\
d14f1a5f3072"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"finalAccuracy", "=", 
   RowBox[{"calculateQuantumNormalFormAccuracy", "[", "bestResults", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Final accuracy with best parameters: \>\"", ",", 
    RowBox[{"N", "[", 
     RowBox[{"finalAccuracy", ",", "4"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9586150442445164`*^9, 3.958615044245516*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"e4e9bb63-a362-5943-89cb-7b86530c7c8f"],

Cell[BoxData[
 RowBox[{"sampleResults", "=", 
  RowBox[{"getFirstNEntries", "[", 
   RowBox[{"bestResults", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.958615054265728*^9, 3.958615056063387*^9}, {
  3.958615805592369*^9, 3.958615816882309*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"303f1fda-2534-9849-ab45-0e3586b9f976"],

Cell[BoxData[
 RowBox[{"visualizeGridSearchResults4D", "[", 
  RowBox[{"gridResults", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.958615093751814*^9, 3.958615093752817*^9}, 
   3.9586153963949833`*^9},
 CellLabel->
  "In[127]:=",ExpressionUUID->"52d8104b-e3fb-9a4a-9bdd-6f86acae0870"],

Cell[BoxData[
 RowBox[{"plotQuantumNormalFormConfusionMatrix", "[", 
  RowBox[{
  "bestResults", ",", "bestDeltaTheta1", ",", "bestDeltaTheta2", ",", 
   "bestDeltaTheta3", ",", "bestDeltaTheta4", ",", "l1", ",", "l2", ",", 
   "\"\<Quantum Normal Form Model - Best Parameters\>\""}], "]"}]], "Input",Ex\
pressionUUID->"81fd6d95-e2cc-fc46-bd15-d2e9535a780a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setting 6: Lambda1 = 0.0001 | Lambda2 = 0.0001", "Subsubsection",
 CellChangeTimes->{
  3.9586144397708797`*^9, {3.958616149258568*^9, 
   3.95861616730978*^9}},ExpressionUUID->"739012dc-76df-6a4e-89b3-\
c715e258fad8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "datasetPath", " ", "=", " ", 
   "\"\<D:\\\\home\\\\Documents\\\\Github\\\\quantum_international_\
interaction_game\\\\dataset\\\\balanced_data.csv\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"loadData", "[", "datasetPath", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958614453713846*^9, 3.9586144607844353`*^9}, 
   3.958642147663477*^9, {3.9586488530069695`*^9, 3.958648854973671*^9}, 
   3.95864894239719*^9},ExpressionUUID->"25cd6235-9c85-3f4e-8835-\
04b3e2f613ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gridsize", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", " ", "=", "0.0001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l2", "=", "0.0001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta1Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"deltaTheta2Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta3Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaTheta4Range", "=", 
   RowBox[{"createThetaRange", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "*", "Pi"}], ",", "gridsize"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958614491016784*^9, 3.958614499716463*^9}, {
  3.958614585115848*^9, 3.958614594221907*^9}, {3.958614923798317*^9, 
  3.958614923886057*^9}, {3.9586158393496237`*^9, 3.958615839890238*^9}, {
  3.9586161794512205`*^9, 3.958616183825327*^9}, {3.958645301428644*^9, 
  3.958645303715551*^9}, {3.958648945204731*^9, 
  3.9586489456753426`*^9}},ExpressionUUID->"b672c540-6a94-3c41-bcec-\
201854d05c5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gridResults", "=", 
   RowBox[{"gridSearchQuantumNormalFormThetas", "[", 
    RowBox[{
    "data", ",", "deltaTheta1Range", ",", "deltaTheta2Range", ",", 
     "deltaTheta3Range", ",", "deltaTheta4Range", ",", "l1", ",", "l2", ",", 
     "True"}], " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.958614535515381*^9, 3.958614624417551*^9}, {
  3.958614981181734*^9, 3.9586149887734375`*^9}, {3.9586158353908443`*^9, 
  3.958615836148878*^9}, {3.958615915449358*^9, 3.958615920349287*^9}, {
  3.958642151877561*^9, 
  3.95864215233077*^9}},ExpressionUUID->"3a3b62bf-711e-cb43-8190-\
653136bc1b0c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<\\n=== GRID SEARCH RESULTS ===\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Best parameters found:\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta1 (fight P1) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta1\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta2 (fight P2) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta2\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta3 (demand P1) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta3\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  DeltaTheta4 (demand P2) = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestDeltaTheta4\>\"", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<  Best accuracy = \>\"", ",", 
    RowBox[{"gridResults", "[", "\"\<bestAccuracy\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.958615005841976*^9, 3.958615005842972*^9}, {
  3.958648149446144*^9, 3.958648155390671*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"6617fea5-0932-c84b-a8eb-b6ea823109e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bestDeltaTheta1", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta1\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta2", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta2\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta3", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta3\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bestDeltaTheta4", "=", 
   RowBox[{"gridResults", "[", "\"\<bestDeltaTheta4\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.958615028483246*^9, 3.958615028483246*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"aafb95e0-aebe-434e-a319-34b613a2cb54"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bestResults", "=", 
   RowBox[{"processQuantumNormalFormDataset", "[", 
    RowBox[{
    "data", ",", "bestDeltaTheta1", ",", "bestDeltaTheta2", ",", 
     "bestDeltaTheta3", ",", "bestDeltaTheta4", ",", "l1", ",", "l2", ",", 
     "True"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9586150352325115`*^9, 3.9586150352325115`*^9}, {
  3.9586157828562355`*^9, 
  3.958615790120867*^9}},ExpressionUUID->"acf8d4f1-419a-254c-bc67-\
e506e80a5e85"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"finalAccuracy", "=", 
   RowBox[{"calculateQuantumNormalFormAccuracy", "[", "bestResults", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Final accuracy with best parameters: \>\"", ",", 
    RowBox[{"N", "[", 
     RowBox[{"finalAccuracy", ",", "4"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9586150442445164`*^9, 3.958615044245516*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"eebaecbd-c781-964b-a22c-4c11260a1919"],

Cell[BoxData[
 RowBox[{"sampleResults", "=", 
  RowBox[{"getFirstNEntries", "[", 
   RowBox[{"bestResults", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.958615054265728*^9, 3.958615056063387*^9}, {
  3.958615805592369*^9, 3.958615816882309*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"e2bdd50c-5a3b-074d-9831-248bcb664efb"],

Cell[BoxData[
 RowBox[{"visualizeGridSearchResults4D", "[", 
  RowBox[{"gridResults", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.958615093751814*^9, 3.958615093752817*^9}, 
   3.9586153963949833`*^9},
 CellLabel->
  "In[127]:=",ExpressionUUID->"647dcafc-8260-3d45-a7c9-7375b656957f"],

Cell[BoxData[
 RowBox[{"plotQuantumNormalFormConfusionMatrix", "[", 
  RowBox[{
  "bestResults", ",", "bestDeltaTheta1", ",", "bestDeltaTheta2", ",", 
   "bestDeltaTheta3", ",", "bestDeltaTheta4", ",", "l1", ",", "l2", ",", 
   "\"\<Quantum Normal Form Model - Best Parameters\>\""}], "]"}]], "Input",Ex\
pressionUUID->"c247fa2b-b5e8-9040-8b3f-89120596f43a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.95864814712405*^9, 
  3.958648148265534*^9}},ExpressionUUID->"0bb09362-0372-4d23-b1e0-\
397729fbf0e8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1218, 731},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7ebb2c31-88ab-4a83-aa63-bd20f0109eec"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 198, 3, 98, "Title",ExpressionUUID->"c1042fb1-f1b4-4593-a5ef-dd40d4a27210"],
Cell[CellGroupData[{
Cell[803, 29, 421, 6, 67, "Section",ExpressionUUID->"e4dcf874-0ea3-4ddc-8539-ab129ce0b9c0"],
Cell[1227, 37, 2176, 46, 370, "Text",ExpressionUUID->"1882c8df-b893-4d99-a10c-ca410cf8faad"],
Cell[CellGroupData[{
Cell[3428, 87, 156, 3, 54, "Subsection",ExpressionUUID->"e9aeacdf-9925-a14b-bd35-31c9209d32e7"],
Cell[3587, 92, 10812, 288, 904, "Input",ExpressionUUID->"c7b3cdef-d5f2-8247-a252-08d65932d37c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14436, 385, 183, 3, 54, "Subsection",ExpressionUUID->"2de4f504-9e76-2d43-b9fd-983fcd6fc1fb"],
Cell[14622, 390, 6269, 175, 676, "Input",ExpressionUUID->"9fe9c20e-41f3-6540-87fa-7defc490a67e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20928, 570, 192, 3, 54, "Subsection",ExpressionUUID->"48c7cc0d-f5ff-f949-ae09-71bf423713e5"],
Cell[21123, 575, 10804, 286, 904, "Input",ExpressionUUID->"1a0745d6-b9e9-9043-80e1-4db1f4d3516f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31964, 866, 186, 3, 54, "Subsection",ExpressionUUID->"9ecba0e4-c5ad-254c-9ed3-9ec00a9a2dfb"],
Cell[32153, 871, 6273, 173, 676, "Input",ExpressionUUID->"d4072e57-9b7b-3248-96e7-bf7547943ac5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38463, 1049, 179, 3, 54, "Subsection",ExpressionUUID->"04bab1f3-aa1b-7542-9972-e8c3a8d1a295"],
Cell[CellGroupData[{
Cell[38667, 1056, 148, 3, 45, "Subsubsection",ExpressionUUID->"bb01dd4c-6a78-e54e-bd6b-bc7531024478"],
Cell[38818, 1061, 12783, 286, 923, "Input",ExpressionUUID->"88fb5d8a-c990-9240-8ec4-dc327bc82514"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51638, 1352, 174, 3, 45, "Subsubsection",ExpressionUUID->"3053eb4a-5ce5-b74d-8777-4b2d4dc3a661"],
Cell[51815, 1357, 33433, 724, 2046, "Input",ExpressionUUID->"c1d6ac1c-3bde-8240-b294-49c7b25fe983"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[85297, 2087, 163, 3, 54, "Subsection",ExpressionUUID->"74d0f729-c7f3-f843-9c9d-644467e5452a"],
Cell[CellGroupData[{
Cell[85485, 2094, 163, 3, 45, "Subsubsection",ExpressionUUID->"27cd460e-5baa-0341-a680-730de66d38a4"],
Cell[85651, 2099, 4971, 119, 352, "Input",ExpressionUUID->"af3664f0-f061-7e43-a022-38a4d53807db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90659, 2223, 143, 3, 45, "Subsubsection",ExpressionUUID->"572af27b-023d-5c48-8e10-30f7c06d5062"],
Cell[90805, 2228, 14016, 348, 542, "Input",ExpressionUUID->"b2853312-e248-0b4d-ad5b-b092892c28aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104858, 2581, 160, 3, 45, "Subsubsection",ExpressionUUID->"df7bb380-6330-7849-8649-fdfd7fecde2f"],
Cell[105021, 2586, 7925, 179, 561, "Input",ExpressionUUID->"5272f95b-1446-2c41-8078-61534893bdee"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112995, 2771, 174, 3, 54, "Subsection",ExpressionUUID->"e0169ed6-e414-c34b-8f25-7354d9f57c83"],
Cell[CellGroupData[{
Cell[113194, 2778, 162, 3, 45, "Subsubsection",ExpressionUUID->"ba973cc2-cccd-b74e-ac3c-ae8f86179338"],
Cell[113359, 2783, 17117, 351, 2293, "Input",ExpressionUUID->"fb3655d7-fb79-d64c-99cc-b9f7612a9240"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130513, 3139, 160, 3, 45, "Subsubsection",ExpressionUUID->"0690d6e0-3f1f-4d46-942c-30a3f2f340f1"],
Cell[130676, 3144, 3506, 78, 314, "Input",ExpressionUUID->"e1c7d384-37f4-0e46-878e-946cd37f913e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134219, 3227, 163, 3, 45, "Subsubsection",ExpressionUUID->"618621d8-7638-6d41-b1c0-321775f560db"],
Cell[134385, 3232, 1865, 51, 162, "Input",ExpressionUUID->"3a84d0a6-5a7f-2c40-99e3-6bfd4f112416"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136287, 3288, 156, 2, 45, "Subsubsection",ExpressionUUID->"11d6fde7-0049-9f41-a5ca-7ea6eb258d77"],
Cell[136446, 3292, 8757, 208, 333, "Input",ExpressionUUID->"bd3e50aa-26b3-a24e-bcc3-e5deacc8c69d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145240, 3505, 145, 3, 45, "Subsubsection",ExpressionUUID->"94dfacf6-9cbb-7447-83cf-3b0b8ce2d4dc"],
Cell[145388, 3510, 634, 17, 28, "Input",ExpressionUUID->"e19799dc-2fb7-434a-ae7e-2598e6c1796b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146059, 3532, 143, 3, 45, "Subsubsection",ExpressionUUID->"21762f89-aecf-394f-adb7-514e293afaa0"],
Cell[146205, 3537, 2842, 73, 143, "Input",ExpressionUUID->"44251dde-ecf6-bf42-ab5b-81787cad5f2b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149084, 3615, 171, 3, 45, "Subsubsection",ExpressionUUID->"ed044993-c50c-bf4d-b591-3208551139f7"],
Cell[149258, 3620, 1832, 42, 143, "Input",ExpressionUUID->"dbca5c5f-e1df-0d4e-95a2-33d54c1520d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151127, 3667, 136, 3, 45, "Subsubsection",ExpressionUUID->"133e2004-e5f2-884b-a4c2-ef41826eb36c"],
Cell[151266, 3672, 7832, 190, 676, "Input",ExpressionUUID->"8de339b1-0c90-9246-8201-95472365e6d0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[159147, 3868, 171, 3, 54, "Subsection",ExpressionUUID->"dee07e75-80f6-4147-ac43-80c2aae3f51c"],
Cell[CellGroupData[{
Cell[159343, 3875, 202, 3, 45, "Subsubsection",ExpressionUUID->"a1f5834b-067d-e34c-90c2-01e68b7c462a"],
Cell[159548, 3880, 140773, 3225, 7316, "Input",ExpressionUUID->"6aaf89cb-3213-9b43-8d50-f829eb0079b3"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[300382, 7112, 156, 3, 67, "Section",ExpressionUUID->"39735c4d-5e12-1e42-8678-65451bedadf4"],
Cell[CellGroupData[{
Cell[300563, 7119, 166, 3, 54, "Subsection",ExpressionUUID->"b6a58fec-6180-0d4c-ad5d-50bd7b316a96"],
Cell[300732, 7124, 545, 13, 48, "Input",ExpressionUUID->"d02dd267-9c95-8c42-9839-ef268b90c4f7"],
Cell[301280, 7139, 1466, 46, 162, "Input",ExpressionUUID->"b73b6a61-b8fe-3643-9bbb-e054344aa42f"],
Cell[302749, 7187, 560, 15, 48, "Input",ExpressionUUID->"cd77be64-24fb-9d4a-9ca1-4fc63c12608f"],
Cell[CellGroupData[{
Cell[303334, 7206, 164, 3, 45, "Subsubsection",ExpressionUUID->"1465bb6c-c996-2145-a599-a6e7c605a62b"],
Cell[303501, 7211, 1409, 31, 48, "Input",ExpressionUUID->"54220245-f749-5644-afcf-8e7e342d8aed"],
Cell[304913, 7244, 230, 4, 28, "Input",ExpressionUUID->"bc996225-41a1-1244-b408-9c29124444e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305180, 7253, 165, 3, 45, "Subsubsection",ExpressionUUID->"daf80094-341c-ae45-a1f6-d5d90666bfd5"],
Cell[305348, 7258, 2545, 52, 428, "Input",ExpressionUUID->"1dabb96a-5127-a843-a86a-949842869eec"],
Cell[307896, 7312, 380, 8, 28, "Input",ExpressionUUID->"5dabb94d-0c5f-044c-a5d4-7a1745c6207d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[308325, 7326, 176, 3, 54, "Subsection",ExpressionUUID->"42b04b36-4350-8746-a857-693c9a0af76d"],
Cell[CellGroupData[{
Cell[308526, 7333, 164, 3, 45, "Subsubsection",ExpressionUUID->"376411b0-78ca-b94b-b8a5-a9a555b6c2a1"],
Cell[308693, 7338, 557, 13, 48, "Input",ExpressionUUID->"82bfedef-5fa7-3543-810c-a94300bad2f9"],
Cell[309253, 7353, 1566, 37, 143, "Input",ExpressionUUID->"88bbce98-dc5f-7f49-8ae5-c1de3b69b2d0"],
Cell[310822, 7392, 661, 13, 28, "Input",ExpressionUUID->"6f8b8586-343d-e547-8f81-4037b6d7eca8"],
Cell[311486, 7407, 1264, 34, 143, "Input",ExpressionUUID->"2a0f2e26-65d2-ab40-a965-971ae4a212f1"],
Cell[312753, 7443, 683, 19, 86, "Input",ExpressionUUID->"7d1aa087-28ee-9a4e-bd28-75b84a9b93d8"],
Cell[313439, 7464, 506, 11, 28, "Input",ExpressionUUID->"8c524562-18d5-d64c-9e6d-beee9df999d2"],
Cell[313948, 7477, 503, 12, 48, "Input",ExpressionUUID->"2dac4564-d614-f44c-99ee-040b2a700e54"],
Cell[314454, 7491, 336, 7, 28, "Input",ExpressionUUID->"2a97bf59-da27-264f-9587-33d4cd95fe14"],
Cell[314793, 7500, 340, 8, 28, "Input",ExpressionUUID->"71831cb7-7817-4042-b542-e238644303f6"],
Cell[315136, 7510, 384, 7, 48, "Input",ExpressionUUID->"474c4889-2f92-ce42-a55b-73d0f58abeaa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315557, 7522, 245, 4, 45, "Subsubsection",ExpressionUUID->"b1f658b5-6d4c-d44e-8ea6-d93584dc3dc1"],
Cell[315805, 7528, 531, 10, 48, "Input",ExpressionUUID->"2cde230b-c76b-794c-8da3-cbff4b937b3b"],
Cell[316339, 7540, 1426, 35, 143, "Input",ExpressionUUID->"eabcf78a-f91e-734c-8ef5-db46e15d58d4"],
Cell[317768, 7577, 661, 13, 28, "Input",ExpressionUUID->"08c129a8-ae4b-a545-af28-2b5ce16c4116"],
Cell[318432, 7592, 1264, 34, 143, "Input",ExpressionUUID->"ce360a32-254b-864a-8448-5ff354aa0512"],
Cell[319699, 7628, 683, 19, 86, "Input",ExpressionUUID->"528d10ed-f6a5-3b43-b818-52a8bf22f9c3"],
Cell[320385, 7649, 506, 11, 28, "Input",ExpressionUUID->"3f2e6b68-b07e-9a4f-94d5-aceb5ff0a87f"],
Cell[320894, 7662, 503, 12, 48, "Input",ExpressionUUID->"14e30ed1-f61c-2940-b1bf-08fd61856b8a"],
Cell[321400, 7676, 336, 7, 28, "Input",ExpressionUUID->"ad7c3fbf-041b-1447-839c-8ba60e26b881"],
Cell[321739, 7685, 340, 8, 28, "Input",ExpressionUUID->"0abf4763-5f7e-1a47-ac04-dc8c16ef6e8b"],
Cell[322082, 7695, 384, 7, 48, "Input",ExpressionUUID->"8e326ece-db91-b94c-a213-006beb91e32b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[322503, 7707, 219, 4, 45, "Subsubsection",ExpressionUUID->"1b31b80a-1ef1-5a48-b997-90c6a153f029"],
Cell[322725, 7713, 534, 10, 48, "Input",ExpressionUUID->"0025422a-28e2-9448-b512-d68583a4c0a5"],
Cell[323262, 7725, 1424, 35, 143, "Input",ExpressionUUID->"ceca52e6-5922-b14b-81de-a6afce39d13c"],
Cell[324689, 7762, 658, 13, 28, "Input",ExpressionUUID->"ccffdc14-b08e-0246-b181-2d9fa2b1278b"],
Cell[325350, 7777, 1261, 33, 143, "Input",ExpressionUUID->"24bda89c-ebcb-9448-a2a4-5180e358690e"],
Cell[326614, 7812, 683, 19, 86, "Input",ExpressionUUID->"7159a4ea-7109-f847-87d5-94d8feff5f08"],
Cell[327300, 7833, 483, 11, 28, "Input",ExpressionUUID->"2889ead3-c539-b348-b94d-7df07b1b0794"],
Cell[327786, 7846, 503, 12, 48, "Input",ExpressionUUID->"2b7694c9-9c24-7e42-b0db-6d1fcb881220"],
Cell[328292, 7860, 363, 7, 28, "Input",ExpressionUUID->"6c8409ac-da7c-1744-83cd-50b04191e87f"],
Cell[328658, 7869, 340, 8, 28, "Input",ExpressionUUID->"0aef66a4-d018-4248-9994-7cb05b7016ea"],
Cell[329001, 7879, 358, 6, 48, "Input",ExpressionUUID->"f2d4c217-b074-6a43-8541-3b29c3fc22a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[329396, 7890, 193, 3, 45, "Subsubsection",ExpressionUUID->"9991da59-bb7c-b140-80b1-d83dfc65d46e"],
Cell[329592, 7895, 531, 10, 48, "Input",ExpressionUUID->"0fc872bb-563d-5b46-ae1f-862439906748"],
Cell[330126, 7907, 1429, 35, 143, "Input",ExpressionUUID->"abf6c5a1-2931-c248-99b1-634ac1759589"],
Cell[331558, 7944, 636, 13, 28, "Input",ExpressionUUID->"a035cc39-b97b-214c-a3f3-9a87d7301fbd"],
Cell[332197, 7959, 1261, 33, 143, "Input",ExpressionUUID->"ba2dcfad-e971-e84f-93e7-f754a67d7c91"],
Cell[333461, 7994, 683, 19, 86, "Input",ExpressionUUID->"8b45a592-c040-3641-bfc1-7d6ae5e7974b"],
Cell[334147, 8015, 483, 11, 28, "Input",ExpressionUUID->"59da36b0-165e-f245-adc7-8558e7654ef7"],
Cell[334633, 8028, 503, 12, 48, "Input",ExpressionUUID->"244e6256-dbe8-884a-abe8-86f2a7846531"],
Cell[335139, 8042, 336, 7, 28, "Input",ExpressionUUID->"03af0e5a-4a69-2b4c-a45b-e57d8cdbe35a"],
Cell[335478, 8051, 340, 8, 28, "Input",ExpressionUUID->"7ba30871-3bdd-cb4e-969f-b3ca7a0b4531"],
Cell[335821, 8061, 358, 6, 48, "Input",ExpressionUUID->"f0a8af94-4b66-0e4c-a561-5e79a4ff2faf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[336216, 8072, 189, 3, 45, "Subsubsection",ExpressionUUID->"fd3f6246-3260-634d-a79f-4c566a40b0ac"],
Cell[336408, 8077, 513, 9, 48, "Input",ExpressionUUID->"e2983bcf-acaa-834c-afd4-52c8dbf68b52"],
Cell[336924, 8088, 1422, 35, 143, "Input",ExpressionUUID->"15683a6b-0432-be43-982a-21bdac03368a"],
Cell[338349, 8125, 638, 13, 28, "Input",ExpressionUUID->"f650cf22-70c8-4745-a489-719fc90f8fe2"],
Cell[338990, 8140, 1264, 34, 143, "Input",ExpressionUUID->"672275b4-912a-0d48-ba3e-e4b7f33c76c3"],
Cell[340257, 8176, 683, 19, 86, "Input",ExpressionUUID->"9f69cf97-e2b8-4741-82b8-14ddd7aa1ba5"],
Cell[340943, 8197, 483, 11, 28, "Input",ExpressionUUID->"13f64b29-dea9-8e4b-aa94-d14f1a5f3072"],
Cell[341429, 8210, 503, 12, 48, "Input",ExpressionUUID->"e4e9bb63-a362-5943-89cb-7b86530c7c8f"],
Cell[341935, 8224, 336, 7, 28, "Input",ExpressionUUID->"303f1fda-2534-9849-ab45-0e3586b9f976"],
Cell[342274, 8233, 340, 8, 28, "Input",ExpressionUUID->"52d8104b-e3fb-9a4a-9bdd-6f86acae0870"],
Cell[342617, 8243, 358, 6, 48, "Input",ExpressionUUID->"81fd6d95-e2cc-fc46-bd15-d2e9535a780a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[343012, 8254, 224, 4, 45, "Subsubsection",ExpressionUUID->"739012dc-76df-6a4e-89b3-c715e258fad8"],
Cell[343239, 8260, 556, 13, 48, "Input",ExpressionUUID->"25cd6235-9c85-3f4e-8835-04b3e2f613ac"],
Cell[343798, 8275, 1432, 35, 143, "Input",ExpressionUUID->"b672c540-6a94-3c41-bcec-201854d05c5a"],
Cell[345233, 8312, 635, 13, 28, "Input",ExpressionUUID->"3a3b62bf-711e-cb43-8190-653136bc1b0c"],
Cell[345871, 8327, 1313, 35, 143, "Input",ExpressionUUID->"6617fea5-0932-c84b-a8eb-b6ea823109e5"],
Cell[347187, 8364, 683, 19, 86, "Input",ExpressionUUID->"aafb95e0-aebe-434e-a319-34b613a2cb54"],
Cell[347873, 8385, 483, 11, 28, "Input",ExpressionUUID->"acf8d4f1-419a-254c-bc67-e506e80a5e85"],
Cell[348359, 8398, 503, 12, 48, "Input",ExpressionUUID->"eebaecbd-c781-964b-a22c-4c11260a1919"],
Cell[348865, 8412, 336, 7, 28, "Input",ExpressionUUID->"e2bdd50c-5a3b-074d-9831-248bcb664efb"],
Cell[349204, 8421, 340, 8, 28, "Input",ExpressionUUID->"647dcafc-8260-3d45-a7c9-7375b656957f"],
Cell[349547, 8431, 358, 6, 48, "Input",ExpressionUUID->"c247fa2b-b5e8-9040-8b3f-89120596f43a"],
Cell[349908, 8439, 151, 3, 28, "Input",ExpressionUUID->"0bb09362-0372-4d23-b1e0-397729fbf0e8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

